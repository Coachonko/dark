"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[125],{1125:(e,t,i)=>{i.r(t),i.d(t,{default:()=>h});var a=i(2654),r=i(3524),n=i(1523),d=i(2752),s=i(1169),c=i(6630),o=i(4875),u=i(5010);const l=c.zo.header`
  display: grid;
  grid-template-columns: 1fr 4fr;
  grid-template-rows: auto;
  padding: 16px 0;

  & h2 {
    margin: 0;
  }
`,h=(0,a.wU)((({slot:e})=>{const{url:t}=(0,n.b)(),{pathname:i}=(0,d.T)(),{data:a,loading:c,error:h}=(0,o.rn)(),y=i.endsWith("list/"),p=t+"add/";return c?(0,r.h)(u.$j,null):h?(0,r.h)(u.jj,{value:h}):(0,r.h)(u.iK,null,(0,r.h)(l,null,(0,r.h)("div",null,y?(0,r.h)(u.zx,{as:s.r,to:p},"Add product"):(0,r.h)(u.zx,{onClick:()=>history.back()},"Back"))),(0,r.h)(u.iK,{key:i},e||(0,r.h)(u.aV,null,[...a].reverse().map((e=>(0,r.h)(u.HC,{key:e.id},(0,r.h)(s.r,{to:`${t}${e.id}`},e.name)))))))}))},4875:(e,t,i)=>{i.d(t,{N8:()=>D,oD:()=>E,iB:()=>g,rn:()=>R,jb:()=>O});var a=i(5747),r=i(9812),n=i(3760),d=i(7544),s=i(6238),c=i(8047),o=i(4435),u=i(1261),l=i(3443);function h(e,t){const{variables:i={},key:h,extractId:p=(()=>a.kI),lazy:T=!1}=t||{variables:{}},f=(0,l.pj)(),C=(0,a.YT)();(0,a.PZ)(C);const m=p(i),P=(0,u.Y)((()=>f.getNextResourceId()),[]),k=(0,u.Y)((()=>function(e,t,i,a){const r={isFetching:!a,isLoaded:!1,data:null,error:null,cacheKey:t,cacheId:i},n=e.read({key:t,id:i});return n&&(r.isFetching=!1,r.isLoaded=!0,r.data=n.data),r}(C,h,m,T)),[]),{register:_,unregister:U}=(0,c.h)(),[R,g]=function(){const e=(0,u.Y)((()=>({isMounted:!0,isFirstTime:!0})),[]),{isFirstTime:t}=e;return(0,n.b)((()=>(e.isFirstTime=!1,()=>e.isMounted=!1)),[]),[()=>e.isMounted,()=>t]}(),D=(0,o.P)(),E=()=>R()&&D(),O=(0,d.X)(),F=f.getIsHydrateZone(),{isLoaded:I}=k;k.cacheKey=h,k.cacheId=m;const v=async t=>{const n=t||i,d=p(n);C.__emit({type:a.VI.QUERY,phase:"start",key:h,data:n});try{O||g()||(k.isFetching=!0,E());const t=await e(n);return C.__emit({type:a.VI.QUERY,phase:"finish",key:h,data:t}),O?f.setResource(P,[t,null]):(U(P),k.data=t,k.isFetching=!1,k.error=null),t&&C.write({key:h,id:d,data:t}),t}catch(e){(0,r.vU)(e),C.__emit({type:a.VI.QUERY,phase:"error",key:h,data:e}),O?f.setResource(P,[null,String(e)]):(U(P),k.isFetching=!1,k.error=String(e))}finally{O||(k.isLoaded=!0,E())}};if((0,s.d4)((()=>{F||T||C.read({key:h,id:m})?.valid||v()}),[...(0,r.Yl)(i)]),(0,s.d4)((()=>{let e=null;return e=C.subscribe((({type:e,key:t,id:i})=>{t===k.cacheKey&&i===k.cacheId&&("invalidate"!==e&&"optimistic"!==e||C.__canUpdate(t)&&v())})),()=>{U(P),(0,r.EY)(e)&&e()}}),[]),O||F){const e=f.getResource(P);if(O)e?y(k,e):f.defer(v);else if(F){if(!e)throw new Error("[Dark]: can not read app state from the server!");const[t]=e;y(k,e),t&&C.write({key:h,id:m,data:t})}}else g()&&!I&&!T&&_(P);return{loading:k.isFetching,data:k.data,error:k.error,refetch:v}}function y(e,t){const[i,a]=t;e.isFetching=!1,e.isLoaded=!0,e.data=i,e.error=a}function p(e,t){const{key:i,refetchQueries:n=[],onSuccess:d}=t||{},s=(0,o.P)(),c=(0,a.YT)();(0,a.PZ)(c);const l=(0,u.Y)((()=>({isFetching:!1,data:null,error:null})),[]);return[async(...t)=>{let o=null;c.__emit({type:a.VI.MUTATION,phase:"start",key:i,data:t});try{l.isFetching=!0,l.error=null,s(),o=await e(...t),c.__emit({type:a.VI.MUTATION,phase:"finish",key:i,data:o}),(0,r.EY)(d)&&d(c,o),n.forEach((e=>c.invalidate({key:e})))}catch(e){(0,r.vU)(e),l.error=String(e),c.__emit({type:a.VI.MUTATION,phase:"error",key:i,data:e})}finally{l.isFetching=!1,s()}return o},{loading:l.isFetching,data:l.data,error:l.error}]}const T=void 0===globalThis.window?100:600,f=e=>new Promise((t=>setTimeout(t,e)));let C=0;const m=new Array(50).fill(null).map((()=>({id:++C,name:`Product #${C}`,description:"Lorem ipsum dolor sit amet consectetur, adipisicing elit. Nostrum blanditiis quia minus corrupti quidem. Ipsam quae ad velit repudiandae molestias unde".repeat(3)}))),P={fetchProducts:async()=>(await f(T),m.map((e=>({...e,description:null})))),fetchProduct:async e=>(k(e)||_(),await f(T),m.find((t=>t.id===e))||null),addProduct:async e=>(k(e.id)&&_(),await f(T),e.id=++C,m.push(e),e),async changeProduct(e){if(k(e.id)||_(),!e)return null;await f(T);const t=m.findIndex((t=>t.id===e.id));return-1!==t&&m.splice(t,1,e),e},async removeProduct(e){k(e)||_(),await f(T);const t=m.findIndex((t=>t.id===e));return-1!==t&&m.splice(t,1),!0}},k=e=>"number"==typeof e&&!Number.isNaN(e),_=()=>{throw new Error("Invalid id!")};var U;function R(){return h((()=>P.fetchProducts()),{key:U.FETCH_PRODUCTS})}function g(e){return h((({id:e})=>P.fetchProduct(e)),{key:U.FETCH_PRODUCT,variables:{id:e},extractId:e=>e.id})}function D(){return p(P.addProduct,{key:U.ADD_PRODUCT,onSuccess:(e,t)=>{const i=e.read({key:U.FETCH_PRODUCTS});if(i){const a=i.data;a.push(t),e.optimistic({key:U.FETCH_PRODUCTS,data:a})}}})}function E(){return p(P.changeProduct,{key:U.CHANGE_PRODUCT,onSuccess:(e,t)=>{const i=e.read({key:U.FETCH_PRODUCTS});if(i){const a=i.data;a.find((e=>e.id===t.id)).name=t.name,e.optimistic({key:U.FETCH_PRODUCTS,data:a}),e.optimistic({key:U.FETCH_PRODUCT,data:t,id:t.id})}}})}function O(e){return p((()=>P.removeProduct(e)),{key:U.REMOVE_PRODUCT,onSuccess:t=>{const i=t.read({key:U.FETCH_PRODUCTS});if(i){const a=i.data,r=a.findIndex((t=>t.id===e));-1!==r&&(a.splice(r,1),t.optimistic({key:U.FETCH_PRODUCTS,data:a}))}t.delete({key:U.FETCH_PRODUCT,id:e})}})}!function(e){e.FETCH_PRODUCTS="FETCH_PRODUCTS",e.FETCH_PRODUCT="FETCH_PRODUCT",e.ADD_PRODUCT="ADD_PRODUCT",e.CHANGE_PRODUCT="CHANGE_PRODUCT",e.REMOVE_PRODUCT="REMOVE_PRODUCT"}(U||(U={}))},1523:(e,t,i)=>{i.d(t,{b:()=>d});var a=i(1261),r=i(3113),n=i(3397);function d(){const e=(0,r.M6)();(0,r.BU)(e);const t=(0,r._L)(),{location:{pathname:i}}=e,d=(0,a.Y)((()=>t?(0,n.L7)(i,t):""),[t,i]);return{path:t,url:d}}}}]);
//# sourceMappingURL=125.build.js.map