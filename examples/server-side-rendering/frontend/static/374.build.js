"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[374],{6374:(e,t,r)=>{r.r(t),r.d(t,{default:()=>u});var a=r(2654),i=r(3524),n=r(1523),c=r(940),s=r(5450),o=r(8421),d=r(5010);const u=(0,a.wU)((()=>{const{url:e}=(0,n.b)(),t=(0,c.k)(),r=(0,s.U)(),a=Number(r.get("id")),[u,{loading:h}]=(0,o.jb)(a),l=e.replace(`${a}/remove/`,"");return(0,i.h)(d.Zb,{$loading:h},(0,i.h)("h3",null,"Do you want to remove product #",a,"? ðŸ¤”"),(0,i.h)(d.zx,{onClick:async()=>{h||(await u(),t.push(l))}},"Yes"),(0,i.h)(d.zx,{onClick:()=>t.back()},"No"))}))},8421:(e,t,r)=>{r.d(t,{N8:()=>f,oD:()=>p,iB:()=>U,rn:()=>k,jb:()=>R});var a=r(5747),i=r(9812),n=r(3760),c=r(7544),s=r(6238),o=r(8047),d=r(4435),u=r(1261),h=r(3443);function l(e,t){const{variables:r={},key:l,extractId:y=(()=>a.kI),lazy:C=!1}=t||{variables:{}},_=(0,h.pj)(),k=(0,a.YT)();(0,a.PZ)(k);const U=y(r),f=(0,u.Y)((()=>_.getNextResourceId()),[]),p=(0,u.Y)((()=>function(e,t,r,a){const i={isFetching:!a,isLoaded:!1,data:null,error:null,cacheKey:t,cacheId:r},n=e.read({key:t,id:r});return n&&(i.isFetching=!1,i.isLoaded=!0,i.data=n.data),i}(k,l,U,C)),[]),{register:R,unregister:D}=(0,o.h)(),[P,E]=function(){const e=(0,u.Y)((()=>({isMounted:!0,isFirstTime:!0})),[]),{isFirstTime:t}=e;return(0,n.b)((()=>(e.isFirstTime=!1,()=>e.isMounted=!1)),[]),[()=>e.isMounted,()=>t]}(),O=(0,d.P)(),F=()=>P()&&O(),g=(0,c.X)(),m=_.getIsHydrateZone(),{isLoaded:H}=p;p.cacheKey=l,p.cacheId=U;const I=async t=>{const n=t||r,c=y(n);k.__emit({type:a.VI.QUERY,phase:"start",key:l,data:n});try{g||E()||(p.isFetching=!0,F());const t=await e(n);return k.__emit({type:a.VI.QUERY,phase:"finish",key:l,data:t}),g?_.setResource(f,[t,null]):(D(f),p.data=t,p.isFetching=!1,p.error=null),t&&k.write({key:l,id:c,data:t}),t}catch(e){(0,i.vU)(e),k.__emit({type:a.VI.QUERY,phase:"error",key:l,data:e}),g?_.setResource(f,[null,String(e)]):(D(f),p.isFetching=!1,p.error=String(e))}finally{g||(p.isLoaded=!0,F())}};if((0,s.d4)((()=>{m||C||k.read({key:l,id:U})?.valid||I()}),[...(0,i.Yl)(r)]),(0,s.d4)((()=>{let e=null;return e=k.subscribe((({type:e,key:t,id:r})=>{t===p.cacheKey&&r===p.cacheId&&("invalidate"!==e&&"optimistic"!==e||k.__canUpdate(t)&&I())})),()=>{D(f),(0,i.EY)(e)&&e()}}),[]),g||m){const e=_.getResource(f);if(g)e?T(p,e):_.defer(I);else if(m){if(!e)throw new Error("[Dark]: can not read app state from the server!");const[t]=e;T(p,e),t&&k.write({key:l,id:U,data:t})}}else E()&&!H&&!C&&R(f);return{loading:p.isFetching,data:p.data,error:p.error,refetch:I}}function T(e,t){const[r,a]=t;e.isFetching=!1,e.isLoaded=!0,e.data=r,e.error=a}function y(e,t){const{key:r,refetchQueries:n=[],onSuccess:c}=t||{},s=(0,d.P)(),o=(0,a.YT)();(0,a.PZ)(o);const h=(0,u.Y)((()=>({isFetching:!1,data:null,error:null})),[]);return[async(...t)=>{let d=null;o.__emit({type:a.VI.MUTATION,phase:"start",key:r,data:t});try{h.isFetching=!0,h.error=null,s(),d=await e(...t),o.__emit({type:a.VI.MUTATION,phase:"finish",key:r,data:d}),(0,i.EY)(c)&&c(o,d),n.forEach((e=>o.invalidate({key:e})))}catch(e){(0,i.vU)(e),h.error=String(e),o.__emit({type:a.VI.MUTATION,phase:"error",key:r,data:e})}finally{h.isFetching=!1,s()}return d},{loading:h.isFetching,data:h.data,error:h.error}]}var C,_=r(3359);function k(){const e=(0,_.h)();return l((()=>e.fetchProducts()),{key:C.FETCH_PRODUCTS})}function U(e){const t=(0,_.h)();return l((({id:e})=>t.fetchProduct(e)),{key:C.FETCH_PRODUCT,variables:{id:e},extractId:e=>e.id})}function f(){return y((0,_.h)().addProduct,{key:C.ADD_PRODUCT,onSuccess:(e,t)=>{const r=e.read({key:C.FETCH_PRODUCTS});if(r){const a=r.data;a.push(t),e.optimistic({key:C.FETCH_PRODUCTS,data:a})}}})}function p(){return y((0,_.h)().changeProduct,{key:C.CHANGE_PRODUCT,onSuccess:(e,t)=>{const r=e.read({key:C.FETCH_PRODUCTS});if(r){const a=r.data;a.find((e=>e.id===t.id)).name=t.name,e.optimistic({key:C.FETCH_PRODUCTS,data:a}),e.optimistic({key:C.FETCH_PRODUCT,data:t,id:t.id})}}})}function R(e){const t=(0,_.h)();return y((()=>t.removeProduct(e)),{key:C.REMOVE_PRODUCT,onSuccess:t=>{const r=t.read({key:C.FETCH_PRODUCTS});if(r){const a=r.data,i=a.findIndex((t=>t.id===e));-1!==i&&(a.splice(i,1),t.optimistic({key:C.FETCH_PRODUCTS,data:a}))}t.delete({key:C.FETCH_PRODUCT,id:e})}})}!function(e){e.FETCH_PRODUCTS="FETCH_PRODUCTS",e.FETCH_PRODUCT="FETCH_PRODUCT",e.ADD_PRODUCT="ADD_PRODUCT",e.CHANGE_PRODUCT="CHANGE_PRODUCT",e.REMOVE_PRODUCT="REMOVE_PRODUCT"}(C||(C={}))},1523:(e,t,r)=>{r.d(t,{b:()=>c});var a=r(1261),i=r(3113),n=r(3397);function c(){const e=(0,i.M6)();(0,i.BU)(e);const t=(0,i._L)(),{location:{pathname:r}}=e,c=(0,a.Y)((()=>t?(0,n.L7)(r,t):""),[t,r]);return{path:t,url:c}}},5450:(e,t,r)=>{r.d(t,{U:()=>i});var a=r(3113);function i(){const e=(0,a.M6)();return(0,a.BU)(e),e.params}}}]);
//# sourceMappingURL=374.build.js.map