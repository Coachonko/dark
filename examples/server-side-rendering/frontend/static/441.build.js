"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[441],{6441:(e,t,a)=>{a.r(t),a.d(t,{default:()=>u});var i=a(2654),r=a(3524),n=a(5450),c=a(1523),s=a(940),d=a(8421),o=a(5010);const u=(0,i.wU)((()=>{const e=(0,n.U)(),{url:t}=(0,c.b)(),a=(0,s.k)(),i=Number(e.get("id")),{data:u}=(0,d.iB)(i),[l,{loading:h}]=(0,d.oD)(),T=t.replace(`${i}/edit/`,"");return(0,r.h)(o.Zb,{$loading:h},(0,r.h)("h3",null,"Edit product"),(0,r.h)(o.l0,{onSubmit:async e=>{e.preventDefault();const{elements:t}=e.target,r=t.name.value,n=t.desc.value;h||(await l(i,{name:r,description:n}),a.push(T))}},(0,r.h)("label",{for:"name"},"Name:"),(0,r.h)(o.II,{id:"name",required:!0,value:u.name}),(0,r.h)("label",{for:"desc"},"Description:"),(0,r.h)(o.gx,{id:"desc",required:!0,rows:5,value:u.description}),(0,r.h)(o.zx,{type:"submit"},"Edit")))}))},8421:(e,t,a)=>{a.d(t,{N8:()=>U,oD:()=>k,iB:()=>_,rn:()=>p,jb:()=>D});var i=a(5747),r=a(9812),n=a(3760),c=a(7544),s=a(6238),d=a(8047),o=a(4435),u=a(1261),l=a(3443);function h(e,t){const{variables:a={},key:h,extractId:y=(()=>i.kI),lazy:C=!1}=t||{variables:{}},f=(0,l.pj)(),p=(0,i.YT)();(0,i.PZ)(p);const _=y(a),U=(0,u.Y)((()=>f.getNextResourceId()),[]),k=(0,u.Y)((()=>function(e,t,a,i){const r={isFetching:!i,isLoaded:!1,data:null,error:null,cacheKey:t,cacheId:a},n=e.read({key:t,id:a});return n&&(r.isFetching=!1,r.isLoaded=!0,r.data=n.data),r}(p,h,_,C)),[]),{register:D,unregister:R}=(0,d.h)(),[E,P]=function(){const e=(0,u.Y)((()=>({isMounted:!0,isFirstTime:!0})),[]),{isFirstTime:t}=e;return(0,n.b)((()=>(e.isFirstTime=!1,()=>e.isMounted=!1)),[]),[()=>e.isMounted,()=>t]}(),m=(0,o.P)(),O=()=>E()&&m(),F=(0,c.X)(),g=f.getIsHydrateZone(),{isLoaded:v}=k;k.cacheKey=h,k.cacheId=_;const I=async t=>{const n=t||a,c=y(n);p.__emit({type:i.VI.QUERY,phase:"start",key:h,data:n});try{F||P()||(k.isFetching=!0,O());const t=await e(n);return p.__emit({type:i.VI.QUERY,phase:"finish",key:h,data:t}),F?f.setResource(U,[t,null]):(R(U),k.data=t,k.isFetching=!1,k.error=null),t&&p.write({key:h,id:c,data:t}),t}catch(e){(0,r.vU)(e),p.__emit({type:i.VI.QUERY,phase:"error",key:h,data:e}),F?f.setResource(U,[null,String(e)]):(R(U),k.isFetching=!1,k.error=String(e))}finally{F||(k.isLoaded=!0,O())}};if((0,s.d4)((()=>{g||C||p.read({key:h,id:_})?.valid||I()}),[...(0,r.Yl)(a)]),(0,s.d4)((()=>{let e=null;return e=p.subscribe((({type:e,key:t,id:a})=>{t===k.cacheKey&&a===k.cacheId&&("invalidate"!==e&&"optimistic"!==e||p.__canUpdate(t)&&I())})),()=>{R(U),(0,r.EY)(e)&&e()}}),[]),F||g){const e=f.getResource(U);if(F)e?T(k,e):f.defer(I);else if(g){if(!e)throw new Error("[Dark]: can not read app state from the server!");const[t]=e;T(k,e),t&&p.write({key:h,id:_,data:t})}}else P()&&!v&&!C&&D(U);return{loading:k.isFetching,data:k.data,error:k.error,refetch:I}}function T(e,t){const[a,i]=t;e.isFetching=!1,e.isLoaded=!0,e.data=a,e.error=i}function y(e,t){const{key:a,refetchQueries:n=[],onSuccess:c}=t||{},s=(0,o.P)(),d=(0,i.YT)();(0,i.PZ)(d);const l=(0,u.Y)((()=>({isFetching:!1,data:null,error:null})),[]);return[async(...t)=>{let o=null;d.__emit({type:i.VI.MUTATION,phase:"start",key:a,data:t});try{l.isFetching=!0,l.error=null,s(),o=await e(...t),d.__emit({type:i.VI.MUTATION,phase:"finish",key:a,data:o}),(0,r.EY)(c)&&c(d,o),n.forEach((e=>d.invalidate({key:e})))}catch(e){(0,r.vU)(e),l.error=String(e),d.__emit({type:i.VI.MUTATION,phase:"error",key:a,data:e})}finally{l.isFetching=!1,s()}return o},{loading:l.isFetching,data:l.data,error:l.error}]}var C,f=a(3359);function p(){const e=(0,f.h)();return h((()=>e.fetchProducts()),{key:C.FETCH_PRODUCTS})}function _(e){const t=(0,f.h)();return h((({id:e})=>t.fetchProduct(e)),{key:C.FETCH_PRODUCT,variables:{id:e},extractId:e=>e.id})}function U(){return y((0,f.h)().addProduct,{key:C.ADD_PRODUCT,onSuccess:(e,t)=>{const a=e.read({key:C.FETCH_PRODUCTS});if(a){const i=a.data;i.push(t),e.optimistic({key:C.FETCH_PRODUCTS,data:i})}}})}function k(){return y((0,f.h)().changeProduct,{key:C.CHANGE_PRODUCT,onSuccess:(e,t)=>{const a=e.read({key:C.FETCH_PRODUCTS});if(a){const i=a.data;i.find((e=>e.id===t.id)).name=t.name,e.optimistic({key:C.FETCH_PRODUCTS,data:i}),e.optimistic({key:C.FETCH_PRODUCT,data:t,id:t.id})}}})}function D(e){const t=(0,f.h)();return y((()=>t.removeProduct(e)),{key:C.REMOVE_PRODUCT,onSuccess:t=>{const a=t.read({key:C.FETCH_PRODUCTS});if(a){const i=a.data,r=i.findIndex((t=>t.id===e));-1!==r&&(i.splice(r,1),t.optimistic({key:C.FETCH_PRODUCTS,data:i}))}t.delete({key:C.FETCH_PRODUCT,id:e})}})}!function(e){e.FETCH_PRODUCTS="FETCH_PRODUCTS",e.FETCH_PRODUCT="FETCH_PRODUCT",e.ADD_PRODUCT="ADD_PRODUCT",e.CHANGE_PRODUCT="CHANGE_PRODUCT",e.REMOVE_PRODUCT="REMOVE_PRODUCT"}(C||(C={}))},1523:(e,t,a)=>{a.d(t,{b:()=>c});var i=a(1261),r=a(3113),n=a(3397);function c(){const e=(0,r.M6)();(0,r.BU)(e);const t=(0,r._L)(),{location:{pathname:a}}=e,c=(0,i.Y)((()=>t?(0,n.L7)(a,t):""),[t,a]);return{path:t,url:c}}},5450:(e,t,a)=>{a.d(t,{U:()=>r});var i=a(3113);function r(){const e=(0,i.M6)();return(0,i.BU)(e),e.params}}}]);
//# sourceMappingURL=441.build.js.map