"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[934],{7934:(e,t,r)=>{r.r(t),r.d(t,{default:()=>o});var a=r(2654),i=r(3524),n=r(1523),c=r(940),s=r(8421),d=r(5010);const o=(0,a.wU)((()=>{const{url:e}=(0,n.b)(),t=(0,c.k)(),[r,{loading:a}]=(0,s.N8)(),o=e.replace("add/","");return(0,i.h)(d.Zb,{$loading:a},(0,i.h)("h3",null,"Add product"),(0,i.h)(d.l0,{onSubmit:async e=>{if(e.preventDefault(),a)return;const{elements:i}=e.target,n=i.name.value,c=i.desc.value;await r({name:n,description:c}),t.push(o)}},(0,i.h)("label",{for:"name"},"Name:"),(0,i.h)(d.II,{id:"name",required:!0}),(0,i.h)("label",{for:"desc"},"Description:"),(0,i.h)(d.gx,{id:"desc",required:!0,rows:3}),(0,i.h)(d.zx,{type:"submit"},"Add")))}))},8421:(e,t,r)=>{r.d(t,{N8:()=>k,oD:()=>U,iB:()=>p,rn:()=>_,jb:()=>D});var a=r(5747),i=r(9812),n=r(3760),c=r(7544),s=r(6238),d=r(8047),o=r(4435),u=r(1261),l=r(3443);function h(e,t){const{variables:r={},key:h,extractId:y=(()=>a.kI),lazy:C=!1}=t||{variables:{}},f=(0,l.pj)(),_=(0,a.YT)();(0,a.PZ)(_);const p=y(r),k=(0,u.Y)((()=>f.getNextResourceId()),[]),U=(0,u.Y)((()=>function(e,t,r,a){const i={isFetching:!a,isLoaded:!1,data:null,error:null,cacheKey:t,cacheId:r},n=e.read({key:t,id:r});return n&&(i.isFetching=!1,i.isLoaded=!0,i.data=n.data),i}(_,h,p,C)),[]),{register:D,unregister:R}=(0,d.h)(),[P,E]=function(){const e=(0,u.Y)((()=>({isMounted:!0,isFirstTime:!0})),[]),{isFirstTime:t}=e;return(0,n.b)((()=>(e.isFirstTime=!1,()=>e.isMounted=!1)),[]),[()=>e.isMounted,()=>t]}(),O=(0,o.P)(),F=()=>P()&&O(),m=(0,c.X)(),g=f.getIsHydrateZone(),{isLoaded:I}=U;U.cacheKey=h,U.cacheId=p;const H=async t=>{const n=t||r,c=y(n);_.__emit({type:a.VI.QUERY,phase:"start",key:h,data:n});try{m||E()||(U.isFetching=!0,F());const t=await e(n);return _.__emit({type:a.VI.QUERY,phase:"finish",key:h,data:t}),m?f.setResource(k,[t,null]):(R(k),U.data=t,U.isFetching=!1,U.error=null),t&&_.write({key:h,id:c,data:t}),t}catch(e){(0,i.vU)(e),_.__emit({type:a.VI.QUERY,phase:"error",key:h,data:e}),m?f.setResource(k,[null,String(e)]):(R(k),U.isFetching=!1,U.error=String(e))}finally{m||(U.isLoaded=!0,F())}};if((0,s.d4)((()=>{g||C||_.read({key:h,id:p})?.valid||H()}),[...(0,i.Yl)(r)]),(0,s.d4)((()=>{let e=null;return e=_.subscribe((({type:e,key:t,id:r})=>{t===U.cacheKey&&r===U.cacheId&&("invalidate"!==e&&"optimistic"!==e||_.__canUpdate(t)&&H())})),()=>{R(k),(0,i.EY)(e)&&e()}}),[]),m||g){const e=f.getResource(k);if(m)e?T(U,e):f.defer(H);else if(g){if(!e)throw new Error("[Dark]: can not read app state from the server!");const[t]=e;T(U,e),t&&_.write({key:h,id:p,data:t})}}else E()&&!I&&!C&&D(k);return{loading:U.isFetching,data:U.data,error:U.error,refetch:H}}function T(e,t){const[r,a]=t;e.isFetching=!1,e.isLoaded=!0,e.data=r,e.error=a}function y(e,t){const{key:r,refetchQueries:n=[],onSuccess:c}=t||{},s=(0,o.P)(),d=(0,a.YT)();(0,a.PZ)(d);const l=(0,u.Y)((()=>({isFetching:!1,data:null,error:null})),[]);return[async(...t)=>{let o=null;d.__emit({type:a.VI.MUTATION,phase:"start",key:r,data:t});try{l.isFetching=!0,l.error=null,s(),o=await e(...t),d.__emit({type:a.VI.MUTATION,phase:"finish",key:r,data:o}),(0,i.EY)(c)&&c(d,o),n.forEach((e=>d.invalidate({key:e})))}catch(e){(0,i.vU)(e),l.error=String(e),d.__emit({type:a.VI.MUTATION,phase:"error",key:r,data:e})}finally{l.isFetching=!1,s()}return o},{loading:l.isFetching,data:l.data,error:l.error}]}var C,f=r(3359);function _(){const e=(0,f.h)();return h((()=>e.fetchProducts()),{key:C.FETCH_PRODUCTS})}function p(e){const t=(0,f.h)();return h((({id:e})=>t.fetchProduct(e)),{key:C.FETCH_PRODUCT,variables:{id:e},extractId:e=>e.id})}function k(){return y((0,f.h)().addProduct,{key:C.ADD_PRODUCT,onSuccess:(e,t)=>{const r=e.read({key:C.FETCH_PRODUCTS});if(r){const a=r.data;a.push(t),e.optimistic({key:C.FETCH_PRODUCTS,data:a})}}})}function U(){return y((0,f.h)().changeProduct,{key:C.CHANGE_PRODUCT,onSuccess:(e,t)=>{const r=e.read({key:C.FETCH_PRODUCTS});if(r){const a=r.data;a.find((e=>e.id===t.id)).name=t.name,e.optimistic({key:C.FETCH_PRODUCTS,data:a}),e.optimistic({key:C.FETCH_PRODUCT,data:t,id:t.id})}}})}function D(e){const t=(0,f.h)();return y((()=>t.removeProduct(e)),{key:C.REMOVE_PRODUCT,onSuccess:t=>{const r=t.read({key:C.FETCH_PRODUCTS});if(r){const a=r.data,i=a.findIndex((t=>t.id===e));-1!==i&&(a.splice(i,1),t.optimistic({key:C.FETCH_PRODUCTS,data:a}))}t.delete({key:C.FETCH_PRODUCT,id:e})}})}!function(e){e.FETCH_PRODUCTS="FETCH_PRODUCTS",e.FETCH_PRODUCT="FETCH_PRODUCT",e.ADD_PRODUCT="ADD_PRODUCT",e.CHANGE_PRODUCT="CHANGE_PRODUCT",e.REMOVE_PRODUCT="REMOVE_PRODUCT"}(C||(C={}))},1523:(e,t,r)=>{r.d(t,{b:()=>c});var a=r(1261),i=r(3113),n=r(3397);function c(){const e=(0,i.M6)();(0,i.BU)(e);const t=(0,i._L)(),{location:{pathname:r}}=e,c=(0,a.Y)((()=>t?(0,n.L7)(r,t):""),[t,r]);return{path:t,url:c}}}}]);
//# sourceMappingURL=934.build.js.map