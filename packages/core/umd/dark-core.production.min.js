!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("DarkCore",[],t):"object"==typeof exports?exports.DarkCore=t():e.DarkCore=t()}(self,(()=>(()=>{"use strict";var e={d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{$$memo:()=>Ee,ATTR_KEY:()=>o,ATTR_REF:()=>s,Comment:()=>he,CommentVirtualNode:()=>re,ComponentFactory:()=>w,EMPTY_NODE:()=>r,EffectTag:()=>Ie,Fiber:()=>Re,Fragment:()=>ge,NodeType:()=>J,PARTIAL_UPDATE:()=>i,ROOT:()=>n,Suspense:()=>pt,SuspenseContext:()=>dt,TagVirtualNode:()=>te,TaskPriority:()=>l,Text:()=>pe,TextVirtualNode:()=>ne,View:()=>de,VirtualNode:()=>ee,batch:()=>rt,cloneTagMap:()=>Ce,createComponent:()=>O,createContext:()=>it,createEmptyVirtualNode:()=>ue,createHook:()=>et,createUpdateCallback:()=>nt,currentFiberStore:()=>U,currentRootStore:()=>D,deletionsStore:()=>V,detectIsArray:()=>h,detectIsBoolean:()=>p,detectIsCommentVirtualNode:()=>ie,detectIsComponentFactory:()=>H,detectIsDepsDifferent:()=>T,detectIsEmpty:()=>g,detectIsEmptyVirtualNode:()=>ae,detectIsFragment:()=>me,detectIsFunction:()=>a,detectIsLazy:()=>gt,detectIsMemo:()=>ke,detectIsMutableRef:()=>ve,detectIsNull:()=>b,detectIsNumber:()=>u,detectIsObject:()=>d,detectIsString:()=>f,detectIsTagVirtualNode:()=>se,detectIsTextVirtualNode:()=>le,detectIsUndefined:()=>c,detectIsVirtualNode:()=>oe,detectIsVirtualNodeFactory:()=>fe,dummyFn:()=>k,effectsStore:()=>K,error:()=>m,eventsStore:()=>A,fiberMountStore:()=>W,flatten:()=>y,forwardRef:()=>ye,getComponentFactoryKey:()=>I,getRootId:()=>N,getTime:()=>v,getVirtualNodeKey:()=>ce,h:()=>ct,hasChildrenProp:()=>Qe,isBatchZone:()=>G,isLayoutEffectsZone:()=>B,isUpdateHookZone:()=>_,keyBy:()=>E,layoutEffectsStore:()=>Z,lazy:()=>bt,memo:()=>Te,nextUnitOfWorkStore:()=>R,platform:()=>He,rootStore:()=>F,takeListFromEnd:()=>x,unmountRoot:()=>De,useCallback:()=>ut,useContext:()=>st,useDeferredValue:()=>mt,useEffect:()=>z,useError:()=>yt,useEvent:()=>vt,useImperativeHandle:()=>Et,useLayoutEffect:()=>je,useMemo:()=>Oe,useReducer:()=>xt,useRef:()=>kt,useState:()=>ft,useUpdate:()=>ot,walkFiber:()=>Le,wipRootStore:()=>M,workLoop:()=>Ue});const n="root",r="dark:matter",o="key",s="ref",i="partial-update";var l;!function(e){e[e.HIGH=2]="HIGH",e[e.NORMAL=1]="NORMAL",e[e.LOW=0]="LOW"}(l||(l={}));const a=e=>"function"==typeof e,c=e=>void 0===e,u=e=>"number"==typeof e,f=e=>"string"==typeof e,d=e=>"object"==typeof e,p=e=>"boolean"==typeof e,h=e=>Array.isArray(e),b=e=>null===e,g=e=>b(e)||c(e);function m(e){!c(console)&&console.error(e)}function y(e){const t=[],n={0:{idx:0,source:e}};let r=0;do{const{source:e,idx:o}=n[r],s=e[o];o>=e.length?(r--,n[r].idx++):h(s)?(r++,n[r]={idx:0,source:s}):(t.push(s),n[r].idx++)}while(r>0||n[r].idx<n[r].source.length);return t}function v(){return Date.now()}function E(e,t,n=!1){return e.reduce(((e,r)=>(e[t(r)]=!n||r,e)),{})}function x(e,t){return e.slice(e.length-t,e.length)}const k=()=>{};function T(e,t){if(!c(e)&&!c(t)&&e.length>0&&t.length>0)for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!0;return!1}const S={displayName:"",defaultProps:{},token:Symbol("component")};class w{constructor(e){this.children=[],this.type=e.type||null,this.token=e.token||null,this.props=e.props||null,this.ref=e.ref||null,this.displayName=e.displayName||"",this.shouldUpdate=e.shouldUpdate||null}}function O(e,t={}){const n=Object.assign(Object.assign({},S),t),{token:r,defaultProps:o,displayName:s,shouldUpdate:i}=n;return(t={},n)=>{const l=Object.assign(Object.assign({},o),t),a=new w({token:r,ref:n,displayName:s,shouldUpdate:i,props:l,type:e,children:[]});return l.ref&&delete l.ref,a}}const H=e=>e instanceof w,I=e=>g(e.props[o])?null:e.props[o];let C=null;const P=new Map;class j{constructor(){this.wipRoot=null,this.currentRoot=null,this.nextUnitOfWork=null,this.events=new Map,this.unsubscribers=[],this.deletions=[],this.fiberMount={level:0,navigation:{},isDeepWalking:!0},this.componentFiber=null,this.effects=[],this.layoutEffects=[],this.isLayoutEffectsZone=!1,this.isUpdateHookZone=!1,this.isBatchZone=!1}}const F={set:e=>{C=e,!P.get(C)&&P.set(C,new j)},remove:e=>P.delete(e)},N=()=>C,L=(e=C)=>P.get(e),M={get:()=>{var e;return(null===(e=L())||void 0===e?void 0:e.wipRoot)||null},set:e=>L().wipRoot=e},D={get:e=>{var t;return(null===(t=L(e))||void 0===t?void 0:t.currentRoot)||null},set:e=>L().currentRoot=e},R={get:()=>{var e;return(null===(e=L())||void 0===e?void 0:e.nextUnitOfWork)||null},set:e=>L().nextUnitOfWork=e},U={get:()=>{var e;return null===(e=L())||void 0===e?void 0:e.componentFiber},set:e=>L().componentFiber=e},A={get:()=>L().events,addUnsubscriber:e=>L().unsubscribers.push(e),unsubscribe:e=>L(e).unsubscribers.forEach((e=>e()))},V={get:()=>L().deletions,set:e=>L().deletions=e},W={reset:()=>{L().fiberMount={level:0,navigation:{},isDeepWalking:!0}},getIndex:()=>L().fiberMount.navigation[L().fiberMount.level],jumpToChild:()=>{const{fiberMount:e}=L(),t=e.level+1;e.level=t,e.navigation[t]=0},jumpToParent:()=>{const{fiberMount:e}=L(),t=e.level,n=t-1;e.navigation[t]=0,e.level=n},jumpToSibling:()=>{const{fiberMount:e}=L(),t=e.level,n=e.navigation[t]+1;e.navigation[t]=n},deepWalking:{get:()=>L().fiberMount.isDeepWalking,set:e=>L().fiberMount.isDeepWalking=e}},K={get:()=>L().effects,reset:()=>L().effects=[],add:e=>L().effects.push(e)},Z={get:()=>L().layoutEffects,reset:()=>L().layoutEffects=[],add:e=>L().layoutEffects.push(e)},B={get:()=>{var e;return(null===(e=L())||void 0===e?void 0:e.isLayoutEffectsZone)||!1},set:e=>L().isLayoutEffectsZone=e},_={get:()=>{var e;return(null===(e=L())||void 0===e?void 0:e.isUpdateHookZone)||!1},set:e=>L().isUpdateHookZone=e},G={get:()=>{var e;return(null===(e=L())||void 0===e?void 0:e.isBatchZone)||!1},set:e=>L().isBatchZone=e},Y=Symbol("use-effect"),{useEffect:z,hasEffects:$,dropEffects:q}=X(Y,K);function X(e,t){return{useEffect:function(n,r){const o=U.get().hook,{idx:s,values:i}=o,l=()=>{i[s]={deps:r,token:e,value:void 0},t.add((()=>{i[s].value=n()}))};if(c(i[s]))l();else{const{deps:e,value:t}=i[s];(!r||T(r,e))&&(a(t)&&t(),l())}o.idx++},hasEffects:function(t){const{values:n}=t.hook;return n.some((t=>(null==t?void 0:t.token)===e))},dropEffects:function(t){const{values:n}=t;for(const t of n)if(t.token===e){const e=t.value;a(e)&&e()}}}}var J;!function(e){e.TAG="TAG",e.TEXT="TEXT",e.COMMENT="COMMENT"}(J||(J={}));const Q=Symbol("virtual-node");class ee{constructor(e){this.type=null,this.type=e.type}}class te extends ee{constructor(e){super(e),this.type=J.TAG,this.name=null,this.isVoid=!1,this.attrs={},this.children=[],this.name=e.name||this.name,this.isVoid=e.isVoid||this.isVoid,this.attrs=e.attrs||this.attrs,this.children=e.children||this.children}}class ne extends ee{constructor(e){super({}),this.type=J.TEXT,this.value="",this.value=e}}class re extends ee{constructor(e){super({}),this.type=J.COMMENT,this.value="",this.value=e}}const oe=e=>e instanceof ee,se=e=>e instanceof te,ie=e=>e instanceof re,le=e=>e instanceof ne,ae=e=>ie(e)&&e.value===r;function ce(e){const t=e&&e.attrs[o];return g(t)?null:t}const ue=()=>new re(r),fe=e=>a(e)&&!0===e[Q];function de(e){const t=()=>{const{as:t,slot:n,isVoid:r=!1}=e,o=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}(e,["as","slot","isVoid"]),s=r?[]:h(n)?n:n?[n]:[];return new te({name:t,isVoid:r,attrs:Object.assign({},o),children:s})};return t[Q]=!0,t}function pe(e){return f(e)?new ne(e):le(e)?e.value:""}function he(e){const t=()=>new re(e);return t[Q]=!0,t}const be=Symbol("fragment"),ge=O((({slot:e})=>e||null),{token:be}),me=e=>H(e)&&e.token===be;function ye(e){return t=>{var{ref:n}=t,r=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}(t,["ref"]);return e(r,n)}}const ve=e=>{if(!d(e)||b(e))return!1;const t=e;for(const e in t)if("current"===e&&t.hasOwnProperty(e))return!0;return!1},Ee=Symbol("memo"),xe=(e,t)=>{const n=Object.keys(t);for(const r of n)if("slot"!==r&&t[r]!==e[r])return!0;return!1},ke=e=>H(e)&&e.token===Ee;function Te(e,t=xe){return ye(O(((t,n)=>(n&&(t.ref=n),e(t))),{token:Ee,shouldUpdate:t}))}const Se=O((({slot:e})=>e),{token:Ee});function we(e,t=!1){return function(e,t){const n=e=>fe(e)||H(e);if(h(e)?n(e[0]):n(e)){const n=Se({slot:ge({slot:e})});return n.shouldUpdate=()=>t,n}return e}(e(),t)}function Oe(e,t){const n=U.get(),{hook:r}=n,{idx:o,values:s}=r;if(c(s[o])){const n=we(e);return s[o]={deps:t,value:n},r.idx++,n}const i=s[o],l=T(t,i.deps),a=l?e:()=>i.value;return i.deps=t,i.value=we(a,l),r.idx++,i.value}const He={createNativeElement:()=>{throw new Error("createNativeElement not installed by renderer")},requestAnimationFrame:()=>{throw new Error("requestAnimationFrame not installed by renderer")},scheduleCallback:()=>{throw new Error("scheduleCallback not installed by renderer")},shouldYeildToHost:()=>{throw new Error("shouldYeildToHost not installed by renderer")},applyCommit:()=>{throw new Error("applyCommit not installed by renderer")},finishCommitWork:()=>{throw new Error("finishCommitWork not installed by renderer")},detectIsPortal:()=>{throw new Error("detectIsPortal not installed by renderer")},unmountPortal:()=>{throw new Error("unmountPortal not installed by renderer")}};var Ie;!function(e){e.CREATE="CREATE",e.UPDATE="UPDATE",e.DELETE="DELETE",e.SKIP="SKIP"}(Ie||(Ie={}));const Ce={[Ie.CREATE]:!0,[Ie.SKIP]:!0},Pe=Symbol("use-layout-effect"),{useEffect:je,hasEffects:Fe,dropEffects:Ne}=X(Pe,Z);function Le(e){const{fiber:t,onLoop:n}=e;let r=t,o=!0,s=!1,i=!1;const l=new Map,a=e=>!l.get(e);for(;r&&(n({nextFiber:r,isReturn:s,resetIsDeepWalking:()=>o=!1,stop:()=>i=!0}),!i);)if(r.child&&o&&a(r.child)){const e=r.child;s=!1,r=e,l.set(e,!0)}else if(r.nextSibling&&a(r.nextSibling)){const e=r.nextSibling;o=!0,s=!1,r=e,l.set(e,!0)}else if(r.parent&&r.parent===t&&r.parent.nextSibling&&a(r.parent.nextSibling)){const e=r.parent.nextSibling;o=!0,s=!1,r=e,l.set(e,!0)}else r.parent&&r.parent!==t?(o=!1,s=!0,r=r.parent):r=null}function Me(e){(e.effectHost||e.layoutEffectHost||e.portalHost)&&Le({fiber:e,onLoop:({nextFiber:t,isReturn:n,stop:r})=>{if(t===e.nextSibling||e.transposition)return r();!n&&H(t.instance)&&(t.layoutEffectHost&&Ne(t.hook),t.effectHost&&q(t.hook),t.portalHost&&He.unmountPortal(t))}})}function De(e,t){c(e)||(Me(D.get(e)),A.unsubscribe(e),F.remove(e),t())}class Re{constructor(e){this.nativeElement=e.nativeElement||null,this.parent=e.parent||null,this.child=e.child||null,this.nextSibling=e.nextSibling||null,this.alternate=e.alternate||null,this.effectTag=e.effectTag||null,this.instance=e.instance||null,this.hook=e.hook||{idx:0,values:[]},this.shadow=e.shadow||null,this.provider=e.provider||null,this.transposition=!c(e.transposition)&&e.transposition,this.mountedToHost=!c(e.mountedToHost)||!1,this.portalHost=!c(e.portalHost)&&e.portalHost,this.effectHost=!c(e.effectHost)&&e.effectHost,this.layoutEffectHost=!c(e.layoutEffectHost)&&e.layoutEffectHost,this.childrenCount=e.childrenCount||0,this.marker=e.marker||"",this.idx=e.idx||0,this.isUsed=e.isUsed||!1,this.batched=e.batched||[]}markPortalHost(){this.portalHost=!0,this.parent&&!this.parent.portalHost&&this.parent.markPortalHost()}markEffectHost(){this.effectHost=!0,this.parent&&!this.parent.effectHost&&this.parent.markEffectHost()}markLayoutEffectHost(){this.layoutEffectHost=!0,this.parent&&!this.parent.layoutEffectHost&&this.parent.markLayoutEffectHost()}markMountedToHost(){this.mountedToHost=!0,this.parent&&!this.parent.mountedToHost&&this.parent.markMountedToHost()}setError(e){"function"==typeof this.catchException?this.catchException(e):this.parent&&this.parent.setError(e)}}function Ue(){const e=M.get();let t=R.get(),n=!1,r=Boolean(t);for(;t&&!n;)t=Ae(t),R.set(t),r=Boolean(t),n=He.shouldYeildToHost();return!t&&e&&function(){const e=M.get();!function(t,n){const r=V.get();for(const e of r)Me(e),He.applyCommit(e);Le({fiber:t,onLoop:({nextFiber:e,isReturn:t,resetIsDeepWalking:n})=>{e.effectTag===Ie.SKIP?n():t||He.applyCommit(e),e&&e.shadow&&(e.shadow=null)}}),He.finishCommitWork(),V.set([]),(()=>{const t=Z.get(),n=K.get();B.set(!0),t.forEach((e=>e())),B.set(!1),setTimeout((()=>{n.forEach((e=>e()))})),M.set(null),Z.reset(),K.reset(),_.get()?_.set(!1):D.set(e)})()}(e.child)}(),r}function Ae(e){let t=!0,n=e,r=e.shadow,o=e.instance;for(;;){if(t=W.deepWalking.get(),n.hook.idx=0,t)if(Qe(o)&&o.children.length>0){const{performedFiber:e,performedNextFiber:t,performedShadow:s,performedInstance:i}=We({nextFiber:n,shadow:r,instance:o});if(n=t,r=s,o=i,e)return e}else{const{performedFiber:e,performedNextFiber:t,performedShadow:s,performedInstance:i}=Ke({nextFiber:n,shadow:r,instance:o});if(n=t,r=s,o=i,e)return e}else{const{performedFiber:e,performedNextFiber:t,performedShadow:s,performedInstance:i}=Ke({nextFiber:n,shadow:r,instance:o});if(n=t,r=s,o=i,e)return e}if(Ve(n),null===n.parent)return null}}function Ve(e){var t;if(e.marker!==i)return;const n=(null===(t=e.child)||void 0===t?void 0:t.alternate)||null,r=e.child||null;if(n&&r&&n.nextSibling&&!r.nextSibling){let e=n.nextSibling;const t=[];for(;e;)e.effectTag=Ie.DELETE,t.push(e),e=e.nextSibling;V.get().push(...t)}}function We(e){W.jumpToChild();let t=e.nextFiber,n=e.shadow,r=e.instance;n=n?n.child:null;const o=function(e){let t=e.alternate&&e.alternate.effectTag!==Ie.DELETE?e.alternate.child:null;for(;t&&t.effectTag===Ie.DELETE;)t=t.nextSibling;return t}(t),s=Qe(r)&&r.children[0]||null,i=tt({shadow:n,alternate:o,prevKey:o?$e(o.instance):null,nextKey:s?$e(s):null}),l=n?n.provider:o?o.provider:null;let a=new Re({hook:i,provider:l});U.set(a),a.parent=t;const{performedInstance:c,performedShadow:u}=Ge({instance:r,idx:0,fiber:a,alternate:o});return r=c||r,n=u||n,o&&Be({alternate:o,instance:r}),Ze({fiber:a,alternate:o,instance:r}),a=o?_e({fiber:a,alternate:o,instance:r}):a,a.idx=0,t.child=a,a.parent=t,a.shadow=n,t=a,Ce[a.parent.effectTag]&&(a.effectTag=a.parent.effectTag),{performedFiber:t,performedNextFiber:t,performedShadow:n,performedInstance:r}}function Ke(e){W.jumpToSibling();let t=e.nextFiber,n=e.shadow,r=e.instance;const o=t.parent.instance,s=W.getIndex();if(Qe(o)&&o.children[s]){W.deepWalking.set(!0),n=n?n.nextSibling:null;const e=function(e){var t;let n=(null===(t=e.alternate)||void 0===t?void 0:t.nextSibling)||null;for(;n&&n.effectTag===Ie.DELETE;)n=n.nextSibling;return n}(t),i=Qe(t.parent.instance)&&t.parent.instance.children[s]||null,l=tt({shadow:n,alternate:e,prevKey:e?$e(e.instance):null,nextKey:i?$e(i):null}),a=n?n.provider:e?e.provider:null;let c=new Re({hook:l,provider:a});U.set(c),c.parent=t.parent;const{performedInstance:u,performedShadow:f}=Ge({instance:o,idx:s,fiber:c,alternate:e});return r=u||r,n=f||n,e&&Be({alternate:e,instance:r}),Ze({fiber:c,alternate:e,instance:r}),c=e?_e({fiber:c,alternate:e,instance:r}):c,c.idx=s,c.parent=t.parent,t.nextSibling=c,c.shadow=n,t=c,Ce[c.parent.effectTag]&&(c.effectTag=c.parent.effectTag),{performedFiber:t,performedNextFiber:t,performedShadow:n,performedInstance:r}}return W.jumpToParent(),W.deepWalking.set(!1),n=n?n.parent:null,t=t.parent,r=t.instance,Qe(t.instance)&&(t.instance.children=[]),{performedFiber:null,performedNextFiber:t,performedShadow:n,performedInstance:r}}function Ze(e){const{fiber:t,alternate:n,instance:r}=e,o=(n?$e(n.instance):null)!==(n?$e(r):null),s=Boolean(n)&&Je(n.instance)===Je(r)&&!o;t.instance=r,t.alternate=n||null,t.nativeElement=s?n.nativeElement:null,t.effectTag=s?Ie.UPDATE:Ie.CREATE,t.mountedToHost=s,Qe(t.instance)&&(t.childrenCount=t.instance.children.length),t.alternate&&(t.alternate.shadow=null,t.alternate.alternate=null),!t.nativeElement&&oe(t.instance)&&(t.nativeElement=He.createNativeElement(t.instance))}function Be(e){const{alternate:t,instance:n}=e,r=Je(t.instance),o=Je(n)===r,s=$e(t.instance)===$e(n);if(t.isUsed=!0,o&&s){if(Qe(t.instance)&&Qe(n)){const e=t.childrenCount,r=n.children.length;if(e!==r){const o=Qe(n)?n.children:[],{prevKeys:s,nextKeys:i}=function(e,t){let n=e,r=0;const o=[],s=[];for(;n||r<t.length;){const e=n&&$e(n.instance),i=t[r]&&$e(t[r]);g(e)||o.push(e),g(i)||s.push(i),n=n?n.nextSibling:null,r++}return{prevKeys:o,nextKeys:s}}(t.child,o);s.length,i.length;const l=()=>{const e=qe(i,s);if(0===e.length||e.length===i.length)return;const n=E(e,(e=>e)),r={};let o=0;for(const e of i){if(r[e]=!0,e!==s[o]&&n[e]){const e=new Re({instance:ue(),parent:t,effectTag:Ie.CREATE});if(0===o)e.nextSibling=t.child,t.child=e;else{const[n,r]=ze(t.child,o);n&&r&&(e.nextSibling=n,r.nextSibling=e)}}o++}};(()=>{const n=qe(s,i);if(n.length>0){const e=function(e){let t=e;const n={};for(;t;){const e=$e(t.instance);g(e)||(n[e]=t),t=t.nextSibling}return n}(t.child);for(const t of n){const n=e[t]||null;n&&(n.effectTag=Ie.DELETE,V.get().push(n))}}else{const n=e-r;if(n<=0)return;const o=x(function(e){const t=[];let n=e;for(;n;)t.push(n),n=n.nextSibling;return t}(t.child),n);for(const e of o)e.effectTag=Ie.DELETE;V.get().push(...o)}})(),l()}}}else t.effectTag=Ie.DELETE,V.get().push(t)}function _e(e){const{fiber:t,alternate:n,instance:r}=e;if(ke(t.instance)){let e=null;const o=r,s=n.instance;if(o.type!==s.type)return t;const i=s.props,l=o.props;if(!o.shouldUpdate(i,l)){let r=null;for(W.deepWalking.set(!1),e=new Re(Object.assign(Object.assign({},n),{alternate:n,effectTag:Ie.SKIP,nextSibling:n.nextSibling?n.nextSibling.effectTag===Ie.DELETE?null:n.nextSibling:null})),n.alternate=null,r=e.child;r;)r.parent=e,r=r.nextSibling;return e.effectHost&&t.markEffectHost(),e.layoutEffectHost&&t.markLayoutEffectHost(),e.mountedToHost&&t.markMountedToHost(),e.portalHost&&t.markPortalHost(),e}}return t}function Ge(e){const{instance:t,idx:n,fiber:r,alternate:o}=e;let s=null,i=null;if(Qe(t)){const e=h(t.children[n])?y([t.children[n]]):[t.children[n]];t.children.splice(n,1,...e),s=t.children[n],i=o?function(e){const{instance:t,fiber:n,alternate:r}=e,o=$e(r.instance),s=$e(t);let i=null;return o!==s&&(i=function(e,t){if(g(e))return null;let n=t;for(;n;){if(e===$e(n.instance))return n;n=n.nextSibling}return null}(s,r.parent.child),i&&(n.hook=i.hook,n.provider=i.provider,r.transposition=!0)),i}({instance:s,fiber:r,alternate:o}):i,s=Ye(r,s)}return H(s)&&($(r)&&r.markEffectHost(),Fe(r)&&r.markLayoutEffectHost(),He.detectIsPortal(s)&&r.markPortalHost()),{performedInstance:s,performedShadow:i}}function Ye(e,t){const n=H(t),r=t;if(n)try{const e=r.type(r.props,r.ref);r.children=h(e)?y([e]):[e]}catch(t){r.children=[],e.setError(t),m(t)}else fe(t)&&(t=t());if(Qe(t)){for(let e=0;e<t.children.length;e++)t.children[e]||(t.children[e]=Xe(t.children[e]));t.children=n?t.children:h(t.children)?y([t.children]):[t.children],n&&0===r.children.length&&r.children.push(ue())}return t}function ze(e,t){const n={};let r=e,o=0;for(;r;){if(n[o]=r,o===t)return[n[o]||null,n[o-1]||null];o++,r=r.nextSibling}return[null,null]}function $e(e){return H(e)?I(e):se(e)?ce(e):null}function qe(e,t){const n=t.reduce(((e,t)=>(e[t]=!0,e)),{}),r=[];for(const t of e)n[t]||r.push(t);return r}function Xe(e){return g(e)||!1===e?ue():e}function Je(e){return se(e)?e.name:oe(e)||H(e)?e.type:null}function Qe(e){return se(e)||H(e)}function et(){return{idx:0,values:[]}}function tt(e){const{shadow:t,alternate:n,prevKey:r,nextKey:o}=e;return t?t.hook:n&&r===o?n.hook:{idx:0,values:[]}}function nt(e){const{rootId:t,fiber:n,forceStart:r=!1,onStart:o}=e;return()=>{r&&o(),n.isUsed||(!r&&o(),F.set(t),_.set(!0),W.reset(),n.alternate=new Re(Object.assign(Object.assign({},n),{alternate:null})),n.marker=i,n.effectTag=Ie.UPDATE,n.child=null,M.set(n),U.set(n),n.instance=Ye(n,n.instance),R.set(n))}}function rt(e){G.set(!0),e()}function ot(e){const t=N(),n=U.get(),r=Oe((()=>({fiber:n})),[]);return r.fiber=n,n=>{const o=nt({rootId:t,fiber:r.fiber,forceStart:Boolean(null==e?void 0:e.timeoutMs),onStart:n||k});B.get()&&(e=Object.assign(Object.assign({},e||{}),{forceSync:!0})),G.get()?function(e,t){e.batched.push(t);const n=()=>{const t=e.batched.length;He.requestAnimationFrame((()=>{if(t===e.batched.length){const t=e.batched[e.batched.length-1];G.set(!1),e.batched=[],t&&t()}else n()}))};n()}(r.fiber,(()=>He.scheduleCallback(o,e))):He.scheduleCallback(o,e)}}function st(e){const{defaultValue:t}=e,n=function(e,t){let n=t;for(;n;){if(n.provider&&n.provider.get(e))return n.provider.get(e);n=n.parent}return null}(e,U.get()),r=n?n.value:t,o=ot(),s=Oe((()=>({prevValue:r})),[]),i=Boolean(n);return z((()=>{if(!i)return;const e=e=>{Object.is(s.prevValue,e)||o()};return n.subscribers.push(e),()=>{const t=n.subscribers.findIndex((t=>t===e));-1!==t&&n.subscribers.splice(t,1)}}),[i]),s.prevValue=r,r}function it(e){let t="Context";const n={displayName:t,defaultValue:e,Provider:null,Consumer:null};return lt(n,e,t),Object.defineProperty(n,"displayName",{get:()=>t,set:r=>{t=r,lt(n,e,t)}}),n}function lt(e,t,n){e.Provider=function(e,t,n){return O((({value:n=t,slot:r})=>{const o=U.get();o.provider||(o.provider=new Map),o.provider.get(e)||o.provider.set(e,{subscribers:[],value:n});const s=o.provider.get(e);return z((()=>{for(const e of s.subscribers)e(n)}),[n]),s.value=n,r}),{displayName:`${n}.Provider`})}(e,t,n),e.Consumer=function(e,t){return O((({slot:t})=>{const n=st(e);return a(t)?t(n):null}),{displayName:`${t}.Consumer`})}(e,n)}function at(e){return(e=e.map((e=>f(e)||u(e)?pe(e.toString()):e)))?Array.isArray(e)?[...e]:[e]:[]}function ct(e,t,...n){if(f(e))return de(Object.assign(Object.assign({},t),{as:e,slot:at(n)}));if(a(e)){let r=at(n);return r=1===r.length?r[0]:r,e(Object.assign(Object.assign({},t),{slot:r}))}return null}function ut(e,t){return Oe((()=>e),t)}function ft(e,t){const n=U.get(),r=ot(t),o=Oe((()=>({idx:n.hook.idx,values:n.hook.values})),[]),s=ut((e=>{const n=o.values[o.idx],s=a(e)?e(n):e;if(!Object.is(n,s)){const e=()=>{o.values[o.idx]=s};(null==t?void 0:t.priority)===l.LOW?r((()=>e())):(e(),r())}}),[]),{hook:i}=n,{idx:u,values:f}=i,d=c(f[u])?e:f[u];return f[u]=d,o.idx=u,o.values=f,i.idx++,[d,s]}const dt=it({fallback:null,isLoaded:!0,trigger:()=>{}}),pt=O((({fallback:e,slot:t})=>{if(!e)throw new Error("[Dark]: Suspense fallback not found");const{isLoaded:n}=st(dt),[r,o]=ft(!1),s=ut((()=>o(!0)),[]),i=Oe((()=>({fallback:e,isLoaded:r,trigger:s})),[e,r]);return dt.Provider({value:i,slot:n?t:null})})),ht=Symbol("lazy");function bt(e){return ye(O(((t,n)=>{const{fallback:r,trigger:o}=st(dt),[s,i]=ft({component:null});return z((()=>{(function(e){return new Promise((t=>{e().then((e=>{if(!e.default)throw new Error("[Dark]: lazy loaded component should be exported as default!");t(e.default)}))}))})(e).then((e=>{i({component:e})}))}),[]),z((()=>{s.component&&o()}),[s.component]),s.component?s.component(t,n):r}),{token:ht}))}const gt=e=>H(e)&&e.token===ht;function mt(e,t){const{timeoutMs:n}=t||{},[r,o]=ft(e,{priority:l.LOW,timeoutMs:n});return z((()=>{o(e)}),[e]),r}function yt(){const e=U.get(),t=ot(),n=Oe((()=>({error:null})),[]);return e.catchException=e=>{n.error=e,t()},z((()=>{n.error=null}),[n.error]),n.error}function vt(e){const t=Oe((()=>({fn:e})),[]);return t.fn=e,ut(((...e)=>t.fn(...e)),[])}function Et(e,t,n){const r=Oe((()=>t()),n);e.current=r}function xt(e,t,n){const r=Oe((()=>a(n)?n(t):t),[]),[o,s]=ft(r),i=ut((t=>s((n=>e(n,t)))),[]);return[o,i]}function kt(e=null){return Oe((()=>({current:e})),[])}return t})()));
//# sourceMappingURL=dark-core.production.min.js.map