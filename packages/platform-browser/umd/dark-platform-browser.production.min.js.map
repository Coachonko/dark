{"version":3,"file":"dark-platform-browser.production.min.js","mappings":"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","sources":["webpack://DarkPlatformBrowser/webpack/universalModuleDefinition","webpack://DarkPlatformBrowser/external umd {\"root\":\"DarkCore\",\"commonjs2\":\"@dark-engine/core\",\"commonjs\":\"@dark-engine/core\",\"amd\":\"@dark-engine/core\"}","webpack://DarkPlatformBrowser/webpack/bootstrap","webpack://DarkPlatformBrowser/webpack/runtime/define property getters","webpack://DarkPlatformBrowser/webpack/runtime/hasOwnProperty shorthand","webpack://DarkPlatformBrowser/webpack/runtime/make namespace object","webpack://DarkPlatformBrowser/./src/portal/portal.tsx","webpack://DarkPlatformBrowser/./src/events/events.ts","webpack://DarkPlatformBrowser/./src/dom/dom.ts","webpack://DarkPlatformBrowser/./src/scheduler/scheduler.ts","webpack://DarkPlatformBrowser/./src/render/render.ts","webpack://DarkPlatformBrowser/./src/create-root/create-root.tsx","webpack://DarkPlatformBrowser/./src/use-style/use-style.ts","webpack://DarkPlatformBrowser/./src/index.ts"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"@dark-engine/core\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"DarkPlatformBrowser\", [\"@dark-engine/core\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"DarkPlatformBrowser\"] = factory(require(\"@dark-engine/core\"));\n\telse\n\t\troot[\"DarkPlatformBrowser\"] = factory(root[\"DarkCore\"]);\n})(self, (__WEBPACK_EXTERNAL_MODULE__317__) => {\nreturn ","module.exports = __WEBPACK_EXTERNAL_MODULE__317__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import {\r\n  type Fiber,\r\n  type DarkElement,\r\n  type ComponentFactory,\r\n  createComponent,\r\n  detectIsComponentFactory,\r\n  useMemo,\r\n} from '@dark-engine/core';\r\n\r\nconst $$portal = Symbol('portal');\r\n\r\nfunction createPortal(slot: DarkElement, container: Element) {\r\n  if (!(container instanceof Element)) {\r\n    throw new Error(`[Dark]: createPortal receives only Element as container!`);\r\n  }\r\n\r\n  return Portal({ [$$portal]: container, slot });\r\n}\r\n\r\ntype PortalProps = {\r\n  [$$portal]: Element;\r\n  slot: DarkElement;\r\n};\r\n\r\nconst Portal = createComponent<PortalProps>(\r\n  ({ slot, ...rest }) => {\r\n    useMemo(() => (rest[$$portal].innerHTML = ''), []);\r\n\r\n    return slot;\r\n  },\r\n  { token: $$portal },\r\n);\r\n\r\nconst detectIsPortal = (factory: unknown): factory is ComponentFactory =>\r\n  detectIsComponentFactory(factory) && factory.token === $$portal;\r\n\r\nconst getPortalContainer = (factory: unknown): Element | null =>\r\n  detectIsPortal(factory) ? factory.props[$$portal] : null;\r\n\r\nfunction unmountPortal(fiber: Fiber<Element>) {\r\n  const container = getPortalContainer(fiber.instance);\r\n\r\n  if (container) {\r\n    container.innerHTML = '';\r\n  }\r\n}\r\n\r\nexport { createPortal, detectIsPortal, getPortalContainer, unmountPortal };\r\n","import { detectIsFunction, eventsStore } from '@dark-engine/core';\r\n\r\ntype BrowserEventConstructor = (type: string, event: Event) => void;\r\n\r\nclass SyntheticEvent<E extends Event, T = Element> {\r\n  public type = '';\r\n  public sourceEvent: E = null;\r\n  public target: T = null;\r\n  private propagation = true;\r\n\r\n  constructor(options: Pick<SyntheticEvent<E, T>, 'sourceEvent' | 'target'>) {\r\n    this.type = options.sourceEvent.type;\r\n    this.sourceEvent = options.sourceEvent;\r\n    this.target = options.target;\r\n  }\r\n\r\n  public stopPropagation() {\r\n    this.propagation = false;\r\n    this.sourceEvent.stopPropagation();\r\n  }\r\n\r\n  public preventDefault() {\r\n    this.sourceEvent.preventDefault();\r\n  }\r\n\r\n  public getPropagation() {\r\n    return this.propagation;\r\n  }\r\n}\r\n\r\ntype DelegateEventOptions = {\r\n  target: Element;\r\n  eventName: string;\r\n  handler: (e: Event) => void;\r\n};\r\n\r\nfunction delegateEvent(options: DelegateEventOptions) {\r\n  const { target, eventName, handler } = options;\r\n  const eventsMap = eventsStore.get();\r\n  const handlerMap = eventsMap.get(eventName);\r\n\r\n  if (!handlerMap) {\r\n    const rootHandler = (event: Event) => {\r\n      const fireEvent = eventsMap.get(eventName).get(event.target);\r\n      const target = event.target as Element;\r\n      let syntheticEvent: SyntheticEvent<Event> = null;\r\n\r\n      if (detectIsFunction(fireEvent)) {\r\n        syntheticEvent = new SyntheticEvent({\r\n          sourceEvent: event,\r\n          target,\r\n        });\r\n        fireEvent(syntheticEvent);\r\n      }\r\n\r\n      if (syntheticEvent ? syntheticEvent.getPropagation() : target.parentElement) {\r\n        target.parentElement.dispatchEvent(new (event.constructor as BrowserEventConstructor)(event.type, event));\r\n      }\r\n    };\r\n\r\n    eventsMap.set(eventName, new WeakMap([[target, handler]]));\r\n    document.addEventListener(eventName, rootHandler, true);\r\n    eventsStore.addUnsubscriber(() => document.removeEventListener(eventName, rootHandler, true));\r\n  } else {\r\n    handlerMap.set(target, handler);\r\n  }\r\n}\r\n\r\nconst detectIsEvent = (attrName: string) => attrName.startsWith('on');\r\n\r\nconst getEventName = (attrName: string) => attrName.slice(2, attrName.length).toLowerCase();\r\n\r\nexport { SyntheticEvent, delegateEvent, detectIsEvent, getEventName };\r\n","import {\r\n  type Fiber,\r\n  type VirtualNode,\r\n  type TagVirtualNode,\r\n  type TextVirtualNode,\r\n  type CommentVirtualNode,\r\n  type Ref,\r\n  ATTR_KEY,\r\n  ATTR_REF,\r\n  EffectTag,\r\n  detectIsFunction,\r\n  detectIsUndefined,\r\n  NodeType,\r\n  detectIsVirtualNode,\r\n  detectIsTagVirtualNode,\r\n  detectIsTextVirtualNode,\r\n  detectIsMutableRef,\r\n  walkFiber,\r\n} from '@dark-engine/core';\r\nimport { detectIsPortal, getPortalContainer } from '../portal';\r\nimport { delegateEvent, detectIsEvent, getEventName } from '../events';\r\nimport type { DOMElement, DOMFragment } from './types';\r\n\r\nconst attrBlackListMap = {\r\n  [ATTR_KEY]: true,\r\n  [ATTR_REF]: true,\r\n  void: true,\r\n};\r\n\r\nlet fragmentsMap: Map<Element, DOMFragment> = new Map();\r\n\r\nlet trackUpdate: (nativeElement: Element) => void = null;\r\n\r\nfunction createNativeElement(vNode: VirtualNode): DOMElement {\r\n  const map = {\r\n    [NodeType.TAG]: (vNode: VirtualNode) => {\r\n      const tagNode = vNode as TagVirtualNode;\r\n      const node = detectIsSvgElement(tagNode.name)\r\n        ? document.createElementNS('http://www.w3.org/2000/svg', tagNode.name)\r\n        : document.createElement(tagNode.name);\r\n\r\n      return node;\r\n    },\r\n    [NodeType.TEXT]: (vNode: VirtualNode) => {\r\n      const textNode = vNode as TextVirtualNode;\r\n      const node = document.createTextNode(textNode.value);\r\n\r\n      return node;\r\n    },\r\n    [NodeType.COMMENT]: (vNode: VirtualNode) => {\r\n      const commentNode = vNode as CommentVirtualNode;\r\n      const node = document.createComment(commentNode.value);\r\n\r\n      return node;\r\n    },\r\n  };\r\n\r\n  return map[vNode.type](vNode);\r\n}\r\n\r\nfunction detectIsSvgElement(tagName: string) {\r\n  const tagMap = {\r\n    svg: true,\r\n    animate: true,\r\n    animateMotion: true,\r\n    animateTransform: true,\r\n    circle: true,\r\n    clipPath: true,\r\n    defs: true,\r\n    desc: true,\r\n    ellipse: true,\r\n    feBlend: true,\r\n    feColorMatrix: true,\r\n    feComponentTransfer: true,\r\n    feComposite: true,\r\n    feConvolveMatrix: true,\r\n    feDiffuseLighting: true,\r\n    feDisplacementMap: true,\r\n    feDistantLight: true,\r\n    feDropShadow: true,\r\n    feFlood: true,\r\n    feFuncA: true,\r\n    feFuncB: true,\r\n    feFuncG: true,\r\n    feFuncR: true,\r\n    feGaussianBlur: true,\r\n    feImage: true,\r\n    feMerge: true,\r\n    feMergeNode: true,\r\n    feMorphology: true,\r\n    feOffset: true,\r\n    fePointLight: true,\r\n    feSpecularLighting: true,\r\n    feSpotLight: true,\r\n    feTile: true,\r\n    feTurbulence: true,\r\n    filter: true,\r\n    foreignObject: true,\r\n    g: true,\r\n    image: true,\r\n    line: true,\r\n    linearGradient: true,\r\n    marker: true,\r\n    mask: true,\r\n    metadata: true,\r\n    mpath: true,\r\n    path: true,\r\n    pattern: true,\r\n    polygon: true,\r\n    polyline: true,\r\n    radialGradient: true,\r\n    rect: true,\r\n    stop: true,\r\n    switch: true,\r\n    symbol: true,\r\n    text: true,\r\n    textPath: true,\r\n    tspan: true,\r\n    use: true,\r\n    view: true,\r\n  };\r\n\r\n  return Boolean(tagMap[tagName]);\r\n}\r\n\r\nfunction applyRef(ref: Ref<Element>, element: Element) {\r\n  if (detectIsFunction(ref)) {\r\n    ref(element);\r\n  } else if (detectIsMutableRef(ref)) {\r\n    ref.current = element;\r\n  }\r\n}\r\n\r\nfunction addAttributes(element: Element, vNode: VirtualNode) {\r\n  if (!detectIsTagVirtualNode(vNode)) return;\r\n  const attrNames = Object.keys(vNode.attrs);\r\n\r\n  for (const attrName of attrNames) {\r\n    const attrValue = vNode.attrs[attrName];\r\n\r\n    if (attrName === ATTR_REF) {\r\n      applyRef(attrValue, element);\r\n      continue;\r\n    }\r\n\r\n    if (detectIsFunction(attrValue)) {\r\n      if (detectIsEvent(attrName)) {\r\n        delegateEvent({\r\n          target: element,\r\n          handler: attrValue,\r\n          eventName: getEventName(attrName),\r\n        });\r\n      }\r\n    } else if (!detectIsUndefined(attrValue) && !attrBlackListMap[attrName]) {\r\n      const stopAttrsMap = upgradeInputAttributes({\r\n        tagName: vNode.name,\r\n        value: attrValue,\r\n        attrName,\r\n        element,\r\n      });\r\n\r\n      !stopAttrsMap[attrName] && element.setAttribute(attrName, attrValue);\r\n    }\r\n  }\r\n}\r\n\r\nfunction updateAttributes(element: Element, vNode: TagVirtualNode, nextVNode: TagVirtualNode) {\r\n  const attrNames = new Set([...Object.keys(vNode.attrs), ...Object.keys(nextVNode.attrs)]);\r\n\r\n  for (const attrName of attrNames) {\r\n    const prevAttrValue = vNode.attrs[attrName];\r\n    const nextAttrValue = nextVNode.attrs[attrName];\r\n\r\n    if (attrName === ATTR_REF) {\r\n      applyRef(prevAttrValue, element);\r\n      continue;\r\n    }\r\n\r\n    if (!detectIsUndefined(nextAttrValue)) {\r\n      if (detectIsFunction(prevAttrValue)) {\r\n        if (detectIsEvent(attrName) && prevAttrValue !== nextAttrValue) {\r\n          delegateEvent({\r\n            target: element,\r\n            handler: nextAttrValue,\r\n            eventName: getEventName(attrName),\r\n          });\r\n        }\r\n      } else if (!attrBlackListMap[attrName] && prevAttrValue !== nextAttrValue) {\r\n        const stopAttrsMap = upgradeInputAttributes({\r\n          tagName: nextVNode.name,\r\n          value: nextAttrValue,\r\n          attrName,\r\n          element,\r\n        });\r\n\r\n        !stopAttrsMap[attrName] && element.setAttribute(attrName, nextAttrValue);\r\n      }\r\n    } else {\r\n      element.removeAttribute(attrName);\r\n    }\r\n  }\r\n}\r\n\r\nconst INPUT_STOP_ATTRS_MAP = {\r\n  value: true,\r\n  checked: true,\r\n};\r\n\r\nconst TEXTAREA_STOP_ATTRS_MAP = {\r\n  value: true,\r\n};\r\n\r\nconst OPTIONS_STOP_ATTRS_MAP = {\r\n  selected: true,\r\n};\r\n\r\nconst DEFAULT_STOP_ATTRS_MAP = {};\r\n\r\ntype PatchedElements = 'input' | 'textarea' | 'option';\r\n\r\ntype UpgradeInputAttributesOptions = {\r\n  tagName: string;\r\n  element: Element;\r\n  attrName: string;\r\n  value: string | boolean;\r\n};\r\n\r\nfunction upgradeInputAttributes(options: UpgradeInputAttributesOptions): Record<string, boolean> {\r\n  const { tagName, element, attrName, value } = options;\r\n  const map: Record<PatchedElements, () => Record<string, boolean>> = {\r\n    input: () => {\r\n      if (INPUT_STOP_ATTRS_MAP[attrName]) {\r\n        element[attrName] = value;\r\n      }\r\n\r\n      return INPUT_STOP_ATTRS_MAP;\r\n    },\r\n    textarea: () => {\r\n      if (TEXTAREA_STOP_ATTRS_MAP[attrName]) {\r\n        element[attrName] = value;\r\n      }\r\n\r\n      return TEXTAREA_STOP_ATTRS_MAP;\r\n    },\r\n    option: () => {\r\n      if (OPTIONS_STOP_ATTRS_MAP[attrName]) {\r\n        element[attrName] = value;\r\n      }\r\n\r\n      return OPTIONS_STOP_ATTRS_MAP;\r\n    },\r\n  };\r\n\r\n  return map[tagName] ? map[tagName]() : DEFAULT_STOP_ATTRS_MAP;\r\n}\r\n\r\nfunction getParentFiberWithNativeElement(fiber: Fiber<Element>): Fiber<Element> {\r\n  let nextFiber = fiber;\r\n\r\n  while (nextFiber) {\r\n    nextFiber = nextFiber.parent;\r\n\r\n    if (detectIsPortal(nextFiber.instance)) {\r\n      nextFiber.nativeElement = getPortalContainer(nextFiber.instance);\r\n    }\r\n\r\n    if (nextFiber.nativeElement) return nextFiber;\r\n  }\r\n\r\n  return nextFiber;\r\n}\r\n\r\nfunction getNodeOnTheRight(fiber: Fiber<Element>, parentElement: Element) {\r\n  let node: Element = null;\r\n\r\n  walkFiber<Element>({\r\n    fiber,\r\n    onLoop: ({ nextFiber, stop, resetIsDeepWalking }) => {\r\n      if (nextFiber.nativeElement && nextFiber.nativeElement.parentElement === parentElement) {\r\n        node = nextFiber.nativeElement;\r\n\r\n        return stop();\r\n      }\r\n\r\n      if (!nextFiber.mountedToHost) {\r\n        return resetIsDeepWalking();\r\n      }\r\n    },\r\n  });\r\n\r\n  return node;\r\n}\r\n\r\nfunction getChildIndex(fiber: Fiber<Element>, parentNativeElement: Element) {\r\n  let nextFiber = fiber;\r\n\r\n  while (nextFiber) {\r\n    if (nextFiber?.parent?.nativeElement === parentNativeElement) {\r\n      return nextFiber.idx;\r\n    }\r\n\r\n    nextFiber = nextFiber.parent;\r\n  }\r\n\r\n  return -1;\r\n}\r\n\r\nfunction commitCreation(fiber: Fiber<Element>) {\r\n  const parentFiber = getParentFiberWithNativeElement(fiber);\r\n  const parentNativeElement = parentFiber.nativeElement;\r\n  const childNodes = parentNativeElement.childNodes;\r\n\r\n  const append = () => {\r\n    const { fragment } =\r\n      fragmentsMap.get(parentNativeElement) ||\r\n      ({\r\n        fragment: document.createDocumentFragment(),\r\n        callback: () => {},\r\n      } as DOMFragment);\r\n\r\n    fragmentsMap.set(parentNativeElement, {\r\n      fragment,\r\n      callback: () => {\r\n        parentNativeElement.appendChild(fragment);\r\n      },\r\n    });\r\n    fragment.appendChild(fiber.nativeElement);\r\n    fiber.markMountedToHost();\r\n  };\r\n\r\n  const insert = () => {\r\n    parentNativeElement.insertBefore(fiber.nativeElement, getNodeOnTheRight(fiber, parentNativeElement));\r\n    fiber.markMountedToHost();\r\n  };\r\n\r\n  if (childNodes.length === 0 || getChildIndex(fiber, parentNativeElement) > childNodes.length - 1) {\r\n    append();\r\n  } else {\r\n    insert();\r\n  }\r\n\r\n  addAttributes(fiber.nativeElement, fiber.instance as VirtualNode);\r\n}\r\n\r\nfunction commitUpdate(nativeElement: Element, instance: VirtualNode, nextInstance: VirtualNode) {\r\n  if (\r\n    detectIsTextVirtualNode(instance) &&\r\n    detectIsTextVirtualNode(nextInstance) &&\r\n    instance.value !== nextInstance.value\r\n  ) {\r\n    return (nativeElement.textContent = nextInstance.value);\r\n  }\r\n\r\n  if (detectIsTagVirtualNode(instance) && detectIsTagVirtualNode(nextInstance)) {\r\n    return updateAttributes(nativeElement, instance, nextInstance);\r\n  }\r\n}\r\n\r\nfunction commitDeletion(fiber: Fiber<Element>) {\r\n  const parentFiber = getParentFiberWithNativeElement(fiber);\r\n\r\n  walkFiber<Element>({\r\n    fiber,\r\n    onLoop: ({ nextFiber, isReturn, resetIsDeepWalking, stop }) => {\r\n      if (nextFiber === fiber.nextSibling || nextFiber === fiber.parent) {\r\n        return stop();\r\n      }\r\n\r\n      if (!isReturn && nextFiber.nativeElement) {\r\n        !detectIsPortal(nextFiber.instance) && parentFiber.nativeElement.removeChild(nextFiber.nativeElement);\r\n\r\n        return resetIsDeepWalking();\r\n      }\r\n    },\r\n  });\r\n}\r\n\r\nfunction applyCommit(fiber: Fiber<Element>) {\r\n  const map: Record<EffectTag, () => void> = {\r\n    [EffectTag.CREATE]: () => {\r\n      if (fiber.nativeElement === null) return;\r\n      trackUpdate && trackUpdate(fiber.nativeElement);\r\n      commitCreation(fiber);\r\n    },\r\n    [EffectTag.UPDATE]: () => {\r\n      if (\r\n        fiber.nativeElement === null ||\r\n        !detectIsVirtualNode(fiber.alternate.instance) ||\r\n        !detectIsVirtualNode(fiber.instance)\r\n      ) {\r\n        return;\r\n      }\r\n      trackUpdate && trackUpdate(fiber.nativeElement);\r\n      commitUpdate(fiber.nativeElement, fiber.alternate.instance, fiber.instance);\r\n    },\r\n    [EffectTag.DELETE]: () => commitDeletion(fiber),\r\n    [EffectTag.SKIP]: () => {},\r\n  };\r\n\r\n  map[fiber.effectTag]();\r\n}\r\n\r\nfunction finishCommitWork() {\r\n  for (const { callback } of fragmentsMap.values()) {\r\n    callback();\r\n  }\r\n\r\n  fragmentsMap = new Map();\r\n}\r\n\r\nfunction setTrackUpdate(fn: typeof trackUpdate) {\r\n  trackUpdate = fn;\r\n}\r\n\r\nexport { createNativeElement, applyCommit, finishCommitWork, setTrackUpdate };\r\n","import { type ScheduleCallbackOptions, getTime, workLoop, wipRootStore, TaskPriority } from '@dark-engine/core';\r\n\r\ntype Callback = () => boolean;\r\n\r\ntype QueueByPriority = {\r\n  hight: Array<Task>;\r\n  normal: Array<Task>;\r\n  low1: Array<Task>;\r\n  low2: Array<Task>;\r\n};\r\n\r\nconst queueByPriority: QueueByPriority = {\r\n  hight: [],\r\n  normal: [],\r\n  low1: [],\r\n  low2: [],\r\n};\r\nconst YEILD_INTERVAL = 10;\r\nlet scheduledCallback: Callback = null;\r\nlet deadline = 0;\r\nlet isMessageLoopRunning = false;\r\nlet currentTask: Task = null;\r\n\r\nclass Task {\r\n  public static nextTaskId = 0;\r\n  public id: number;\r\n  public time: number;\r\n  public timeoutMs: number;\r\n  public priority: TaskPriority;\r\n  public forceSync: boolean;\r\n  public callback: () => void;\r\n\r\n  constructor(options: Omit<Task, 'id'>) {\r\n    this.id = ++Task.nextTaskId;\r\n    this.time = options.time;\r\n    this.timeoutMs = options.timeoutMs;\r\n    this.priority = options.priority;\r\n    this.forceSync = options.forceSync;\r\n    this.callback = options.callback;\r\n  }\r\n}\r\n\r\nconst shouldYeildToHost = () => getTime() >= deadline;\r\n\r\nfunction scheduleCallback(callback: () => void, options?: ScheduleCallbackOptions) {\r\n  const { priority = TaskPriority.NORMAL, timeoutMs = 0, forceSync = false } = options || {};\r\n  const task = new Task({ time: getTime(), timeoutMs, priority, forceSync, callback });\r\n  const map: Record<TaskPriority, () => void> = {\r\n    [TaskPriority.HIGH]: () => queueByPriority.hight.push(task),\r\n    [TaskPriority.NORMAL]: () => queueByPriority.normal.push(task),\r\n    [TaskPriority.LOW]: () => (task.timeoutMs > 0 ? queueByPriority.low2.push(task) : queueByPriority.low1.push(task)),\r\n  };\r\n\r\n  map[task.priority]();\r\n  executeTasks();\r\n}\r\n\r\nfunction pick(queue: Array<Task>) {\r\n  if (!queue.length) return false;\r\n  currentTask = queue.shift();\r\n\r\n  currentTask.callback();\r\n\r\n  if (currentTask.forceSync) {\r\n    requestCallbackSync(workLoop);\r\n  } else {\r\n    requestCallback(workLoop);\r\n  }\r\n\r\n  return true;\r\n}\r\n\r\nfunction executeTasks() {\r\n  const isBusy = Boolean(wipRootStore.get());\r\n\r\n  if (!isBusy) {\r\n    checkOverdueTasks() ||\r\n      pick(queueByPriority.hight) ||\r\n      pick(queueByPriority.normal) ||\r\n      requestIdleCallback(() => pick(queueByPriority.low1) || pick(queueByPriority.low2));\r\n  }\r\n}\r\n\r\nfunction checkOverdueTasks() {\r\n  const [task] = queueByPriority.low2;\r\n\r\n  if (task && getTime() - task.time > task.timeoutMs) {\r\n    pick(queueByPriority.low2);\r\n    return true;\r\n  }\r\n\r\n  return false;\r\n}\r\n\r\nfunction performWorkUntilDeadline() {\r\n  if (scheduledCallback) {\r\n    deadline = getTime() + YEILD_INTERVAL;\r\n\r\n    try {\r\n      const hasMoreWork = scheduledCallback();\r\n\r\n      if (!hasMoreWork) {\r\n        currentTask = null;\r\n        isMessageLoopRunning = false;\r\n        scheduledCallback = null;\r\n        executeTasks();\r\n      } else {\r\n        port.postMessage(null);\r\n      }\r\n    } catch (error) {\r\n      port.postMessage(null);\r\n      throw error;\r\n    }\r\n  } else {\r\n    isMessageLoopRunning = false;\r\n  }\r\n}\r\n\r\nfunction requestCallback(callback: Callback) {\r\n  if (process.env.NODE_ENV === 'test') {\r\n    return requestCallbackSync(callback);\r\n  }\r\n\r\n  scheduledCallback = callback;\r\n\r\n  if (!isMessageLoopRunning) {\r\n    isMessageLoopRunning = true;\r\n    port.postMessage(null);\r\n  }\r\n}\r\n\r\nfunction requestCallbackSync(callback: Callback) {\r\n  while (callback()) {\r\n    //\r\n  }\r\n  executeTasks();\r\n  currentTask = null;\r\n}\r\n\r\nlet channel: MessageChannel = null;\r\nlet port: MessagePort = null;\r\n\r\nfunction setup() {\r\n  if (process.env.NODE_ENV === 'test') {\r\n    return;\r\n  }\r\n\r\n  channel = new MessageChannel();\r\n  port = channel.port2;\r\n\r\n  channel.port1.onmessage = performWorkUntilDeadline;\r\n}\r\n\r\nsetup();\r\n\r\nexport { shouldYeildToHost, scheduleCallback };\r\n","import {\r\n  type DarkElement,\r\n  type VirtualNodeFactory,\r\n  type ComponentFactory,\r\n  ROOT,\r\n  Fiber,\r\n  EffectTag,\r\n  platform,\r\n  flatten,\r\n  detectIsUndefined,\r\n  TagVirtualNode,\r\n  rootStore,\r\n  wipRootStore,\r\n  currentRootStore,\r\n  nextUnitOfWorkStore,\r\n  fiberMountStore,\r\n  TaskPriority,\r\n  createEmptyVirtualNode,\r\n  isLayoutEffectsZone,\r\n} from '@dark-engine/core';\r\nimport { createNativeElement, applyCommit, finishCommitWork } from '../dom';\r\nimport { detectIsPortal, unmountPortal } from '../portal';\r\nimport { scheduleCallback, shouldYeildToHost } from '../scheduler';\r\n\r\nplatform.createNativeElement = createNativeElement as typeof platform.createNativeElement;\r\nplatform.requestAnimationFrame = requestAnimationFrame.bind(this);\r\nplatform.scheduleCallback = scheduleCallback;\r\nplatform.shouldYeildToHost = shouldYeildToHost;\r\nplatform.applyCommit = applyCommit;\r\nplatform.finishCommitWork = finishCommitWork;\r\nplatform.detectIsPortal = detectIsPortal;\r\nplatform.unmountPortal = unmountPortal;\r\n\r\nconst roots = new Map<Element, number>();\r\n\r\nfunction render(element: DarkElement, container: Element) {\r\n  if (!(container instanceof Element)) {\r\n    throw new Error(`[Dark]: render receives only Element as container!`);\r\n  }\r\n\r\n  const isMounted = !detectIsUndefined(roots.get(container));\r\n  let rootId = null;\r\n\r\n  if (!isMounted) {\r\n    rootId = roots.size;\r\n\r\n    roots.set(container, rootId);\r\n    container.innerHTML = '';\r\n  } else {\r\n    rootId = roots.get(container);\r\n  }\r\n\r\n  const callback = () => {\r\n    rootStore.set(rootId); // important order!\r\n    const currentRoot = currentRootStore.get();\r\n    const fiber = new Fiber({\r\n      nativeElement: container,\r\n      instance: new TagVirtualNode({\r\n        name: ROOT,\r\n        children: flatten([element || createEmptyVirtualNode()]) as Array<VirtualNodeFactory | ComponentFactory>,\r\n      }),\r\n      alternate: currentRoot,\r\n      effectTag: isMounted ? EffectTag.UPDATE : EffectTag.CREATE,\r\n    });\r\n\r\n    currentRoot && (currentRoot.alternate = null);\r\n    fiberMountStore.reset();\r\n    wipRootStore.set(fiber);\r\n    nextUnitOfWorkStore.set(fiber);\r\n  };\r\n\r\n  platform.scheduleCallback(callback, { priority: TaskPriority.NORMAL, forceSync: isLayoutEffectsZone.get() });\r\n}\r\n\r\nexport { render, roots };\r\n","import { type DarkElement, unmountRoot } from '@dark-engine/core';\r\nimport { render, roots } from '../render';\r\n\r\nfunction createRoot(container: Element) {\r\n  return {\r\n    render: (element: DarkElement) => render(element, container),\r\n    unmount: () => {\r\n      const rootId = roots.get(container);\r\n\r\n      unmountRoot(rootId, () => {\r\n        roots.delete(container);\r\n        container.innerHTML = '';\r\n      });\r\n    },\r\n  };\r\n}\r\n\r\nexport { createRoot };\r\n","import { useMemo, detectIsUndefined } from '@dark-engine/core';\r\n\r\nfunction styled(strings: TemplateStringsArray, ...args: Array<string | number>): string {\r\n  const style = useMemo(() => {\r\n    return strings\r\n      .map((x, idx) => x + (!detectIsUndefined(args[idx]) ? args[idx] : ''))\r\n      .join('')\r\n      .replace(/;\\s*/gm, ';')\r\n      .replace(/:\\s*/gm, ':')\r\n      .trim();\r\n  }, [strings, ...args]);\r\n\r\n  return style;\r\n}\r\n\r\ntype Style = Record<string, string>;\r\n\r\ntype Config<T extends Style> = (x: typeof styled) => T;\r\n\r\nfunction useStyle<T extends Style>(config: Config<T>) {\r\n  return config(styled);\r\n}\r\n\r\nexport { useStyle };\r\n","/* eslint-disable @typescript-eslint/no-namespace */\r\nexport { render } from './render';\r\nexport { createRoot } from './create-root';\r\nexport { createPortal } from './portal';\r\nexport { useStyle } from './use-style';\r\nexport { setTrackUpdate } from './dom';\r\nexport type { SyntheticEvent } from './events';\r\n\r\nexport const version = process.env.VERSION;\r\n\r\ndeclare global {\r\n  namespace JSX {\r\n    interface IntrinsicElements {\r\n      [elemName: string]: Record<string, any>;\r\n    }\r\n  }\r\n}\r\n"],"names":["root","factory","exports","module","require","define","amd","self","__WEBPACK_EXTERNAL_MODULE__317__","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","d","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","r","Symbol","toStringTag","value","$$portal","createPortal","slot","container","Element","Error","Portal","createComponent","rest","useMemo","innerHTML","token","detectIsPortal","detectIsComponentFactory","getPortalContainer","props","SyntheticEvent","type","sourceEvent","target","propagation","constructor","options","this","stopPropagation","preventDefault","getPropagation","delegateEvent","eventName","handler","eventsMap","eventsStore","handlerMap","set","rootHandler","event","fireEvent","syntheticEvent","detectIsFunction","parentElement","dispatchEvent","WeakMap","document","addEventListener","removeEventListener","detectIsEvent","attrName","startsWith","getEventName","slice","length","toLowerCase","attrBlackListMap","ATTR_KEY","ATTR_REF","void","fragmentsMap","Map","trackUpdate","applyRef","ref","element","detectIsMutableRef","current","INPUT_STOP_ATTRS_MAP","checked","TEXTAREA_STOP_ATTRS_MAP","OPTIONS_STOP_ATTRS_MAP","selected","DEFAULT_STOP_ATTRS_MAP","upgradeInputAttributes","tagName","map","input","textarea","option","getParentFiberWithNativeElement","fiber","nextFiber","parent","instance","nativeElement","setTrackUpdate","fn","queueByPriority","hight","normal","low1","low2","scheduledCallback","deadline","isMessageLoopRunning","currentTask","Task","static","id","time","timeoutMs","priority","forceSync","callback","nextTaskId","pick","queue","shift","executeTasks","requestCallbackSync","workLoop","port","postMessage","Boolean","wipRootStore","task","getTime","checkOverdueTasks","requestIdleCallback","channel","MessageChannel","port2","port1","onmessage","error","platform","vNode","NodeType","tagNode","name","svg","animate","animateMotion","animateTransform","circle","clipPath","defs","desc","ellipse","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","foreignObject","g","image","line","linearGradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialGradient","rect","stop","switch","symbol","text","textPath","tspan","use","view","createElementNS","createElement","textNode","createTextNode","commentNode","createComment","requestAnimationFrame","bind","TaskPriority","push","EffectTag","parentNativeElement","childNodes","idx","getChildIndex","fragment","createDocumentFragment","appendChild","markMountedToHost","append","insertBefore","node","walkFiber","onLoop","resetIsDeepWalking","mountedToHost","getNodeOnTheRight","detectIsTagVirtualNode","attrNames","keys","attrs","attrValue","detectIsUndefined","setAttribute","addAttributes","commitCreation","nextInstance","detectIsVirtualNode","alternate","detectIsTextVirtualNode","textContent","nextVNode","Set","prevAttrValue","nextAttrValue","removeAttribute","updateAttributes","parentFiber","isReturn","nextSibling","removeChild","commitDeletion","effectTag","values","roots","render","isMounted","rootId","size","rootStore","currentRoot","currentRootStore","Fiber","TagVirtualNode","ROOT","children","flatten","createEmptyVirtualNode","fiberMountStore","nextUnitOfWorkStore","isLayoutEffectsZone","createRoot","unmount","unmountRoot","styled","strings","args","x","join","replace","trim","useStyle","config","version"],"sourceRoot":""}