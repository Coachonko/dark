{"version":3,"file":"dark-platform-browser.production.min.js","mappings":"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","sources":["webpack://DarkPlatformBrowser/webpack/universalModuleDefinition","webpack://DarkPlatformBrowser/external umd {\"root\":\"DarkCore\",\"commonjs2\":\"@dark-engine/core\",\"commonjs\":\"@dark-engine/core\",\"amd\":\"@dark-engine/core\"}","webpack://DarkPlatformBrowser/webpack/bootstrap","webpack://DarkPlatformBrowser/webpack/runtime/define property getters","webpack://DarkPlatformBrowser/webpack/runtime/hasOwnProperty shorthand","webpack://DarkPlatformBrowser/webpack/runtime/make namespace object","webpack://DarkPlatformBrowser/./src/portal/portal.tsx","webpack://DarkPlatformBrowser/./src/events/events.ts","webpack://DarkPlatformBrowser/./src/dom/dom.ts","webpack://DarkPlatformBrowser/./src/scheduling/model.ts","webpack://DarkPlatformBrowser/./src/scheduling/scheduling.ts","webpack://DarkPlatformBrowser/./src/render/render.ts"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"@dark-engine/core\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"DarkPlatformBrowser\", [\"@dark-engine/core\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"DarkPlatformBrowser\"] = factory(require(\"@dark-engine/core\"));\n\telse\n\t\troot[\"DarkPlatformBrowser\"] = factory(root[\"DarkCore\"]);\n})(self, (__WEBPACK_EXTERNAL_MODULE__317__) => {\nreturn ","module.exports = __WEBPACK_EXTERNAL_MODULE__317__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import {\r\n  type Fiber,\r\n  type DarkElement,\r\n  type ComponentFactory,\r\n  createComponent,\r\n  detectIsComponentFactory,\r\n  error,\r\n  useMemo,\r\n} from '@dark-engine/core';\r\n\r\nconst $$portal = Symbol('portal');\r\n\r\nfunction createPortal(slot: DarkElement, container: Element) {\r\n  if (!(container instanceof Element)) {\r\n    if (process.env.NODE_ENV === 'development') {\r\n      error(`[Dark]: createPortal receives only Element as container!`);\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  return Portal({ [$$portal]: container, slot });\r\n}\r\n\r\nconst Portal = createComponent(\r\n  ({ slot, ...rest }) => {\r\n    useMemo(() => (rest[$$portal].innerHTML = ''), []);\r\n\r\n    return slot;\r\n  },\r\n  { token: $$portal },\r\n);\r\n\r\nconst detectIsPortal = (factory: unknown): factory is ComponentFactory =>\r\n  detectIsComponentFactory(factory) && factory.token === $$portal;\r\nconst getPortalContainer = (factory: unknown): Element => (detectIsPortal(factory) ? factory.props[$$portal] : null);\r\n\r\nfunction unmountPortal(fiber: Fiber<Element>) {\r\n  let nextFiber = fiber;\r\n  let isDeepWalking = true;\r\n  let isReturn = false;\r\n\r\n  while (nextFiber) {\r\n    if (!isReturn && detectIsPortal(nextFiber.instance)) {\r\n      const container = getPortalContainer(nextFiber.instance);\r\n\r\n      container.innerHTML = '';\r\n    }\r\n\r\n    if (!nextFiber.portalHost) {\r\n      isDeepWalking = false;\r\n    }\r\n\r\n    if (nextFiber.child && isDeepWalking) {\r\n      nextFiber = nextFiber.child;\r\n      isReturn = false;\r\n    } else if (nextFiber.nextSibling && nextFiber.nextSibling !== fiber.nextSibling) {\r\n      isDeepWalking = true;\r\n      isReturn = false;\r\n      nextFiber = nextFiber.nextSibling;\r\n    } else if (\r\n      nextFiber.parent &&\r\n      nextFiber !== fiber &&\r\n      nextFiber.parent !== fiber &&\r\n      nextFiber.parent !== fiber.parent\r\n    ) {\r\n      isDeepWalking = false;\r\n      isReturn = true;\r\n      nextFiber = nextFiber.parent;\r\n    } else {\r\n      nextFiber = null;\r\n    }\r\n  }\r\n}\r\n\r\nexport { createPortal, detectIsPortal, getPortalContainer, unmountPortal };\r\n","import { detectIsFunction, eventsHelper } from '@dark-engine/core';\r\n\r\ntype BrowserEventConstructor = (type: string, event: Event) => void;\r\n\r\nclass SyntheticEvent<E extends Event, T = Element> {\r\n  public type = '';\r\n  public sourceEvent: E = null;\r\n  public target: T = null;\r\n  private propagation = true;\r\n\r\n  constructor(options: Pick<SyntheticEvent<E, T>, 'sourceEvent' | 'target'>) {\r\n    this.type = options.sourceEvent.type;\r\n    this.sourceEvent = options.sourceEvent;\r\n    this.target = options.target;\r\n  }\r\n\r\n  public stopPropagation() {\r\n    this.propagation = false;\r\n    this.sourceEvent.stopPropagation();\r\n  }\r\n\r\n  public preventDefault() {\r\n    this.sourceEvent.preventDefault();\r\n  }\r\n\r\n  public getPropagation() {\r\n    return this.propagation;\r\n  }\r\n}\r\n\r\ntype DelegateEventOptions = {\r\n  target: Element;\r\n  eventName: string;\r\n  handler: (e: Event) => void;\r\n};\r\n\r\nfunction delegateEvent(options: DelegateEventOptions) {\r\n  const { target, eventName, handler } = options;\r\n  const eventsStore = eventsHelper.get();\r\n  const handlerMap = eventsStore.get(eventName);\r\n\r\n  if (!handlerMap) {\r\n    const rootHandler = (event: Event) => {\r\n      const fireEvent = eventsStore.get(eventName).get(event.target);\r\n      const target = event.target as Element;\r\n      let syntheticEvent: SyntheticEvent<Event> = null;\r\n\r\n      if (detectIsFunction(fireEvent)) {\r\n        syntheticEvent = new SyntheticEvent({\r\n          sourceEvent: event,\r\n          target,\r\n        });\r\n        fireEvent(syntheticEvent);\r\n      }\r\n\r\n      if (syntheticEvent ? syntheticEvent.getPropagation() : target.parentElement) {\r\n        target.parentElement.dispatchEvent(new (event.constructor as BrowserEventConstructor)(event.type, event));\r\n      }\r\n    };\r\n\r\n    eventsStore.set(eventName, new WeakMap([[target, handler]]));\r\n    document.addEventListener(eventName, rootHandler, true);\r\n  } else {\r\n    handlerMap.set(target, handler);\r\n  }\r\n}\r\n\r\nconst detectIsEvent = (attrName: string) => attrName.startsWith('on');\r\n\r\nconst getEventName = (attrName: string) => attrName.slice(2, attrName.length).toLowerCase();\r\n\r\nexport { SyntheticEvent, delegateEvent, detectIsEvent, getEventName };\r\n","import {\r\n  type Fiber,\r\n  type VirtualNode,\r\n  type TagVirtualNode,\r\n  type TextVirtualNode,\r\n  type CommentVirtualNode,\r\n  type MutableRef,\r\n  EffectTag,\r\n  detectIsFunction,\r\n  detectIsUndefined,\r\n  NodeType,\r\n  detectIsVirtualNode,\r\n  detectIsTagVirtualNode,\r\n  detectIsTextVirtualNode,\r\n  getAttribute,\r\n  detectIsCommentVirtualNode,\r\n  detectIsComponentFactory,\r\n  runEffectCleanup,\r\n  detectIsRef,\r\n  ATTR_KEY,\r\n  ATTR_REF,\r\n  EMPTY_NODE,\r\n  fromHookUpdateHelper,\r\n} from '@dark-engine/core';\r\nimport { detectIsPortal, getPortalContainer } from '../portal';\r\nimport { delegateEvent, detectIsEvent, getEventName } from '../events';\r\nimport type { DomElement } from './model';\r\n\r\nconst attrBlackList = [ATTR_KEY, ATTR_REF];\r\n\r\nfunction createElement(vNode: VirtualNode): DomElement {\r\n  const map = {\r\n    [NodeType.TAG]: (vNode: VirtualNode) => {\r\n      const tagNode = vNode as TagVirtualNode;\r\n      const node = detectIsSvgElement(tagNode.name)\r\n        ? document.createElementNS('http://www.w3.org/2000/svg', tagNode.name)\r\n        : document.createElement(tagNode.name);\r\n\r\n      return node;\r\n    },\r\n    [NodeType.TEXT]: (vNode: VirtualNode) => {\r\n      const textNode = vNode as TextVirtualNode;\r\n      const node = document.createTextNode(textNode.value);\r\n\r\n      return node;\r\n    },\r\n    [NodeType.COMMENT]: (vNode: VirtualNode) => {\r\n      const commentNode = vNode as CommentVirtualNode;\r\n      if (commentNode.value === EMPTY_NODE) return null;\r\n      const node = document.createComment(commentNode.value);\r\n\r\n      return node;\r\n    },\r\n  };\r\n\r\n  return map[vNode.type](vNode);\r\n}\r\n\r\nfunction createDomElement(fiber: Fiber<Element>): DomElement {\r\n  if (!detectIsVirtualNode(fiber.instance)) {\r\n    throw new Error('createDomElement receives only Element into fiber!');\r\n  }\r\n\r\n  const vNode: VirtualNode = fiber.instance;\r\n\r\n  return createElement(vNode);\r\n}\r\n\r\nfunction applyRef(ref: MutableRef, element: Element) {\r\n  if (detectIsRef(ref)) {\r\n    ref.current = element;\r\n  }\r\n}\r\n\r\nfunction addAttributes(element: Element, vNode: VirtualNode) {\r\n  if (!detectIsTagVirtualNode(vNode)) return;\r\n  const attrNames = Object.keys(vNode.attrs);\r\n\r\n  for (const attrName of attrNames) {\r\n    const attrValue = getAttribute(vNode, attrName);\r\n\r\n    if (attrName === ATTR_REF) {\r\n      applyRef(attrValue as MutableRef, element);\r\n      continue;\r\n    }\r\n\r\n    if (detectIsFunction(attrValue)) {\r\n      if (detectIsEvent(attrName)) {\r\n        delegateEvent({\r\n          target: element,\r\n          handler: attrValue,\r\n          eventName: getEventName(attrName),\r\n        });\r\n      }\r\n    } else if (!detectIsUndefined(attrValue) && !attrBlackList.includes(attrName)) {\r\n      upgradeInputAttributes({\r\n        tagName: vNode.name,\r\n        value: attrValue,\r\n        attrName,\r\n        element,\r\n      });\r\n\r\n      element.setAttribute(attrName, attrValue);\r\n    }\r\n  }\r\n}\r\n\r\nfunction updateAttributes(element: Element, vNode: TagVirtualNode, nextVNode: TagVirtualNode) {\r\n  const attrNames = new Set([...Object.keys(vNode.attrs), ...Object.keys(nextVNode.attrs)]);\r\n\r\n  for (const attrName of attrNames) {\r\n    const attrValue = getAttribute(vNode, attrName);\r\n    const nextAttrValue = getAttribute(nextVNode, attrName);\r\n\r\n    if (attrName === ATTR_REF) {\r\n      applyRef(attrValue as MutableRef, element);\r\n      continue;\r\n    }\r\n\r\n    if (!detectIsUndefined(nextAttrValue)) {\r\n      if (detectIsFunction(attrValue)) {\r\n        if (detectIsEvent(attrName) && attrValue !== nextAttrValue) {\r\n          delegateEvent({\r\n            target: element,\r\n            handler: nextAttrValue,\r\n            eventName: getEventName(attrName),\r\n          });\r\n        }\r\n      } else if (\r\n        !detectIsUndefined(nextAttrValue) &&\r\n        attrValue !== nextAttrValue &&\r\n        !attrBlackList.includes(attrName)\r\n      ) {\r\n        upgradeInputAttributes({\r\n          tagName: nextVNode.name,\r\n          value: nextAttrValue,\r\n          attrName,\r\n          element,\r\n        });\r\n\r\n        element.setAttribute(attrName, nextAttrValue);\r\n      }\r\n    } else {\r\n      element.removeAttribute(attrName);\r\n    }\r\n  }\r\n}\r\n\r\ntype UpdareInputAttributesOptions = {\r\n  tagName: string;\r\n  element: Element;\r\n  attrName: string;\r\n  value: string | boolean;\r\n};\r\n\r\nfunction upgradeInputAttributes(options: UpdareInputAttributesOptions) {\r\n  const { tagName, element, attrName, value } = options;\r\n  const map = {\r\n    input: () => {\r\n      const attrsMap = {\r\n        value: true,\r\n        checked: true,\r\n      };\r\n\r\n      if (attrsMap[attrName]) {\r\n        element[attrName] = value;\r\n      }\r\n    },\r\n    option: () => {\r\n      const attrsMap = {\r\n        selected: true,\r\n      };\r\n\r\n      if (attrsMap[attrName]) {\r\n        element[attrName] = value;\r\n      }\r\n    },\r\n  };\r\n\r\n  map[tagName] && map[tagName]();\r\n}\r\n\r\nfunction updateDom(element: Element, instance: VirtualNode, nextInstance: VirtualNode) {\r\n  if (\r\n    detectIsTextVirtualNode(instance) &&\r\n    detectIsTextVirtualNode(nextInstance) &&\r\n    instance.value !== nextInstance.value\r\n  ) {\r\n    return (element.textContent = nextInstance.value);\r\n  }\r\n\r\n  if (detectIsTagVirtualNode(instance) && detectIsTagVirtualNode(nextInstance)) {\r\n    return updateAttributes(element, instance, nextInstance);\r\n  }\r\n}\r\n\r\nconst fragmentMap: Map<Element, DocumentFragment> = new Map();\r\nlet nodeCacheMap: Map<Element, Element> = new Map();\r\n\r\nfunction resetNodeCache() {\r\n  nodeCacheMap = new Map();\r\n}\r\n\r\nfunction mutateDom(fiber: Fiber<Element>) {\r\n  const fromHookUpdate = fromHookUpdateHelper.get();\r\n  const nextFiber = getFiberWithNativeElement(fiber);\r\n  const parentNativeElement = nextFiber.nativeElement;\r\n\r\n  if (fiber.nativeElement !== null && fiber.effectTag === EffectTag.PLACEMENT) {\r\n    const cachedNode = nodeCacheMap.get(parentNativeElement);\r\n    const node = nextFiber.alternate\r\n      ? !detectIsUndefined(cachedNode) && canTakeNodeFromCache(fiber, nextFiber)\r\n        ? cachedNode\r\n        : cachedNode === null\r\n        ? null\r\n        : getNodeOnTheRight(fiber, parentNativeElement)\r\n      : fromHookUpdate\r\n      ? getNodeOnTheRight(fiber, parentNativeElement)\r\n      : null;\r\n\r\n    nodeCacheMap.set(parentNativeElement, node);\r\n\r\n    if (node) {\r\n      parentNativeElement.insertBefore(fiber.nativeElement, node);\r\n      fiber.mountedToHost = true;\r\n      if (isEndOfInsertion(fiber, nextFiber)) {\r\n        nodeCacheMap.delete(parentNativeElement);\r\n      }\r\n    } else {\r\n      let fragment = fragmentMap.get(parentNativeElement);\r\n\r\n      if (detectIsUndefined(fragment)) {\r\n        fragment = document.createDocumentFragment();\r\n        fragmentMap.set(parentNativeElement, fragment);\r\n      }\r\n\r\n      fragment.appendChild(fiber.nativeElement);\r\n      fiber.mountedToHost = true;\r\n\r\n      if (!hasNextSibling(fiber, nextFiber)) {\r\n        parentNativeElement.appendChild(fragment);\r\n        fragmentMap.delete(parentNativeElement);\r\n        nodeCacheMap.delete(parentNativeElement);\r\n      }\r\n    }\r\n\r\n    addAttributes(fiber.nativeElement, fiber.instance as VirtualNode);\r\n  } else if (fiber.nativeElement !== null && fiber.effectTag === EffectTag.UPDATE) {\r\n    if (!detectIsVirtualNode(fiber.alternate.instance) || !detectIsVirtualNode(fiber.instance)) return;\r\n    const vNode: VirtualNode = fiber.alternate.instance;\r\n    const nextVNode: VirtualNode = fiber.instance;\r\n\r\n    updateDom(fiber.nativeElement, vNode, nextVNode);\r\n  } else if (fiber.effectTag === EffectTag.DELETION) {\r\n    commitDeletion(fiber, parentNativeElement);\r\n  }\r\n}\r\n\r\nfunction hasNextSibling(fiber: Fiber, rootFilber: Fiber) {\r\n  let nextFiber = fiber;\r\n\r\n  if (nextFiber.nextSibling && detectIsPortal(nextFiber.nextSibling.instance)) {\r\n    return false;\r\n  }\r\n\r\n  while (!nextFiber.nextSibling) {\r\n    nextFiber = nextFiber.parent;\r\n\r\n    if (nextFiber === rootFilber || nextFiber.nativeElement) {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  return true;\r\n}\r\n\r\nfunction getFiberWithNativeElement(fiber: Fiber<Element>): Fiber<Element> {\r\n  let nextFiber = fiber.parent;\r\n\r\n  if (detectIsPortal(fiber.instance)) return fiber;\r\n\r\n  while (nextFiber && !nextFiber.nativeElement) {\r\n    if (detectIsPortal(nextFiber.instance)) {\r\n      nextFiber.nativeElement = getPortalContainer(nextFiber.instance);\r\n    } else {\r\n      nextFiber = nextFiber.parent;\r\n    }\r\n  }\r\n\r\n  return nextFiber;\r\n}\r\n\r\nfunction canTakeNodeFromCache(fiber: Fiber, parentFiber: Fiber) {\r\n  let nextFiber = fiber;\r\n\r\n  while (nextFiber) {\r\n    if (nextFiber.alternate) {\r\n      const alternate = nextFiber.alternate;\r\n      const isEmptyNode = detectIsCommentVirtualNode(alternate.instance) && alternate.instance.value === EMPTY_NODE;\r\n\r\n      return isEmptyNode;\r\n    }\r\n\r\n    nextFiber = nextFiber.parent;\r\n    if (nextFiber === parentFiber) return false;\r\n  }\r\n\r\n  return false;\r\n}\r\n\r\nfunction isEndOfInsertion(fiber: Fiber, parentFiber: Fiber) {\r\n  let nextFiber = fiber;\r\n\r\n  do {\r\n    if (!nextFiber) return false;\r\n    nextFiber = nextFiber.nextSibling || nextFiber.parent.nextSibling;\r\n    if (nextFiber && nextFiber.parent === parentFiber) break;\r\n  } while (!nextFiber);\r\n\r\n  if (nextFiber.effectTag === EffectTag.UPDATE) {\r\n    return true;\r\n  }\r\n\r\n  return false;\r\n}\r\n\r\nfunction getNodeOnTheRight(fiber: Fiber<Element>, parentElement: Element) {\r\n  let nextFiber = fiber;\r\n  let isDeepWalking = true;\r\n\r\n  while (nextFiber) {\r\n    if (nextFiber.nativeElement && nextFiber.nativeElement.parentElement === parentElement) {\r\n      return nextFiber.nativeElement;\r\n    }\r\n\r\n    if (nextFiber.nativeElement && !nextFiber.mountedToHost) {\r\n      isDeepWalking = false;\r\n    }\r\n\r\n    if (nextFiber.child && isDeepWalking) {\r\n      nextFiber = nextFiber.child;\r\n    } else if (nextFiber.nextSibling) {\r\n      isDeepWalking = true;\r\n      nextFiber = nextFiber.nextSibling;\r\n    } else if (nextFiber.parent && nextFiber.parent.nativeElement !== parentElement) {\r\n      isDeepWalking = false;\r\n      nextFiber = nextFiber.parent;\r\n    } else {\r\n      nextFiber = null;\r\n    }\r\n  }\r\n\r\n  return null;\r\n}\r\n\r\nfunction commitDeletion(fiber: Fiber<Element>, parentElement: Element) {\r\n  let nextFiber = fiber;\r\n  let isDeepWalking = true;\r\n  let isReturn = false;\r\n\r\n  if (detectIsCommentVirtualNode(nextFiber.instance) && !nextFiber.nativeElement) {\r\n    return;\r\n  }\r\n\r\n  while (nextFiber) {\r\n    if (!isReturn) {\r\n      if (nextFiber.nativeElement) {\r\n        const isPortal = detectIsPortal(nextFiber.instance);\r\n\r\n        !isPortal && parentElement.removeChild(nextFiber.nativeElement);\r\n        isDeepWalking = false;\r\n      }\r\n\r\n      if (!fiber.transposition && detectIsComponentFactory(nextFiber.instance)) {\r\n        runEffectCleanup(nextFiber.hook);\r\n      }\r\n    }\r\n\r\n    if (nextFiber.child && isDeepWalking) {\r\n      nextFiber = nextFiber.child;\r\n      isReturn = false;\r\n    } else if (nextFiber.nextSibling && nextFiber.nextSibling !== fiber.nextSibling) {\r\n      if (nextFiber.nextSibling.effectTag === EffectTag.DELETION) return;\r\n      isDeepWalking = true;\r\n      isReturn = false;\r\n      nextFiber = nextFiber.nextSibling;\r\n    } else if (\r\n      nextFiber.parent &&\r\n      nextFiber !== fiber &&\r\n      nextFiber.parent !== fiber &&\r\n      nextFiber.parent !== fiber.parent\r\n    ) {\r\n      isDeepWalking = false;\r\n      isReturn = true;\r\n      nextFiber = nextFiber.parent;\r\n    } else {\r\n      nextFiber = null;\r\n    }\r\n  }\r\n}\r\n\r\nfunction detectIsSvgElement(tagName) {\r\n  const tagMap = {\r\n    svg: true,\r\n    circle: true,\r\n    ellipse: true,\r\n    g: true,\r\n    text: true,\r\n    tspan: true,\r\n    textPath: true,\r\n    path: true,\r\n    polygon: true,\r\n    polyline: true,\r\n    line: true,\r\n    rect: true,\r\n    use: true,\r\n    image: true,\r\n    symbol: true,\r\n    defs: true,\r\n    linearGradient: true,\r\n    radialGradient: true,\r\n    stop: true,\r\n    clipPath: true,\r\n    pattern: true,\r\n    mask: true,\r\n    marker: true,\r\n  };\r\n\r\n  return Boolean(tagMap[tagName]);\r\n}\r\n\r\nexport { createDomElement, mutateDom, resetNodeCache };\r\n","export type Callback = () => boolean;\r\n\r\nexport type Task = {\r\n  id: number;\r\n  priority: TaskPriority;\r\n  calllback: () => void;\r\n};\r\n\r\nexport enum TaskPriority {\r\n  HIGH = 2,\r\n  NORMAL = 1,\r\n}\r\n","import { getTime, workLoop, nextUnitOfWorkHelper } from '@dark-engine/core';\r\nimport { TaskPriority, type Callback } from './model';\r\n\r\nconst queue: Array<Task> = [];\r\nconst yeildInterval = 5;\r\nlet scheduledCallback: Callback = null;\r\nlet deadline = 0;\r\nlet isMessageLoopRunning = false;\r\nlet currentTask: Task = null;\r\nclass Task {\r\n  public static nextTaskId = 0;\r\n  public id: number;\r\n  public priority: TaskPriority;\r\n  public callback: () => void;\r\n\r\n  constructor(options: Pick<Task, 'priority' | 'callback'>) {\r\n    this.id = ++Task.nextTaskId;\r\n    this.priority = options.priority;\r\n    this.callback = options.callback;\r\n  }\r\n}\r\n\r\nconst shouldYeildToHost = () => getTime() >= deadline;\r\n\r\nfunction scheduleCallback(callback: () => void, priority: TaskPriority = TaskPriority.NORMAL) {\r\n  const task = new Task({ priority, callback });\r\n\r\n  queue.push(task);\r\n  executeTasks();\r\n}\r\n\r\nfunction executeTasks() {\r\n  const hasMoreWork = Boolean(nextUnitOfWorkHelper.get());\r\n\r\n  if (!hasMoreWork) {\r\n    if (queue.length > 0) {\r\n      currentTask = queue.shift();\r\n      currentTask.callback();\r\n      requestCallback(workLoop);\r\n    }\r\n  }\r\n}\r\n\r\nfunction performWorkUntilDeadline() {\r\n  if (scheduledCallback) {\r\n    deadline = getTime() + yeildInterval;\r\n\r\n    try {\r\n      const hasMoreWork = scheduledCallback();\r\n\r\n      if (!hasMoreWork) {\r\n        currentTask = null;\r\n        isMessageLoopRunning = false;\r\n        scheduledCallback = null;\r\n        executeTasks();\r\n      } else {\r\n        port.postMessage(null);\r\n      }\r\n    } catch (error) {\r\n      port.postMessage(null);\r\n      throw error;\r\n    }\r\n  } else {\r\n    isMessageLoopRunning = false;\r\n  }\r\n}\r\n\r\nfunction requestCallback(callback: Callback) {\r\n  if (process.env.NODE_ENV === 'test') {\r\n    return requestCallbackSync(callback);\r\n  }\r\n\r\n  scheduledCallback = callback;\r\n\r\n  if (!isMessageLoopRunning) {\r\n    isMessageLoopRunning = true;\r\n    port.postMessage(null);\r\n  }\r\n}\r\n\r\nfunction requestCallbackSync(callback: Callback) {\r\n  while (callback()) {\r\n    //\r\n  }\r\n  executeTasks();\r\n}\r\n\r\nlet channel: MessageChannel = null;\r\nlet port: MessagePort = null;\r\n\r\nfunction setup() {\r\n  if (process.env.NODE_ENV === 'test') {\r\n    return;\r\n  }\r\n\r\n  channel = new MessageChannel();\r\n  port = channel.port2;\r\n\r\n  channel.port1.onmessage = performWorkUntilDeadline;\r\n}\r\n\r\nsetup();\r\n\r\nexport { shouldYeildToHost, scheduleCallback };\r\n","import {\r\n  type DarkElement,\r\n  type VirtualNodeFactory,\r\n  type ComponentFactory,\r\n  Fiber,\r\n  EffectTag,\r\n  platform,\r\n  flatten,\r\n  detectIsUndefined,\r\n  TagVirtualNode,\r\n  effectStoreHelper,\r\n  wipRootHelper,\r\n  currentRootHelper,\r\n  nextUnitOfWorkHelper,\r\n  getRootId,\r\n  deletionsHelper,\r\n  fiberMountHelper,\r\n  ROOT,\r\n} from '@dark-engine/core';\r\nimport { createDomElement, mutateDom, resetNodeCache } from '../dom';\r\nimport { detectIsPortal, unmountPortal } from '../portal';\r\nimport { scheduleCallback, shouldYeildToHost, TaskPriority } from '../scheduling';\r\n\r\nplatform.raf = window.requestAnimationFrame.bind(this);\r\nplatform.scheduleCallback = scheduleCallback;\r\nplatform.shouldYeildToHost = shouldYeildToHost;\r\nplatform.createNativeElement = createDomElement as typeof platform.createNativeElement;\r\nplatform.applyCommits = mutateDom as typeof platform.applyCommits;\r\nplatform.detectIsPortal = detectIsPortal as typeof platform.detectIsPortal;\r\nplatform.unmountPortal = unmountPortal as typeof platform.unmountPortal;\r\n\r\nconst roots = new Map<Element, number>();\r\n\r\nfunction render(element: DarkElement, container: Element) {\r\n  if (!(container instanceof Element)) {\r\n    throw new Error(`render expects to receive container as Element!`);\r\n  }\r\n\r\n  const isMounted = !detectIsUndefined(roots.get(container));\r\n\r\n  if (!isMounted) {\r\n    const rootId = roots.size;\r\n\r\n    roots.set(container, rootId);\r\n    effectStoreHelper.set(rootId);\r\n    container.innerHTML = '';\r\n  } else {\r\n    const rootId = roots.get(container);\r\n\r\n    effectStoreHelper.set(rootId);\r\n  }\r\n\r\n  const rootId = getRootId();\r\n  const callback = () => {\r\n    effectStoreHelper.set(rootId);\r\n    resetNodeCache();\r\n\r\n    const currentRootFiber = currentRootHelper.get();\r\n    const fiber = new Fiber({\r\n      nativeElement: container,\r\n      instance: new TagVirtualNode({\r\n        name: ROOT,\r\n        children: flatten([element]) as Array<VirtualNodeFactory | ComponentFactory>,\r\n      }),\r\n      alternate: currentRootFiber,\r\n      effectTag: isMounted ? EffectTag.UPDATE : EffectTag.PLACEMENT,\r\n    });\r\n\r\n    currentRootFiber && (currentRootFiber.alternate = null);\r\n    fiberMountHelper.reset();\r\n    wipRootHelper.set(fiber);\r\n    nextUnitOfWorkHelper.set(fiber);\r\n    deletionsHelper.get().forEach(x => (x.effectTag = EffectTag.UPDATE));\r\n    deletionsHelper.set([]);\r\n  };\r\n\r\n  platform.scheduleCallback(callback, TaskPriority.HIGH);\r\n}\r\n\r\nexport { render };\r\n"],"names":["root","factory","exports","module","require","define","amd","self","__WEBPACK_EXTERNAL_MODULE__317__","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","d","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","r","Symbol","toStringTag","value","$$portal","createPortal","slot","container","Element","Portal","createComponent","rest","useMemo","innerHTML","token","detectIsPortal","detectIsComponentFactory","getPortalContainer","props","options","type","sourceEvent","target","propagation","this","stopPropagation","preventDefault","getPropagation","delegateEvent","eventName","handler","eventsStore","eventsHelper","handlerMap","set","WeakMap","document","addEventListener","event","fireEvent","syntheticEvent","detectIsFunction","SyntheticEvent","parentElement","dispatchEvent","constructor","detectIsEvent","attrName","startsWith","getEventName","slice","length","toLowerCase","attrBlackList","ATTR_KEY","ATTR_REF","applyRef","ref","element","detectIsRef","current","upgradeInputAttributes","tagName","map","input","checked","option","selected","TaskPriority","fragmentMap","Map","nodeCacheMap","getNodeOnTheRight","fiber","nextFiber","isDeepWalking","nativeElement","mountedToHost","child","nextSibling","parent","queue","scheduledCallback","deadline","isMessageLoopRunning","id","Task","nextTaskId","priority","callback","executeTasks","Boolean","nextUnitOfWorkHelper","shift","workLoop","port","postMessage","channel","MessageChannel","port2","port1","onmessage","getTime","error","platform","window","requestAnimationFrame","bind","NORMAL","task","push","detectIsVirtualNode","instance","Error","vNode","NodeType","tagNode","name","svg","circle","ellipse","g","text","tspan","textPath","path","polygon","polyline","line","rect","use","image","symbol","defs","linearGradient","radialGradient","stop","clipPath","pattern","mask","marker","createElementNS","createElement","textNode","createTextNode","commentNode","EMPTY_NODE","createComment","nextInstance","fromHookUpdate","fromHookUpdateHelper","getFiberWithNativeElement","parentNativeElement","effectTag","EffectTag","cachedNode","node","alternate","detectIsUndefined","parentFiber","detectIsCommentVirtualNode","canTakeNodeFromCache","insertBefore","isEndOfInsertion","delete","fragment","createDocumentFragment","appendChild","rootFilber","hasNextSibling","detectIsTagVirtualNode","attrNames","keys","attrs","attrValue","getAttribute","includes","setAttribute","addAttributes","nextVNode","detectIsTextVirtualNode","textContent","Set","nextAttrValue","removeAttribute","updateAttributes","isReturn","removeChild","transposition","runEffectCleanup","hook","commitDeletion","portalHost","roots","render","isMounted","effectStoreHelper","size","rootId","getRootId","currentRootFiber","currentRootHelper","Fiber","TagVirtualNode","ROOT","children","flatten","fiberMountHelper","wipRootHelper","deletionsHelper","forEach","x","HIGH"],"sourceRoot":""}