{"version":3,"file":"build.js","mappings":"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","sources":["webpack:///webpack/runtime/load script","webpack:///../../../packages/core/src/component/component.ts","webpack:///../../../packages/core/src/constants.ts","webpack:///../../../packages/core/src/element/element.ts","webpack:///../../../packages/core/src/utils/utils.ts","webpack:///../../../packages/core/src/view/view.ts","webpack:///webpack/bootstrap","webpack:///webpack/runtime/define property getters","webpack:///webpack/runtime/ensure chunk","webpack:///webpack/runtime/get javascript chunk filename","webpack:///webpack/runtime/global","webpack:///webpack/runtime/hasOwnProperty shorthand","webpack:///webpack/runtime/make namespace object","webpack:///webpack/runtime/publicPath","webpack:///webpack/runtime/jsonp chunk loading","webpack:///../../../packages/core/src/platform/platform.ts","webpack:///../../../packages/core/src/emitter/emitter.ts","webpack:///../../../packages/core/src/scope/scope.ts","webpack:///../../../packages/core/src/fiber/fiber.ts","webpack:///../../../packages/core/src/memo/utils.ts","webpack:///../../../packages/core/src/walk/walk.ts","webpack:///../../../packages/core/src/fragment/fragment.ts","webpack:///../../../packages/core/src/memo/memo.ts","webpack:///../../../packages/core/src/use-memo/use-memo.ts","webpack:///../../../packages/core/src/use-effect/types.ts","webpack:///../../../packages/core/src/use-effect/use-effect.ts","webpack:///../../../packages/core/src/use-layout-effect/use-layout-effect.ts","webpack:///../../../packages/core/src/use-insertion-effect/use-insertion-effect.ts","webpack:///../../../packages/core/src/unmount/unmount.ts","webpack:///../../../packages/core/src/workloop/workloop.ts","webpack:///../../../packages/core/src/scheduler/scheduler.ts","webpack:///../../../packages/core/src/ref/ref.ts","webpack:///../../../packages/platform-browser/src/portal/utils.ts","webpack:///../../../packages/platform-browser/src/events/events.ts","webpack:///../../../packages/platform-browser/src/constants.ts","webpack:///../../../packages/platform-browser/src/dom/dom.ts","webpack:///../../../packages/platform-browser/src/render/render.ts","webpack:///../../../packages/platform-browser/src/hydrate-root/hydrate-root.tsx","webpack:///../../../packages/core/src/use-update/use-update.ts","webpack:///../../../packages/core/src/batch/batch.ts","webpack:///../../../packages/core/src/context/context.ts","webpack:///../../../packages/core/src/use-callback/use-callback.ts","webpack:///../../../packages/core/src/use-state/use-state.ts","webpack:///../../../packages/core/src/shadow/utils.ts","webpack:///../../../packages/core/src/shadow/shadow.ts","webpack:///../../../packages/core/src/suspense/suspense.ts","webpack:///../../../packages/core/src/use-id/use-id.ts","webpack:///../../../packages/core/src/lazy/lazy.ts","webpack:///../../../packages/web-router/src/context/context.tsx","webpack:///../../../packages/web-router/src/constants.ts","webpack:///../../../packages/web-router/src/utils/utils.ts","webpack:///../../../packages/web-router/src/router-link/router-link.tsx","webpack:///../../../packages/web-router/src/use-history/use-history.ts","webpack:///../../../packages/web-router/src/use-location/use-location.ts","webpack:///../../../packages/core/src/use-event/use-event.ts","webpack:///../../../packages/web-router/src/history/history.ts","webpack:///../../../packages/web-router/src/location/location.ts","webpack:///../../../packages/web-router/src/create-routes/create-routes.ts","webpack:///../../../packages/web-router/src/router/router.tsx","webpack:///../../../packages/core/src/use-imperative-handle/use-imperative-handle.ts","webpack:///../../../packages/styled/src/constants.ts","webpack:///../../../packages/styled/src/utils/utils.ts","webpack:///../../../packages/styled/src/keyframes/keyframes.ts","webpack:///../../../packages/styled/src/tokens/tokens.ts","webpack:///../../../packages/styled/src/theme/theme.ts","webpack:///../../../packages/styled/src/server/manager.ts","webpack:///../../../packages/styled/src/parse/parse.ts","webpack:///../../../packages/styled/src/hash/hash.ts","webpack:///../../../packages/styled/src/styled/styled.ts","webpack:///../../../packages/styled/src/global/global.ts","webpack:///./components/spinner.tsx","webpack:///./components/app.tsx","webpack:///./bootstrap.tsx","webpack:///./index.tsx"],"sourcesContent":["var inProgress = {};\n// data-webpack is not used as build has no uniqueName\n// loadScript function to load a script via script tag\n__webpack_require__.l = (url, done, key, chunkId) => {\n\tif(inProgress[url]) { inProgress[url].push(done); return; }\n\tvar script, needAttach;\n\tif(key !== undefined) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tfor(var i = 0; i < scripts.length; i++) {\n\t\t\tvar s = scripts[i];\n\t\t\tif(s.getAttribute(\"src\") == url) { script = s; break; }\n\t\t}\n\t}\n\tif(!script) {\n\t\tneedAttach = true;\n\t\tscript = document.createElement('script');\n\n\t\tscript.charset = 'utf-8';\n\t\tscript.timeout = 120;\n\t\tif (__webpack_require__.nc) {\n\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n\t\t}\n\n\t\tscript.src = url;\n\t}\n\tinProgress[url] = [done];\n\tvar onScriptComplete = (prev, event) => {\n\t\t// avoid mem leaks in IE.\n\t\tscript.onerror = script.onload = null;\n\t\tclearTimeout(timeout);\n\t\tvar doneFns = inProgress[url];\n\t\tdelete inProgress[url];\n\t\tscript.parentNode && script.parentNode.removeChild(script);\n\t\tdoneFns && doneFns.forEach((fn) => (fn(event)));\n\t\tif(prev) return prev(event);\n\t};\n\tvar timeout = setTimeout(onScriptComplete.bind(null, undefined, { type: 'timeout', target: script }), 120000);\n\tscript.onerror = onScriptComplete.bind(null, script.onerror);\n\tscript.onload = onScriptComplete.bind(null, script.onload);\n\tneedAttach && document.head.appendChild(script);\n};","import { type ElementKey, type Instance } from '../shared';\r\nimport { KEY_ATTR } from '../constants';\r\nimport { error } from '../utils';\r\nimport { type Ref } from '../ref';\r\nimport type {\r\n  CreateElement,\r\n  ComponentFactory,\r\n  ComponentOptions,\r\n  ShouldUpdate,\r\n  StandardComponentProps,\r\n  ComponentInject,\r\n  ComponentFactoryWithPossiblyInject,\r\n} from './types';\r\n\r\nconst $$inject = Symbol('inject');\r\nclass Component<P extends StandardComponentProps = any, R = any> {\r\n  public type: CreateElement<P>;\r\n  public props: P;\r\n  public ref?: Ref<R>;\r\n  public token?: Symbol;\r\n  public displayName?: string;\r\n  public shouldUpdate?: ShouldUpdate<P>;\r\n  public children: Array<Instance> = [];\r\n\r\n  constructor(\r\n    type: CreateElement<P>,\r\n    token: Symbol,\r\n    props: P,\r\n    ref: Ref<R>,\r\n    shouldUpdate: ShouldUpdate<P>,\r\n    displayName: string,\r\n  ) {\r\n    this.type = type;\r\n    this.props = props;\r\n    ref && (this.ref = ref);\r\n    token && (this.token = token);\r\n    shouldUpdate && (this.shouldUpdate = shouldUpdate);\r\n    displayName && (this.displayName = displayName);\r\n  }\r\n}\r\n\r\nfunction component<P extends object, R = unknown>(type: CreateElement<P, R>, options: ComponentOptions = {}) {\r\n  const { token: $token, displayName } = options;\r\n  type Props = P & StandardComponentProps;\r\n  const factory: ComponentFactoryWithPossiblyInject<Props, R> = (props = {} as Props, ref?: Ref<R>) => {\r\n    const { token = $token, shouldUpdate } = factory[$$inject] || defaultInject;\r\n\r\n    if (props.ref) {\r\n      delete props.ref;\r\n\r\n      if (process.env.NODE_ENV !== 'production') {\r\n        process.env.NODE_ENV === 'development' &&\r\n          error(`[Dark]: To use ref you need to wrap the component with forwardRef!`);\r\n      }\r\n    }\r\n\r\n    return new Component(type, token, props, ref, shouldUpdate, displayName);\r\n  };\r\n\r\n  return factory as ComponentFactory<Props, R>;\r\n}\r\n\r\nconst defaultInject: ComponentInject = {};\r\n\r\nconst detectIsComponent = (x: unknown): x is Component => x instanceof Component;\r\n\r\nconst getComponentKey = (x: Component): ElementKey => x.props[KEY_ATTR] ?? null;\r\n\r\nconst hasComponentFlag = (inst: Component, flag: string) => Boolean(inst.props[flag]);\r\n\r\nexport { Component, component, $$inject, detectIsComponent, getComponentKey, hasComponentFlag };\r\n","export const VERSION = '0.25.1';\r\nexport const ROOT = 'dark:root';\r\nexport const REPLACER = 'dark:matter';\r\nexport const INDEX_KEY = 'dark:idx';\r\nexport const KEY_ATTR = 'key';\r\nexport const REF_ATTR = 'ref';\r\nexport const CREATE_EFFECT_TAG = 'C';\r\nexport const UPDATE_EFFECT_TAG = 'U';\r\nexport const DELETE_EFFECT_TAG = 'D';\r\nexport const SKIP_EFFECT_TAG = 'S';\r\nexport const INSERTION_EFFECT_HOST_MASK = 1;\r\nexport const LAYOUT_EFFECT_HOST_MASK = 2;\r\nexport const ASYNC_EFFECT_HOST_MASK = 4;\r\nexport const ATOM_HOST_MASK = 8;\r\nexport const PORTAL_HOST_MASK = 16;\r\nexport const SHADOW_MASK = 32;\r\nexport const FLUSH_MASK = 64;\r\nexport const MOVE_MASK = 128;\r\nexport const HOOK_DELIMETER = ':';\r\nexport const YIELD_INTERVAL = 6;\r\nexport const APP_STATE_ATTR = 'dark-app-state';\r\n\r\nexport enum TaskPriority {\r\n  LOW = 0,\r\n  NORMAL = 1,\r\n  HIGH = 2,\r\n}\r\n\r\nexport enum Flag {\r\n  SKIP_SCAN_OPT = '__skipScanOpt',\r\n  MEMO_SLOT_OPT = '__memoSlotOpt',\r\n  STATIC_SLOT_OPT = '__staticSlotOpt',\r\n}\r\n\r\nexport const FLAGS = {\r\n  __skipScanOpt: true,\r\n  __memoSlotOpt: true,\r\n  __staticSlotOpt: true,\r\n};\r\n\r\nexport const ATTR_BLACK_LIST = {\r\n  [KEY_ATTR]: true,\r\n  [REF_ATTR]: true,\r\n  [Flag.SKIP_SCAN_OPT]: true,\r\n  [Flag.MEMO_SLOT_OPT]: true,\r\n  [Flag.STATIC_SLOT_OPT]: true,\r\n};\r\n","import { detectIsString, detectIsFunction } from '../utils';\r\nimport { type TagVirtualNodeFactory, type ViewOptions, View } from '../view';\r\nimport { type ComponentFactory } from '../component';\r\n\r\nfunction createElement(\r\n  element: string | Function,\r\n  props: object,\r\n  ...slot: Array<any>\r\n): ComponentFactory | TagVirtualNodeFactory | null {\r\n  if (detectIsString(element)) {\r\n    const options = (props || {}) as ViewOptions;\r\n\r\n    options.as = element;\r\n    options.slot = slot;\r\n\r\n    return View(options);\r\n  }\r\n\r\n  if (detectIsFunction(element)) {\r\n    const options = (props || {}) as { slot: unknown };\r\n\r\n    options.slot = slot.length === 1 ? slot[0] : slot;\r\n\r\n    return element(options);\r\n  }\r\n\r\n  return null;\r\n}\r\n\r\nexport { createElement, createElement as h };\r\n","import type { NestedArray } from '../shared';\r\nimport { INDEX_KEY } from '../constants';\r\n\r\nconst detectIsFunction = (o: any): o is Function => typeof o === 'function';\r\n\r\nconst detectIsUndefined = (o: any): o is undefined => typeof o === 'undefined';\r\n\r\nconst detectIsNumber = (o: any): o is number => typeof o === 'number';\r\n\r\nconst detectIsString = (o: any): o is string => typeof o === 'string';\r\n\r\nconst detectIsTextBased = (o: any): o is string | number => typeof o === 'string' || typeof o === 'number';\r\n\r\nconst detectIsObject = (o: any): o is object => typeof o === 'object';\r\n\r\nconst detectIsBoolean = (o: any): o is boolean => typeof o === 'boolean';\r\n\r\nconst detectIsArray = (o: any): o is Array<any> => Array.isArray(o);\r\n\r\nconst detectIsNull = (o: any): o is null => o === null;\r\n\r\nconst detectIsEmpty = (o: any) => detectIsNull(o) || detectIsUndefined(o);\r\n\r\nconst detectIsFalsy = (o: any) => detectIsEmpty(o) || o === false;\r\n\r\nconst getTime = () => Date.now();\r\n\r\nconst dummyFn = () => {};\r\n\r\nconst trueFn = () => true;\r\n\r\nconst falseFn = () => false;\r\n\r\nconst sameFn = <T = any>(x: T) => x;\r\n\r\nconst error = (...args: Array<any>) => !detectIsUndefined(console) && console.error(...args);\r\n\r\nfunction flatten<T = any>(source: Array<NestedArray<T>>, transform: (x: T) => any = sameFn): Array<T> {\r\n  if (detectIsArray(source)) {\r\n    if (source.length === 0) return [];\r\n  } else {\r\n    return [transform(source)];\r\n  }\r\n  const list: Array<T> = [];\r\n  const stack = [source[0]];\r\n  let idx = 0;\r\n\r\n  while (stack.length > 0) {\r\n    const x = stack.pop();\r\n\r\n    if (detectIsArray(x)) {\r\n      for (let i = x.length - 1; i >= 0; i--) {\r\n        stack.push(x[i]);\r\n      }\r\n    } else {\r\n      list.push(transform(x));\r\n\r\n      if (stack.length === 0 && idx < source.length - 1) {\r\n        idx++;\r\n        stack.push(source[idx]);\r\n      }\r\n    }\r\n  }\r\n\r\n  return list;\r\n}\r\n\r\nfunction keyBy<T = any>(\r\n  list: Array<T>,\r\n  fn: (o: T) => string | number,\r\n  value = false,\r\n): Record<string | number, T | boolean> {\r\n  return list.reduce((acc, x) => ((acc[fn(x)] = value ? x : true), acc), {});\r\n}\r\n\r\nfunction detectAreDepsDifferent(prevDeps: Array<unknown>, nextDeps: Array<unknown>): boolean {\r\n  if (prevDeps === nextDeps) return false;\r\n  const max = Math.max(prevDeps.length, nextDeps.length);\r\n\r\n  for (let i = 0; i < max; i++) {\r\n    if (!Object.is(prevDeps[i], nextDeps[i])) return true;\r\n  }\r\n\r\n  return false;\r\n}\r\n\r\nfunction nextTick(callback: () => void) {\r\n  Promise.resolve().then(callback);\r\n}\r\n\r\nconst createIndexKey = (idx: number) => `${INDEX_KEY}:${idx}`;\r\n\r\nexport {\r\n  detectIsFunction,\r\n  detectIsUndefined,\r\n  detectIsNumber,\r\n  detectIsString,\r\n  detectIsTextBased,\r\n  detectIsObject,\r\n  detectIsBoolean,\r\n  detectIsArray,\r\n  detectIsNull,\r\n  detectIsEmpty,\r\n  detectIsFalsy,\r\n  getTime,\r\n  dummyFn,\r\n  trueFn,\r\n  falseFn,\r\n  error,\r\n  flatten,\r\n  keyBy,\r\n  detectAreDepsDifferent,\r\n  nextTick,\r\n  createIndexKey,\r\n};\r\n","import type { ElementKey, DarkElement, Instance, SlotProps, RefProps, KeyProps, FlagProps } from '../shared';\r\nimport { type Component, detectIsComponent, getComponentKey, hasComponentFlag } from '../component';\r\nimport { detectIsArray, detectIsFunction } from '../utils';\r\nimport { REPLACER, KEY_ATTR } from '../constants';\r\nimport { $$scope } from '../scope';\r\n\r\nconst $$vNode = Symbol('vNode');\r\nconst ATTR_TYPE = 'type';\r\n\r\nclass VirtualNode {\r\n  public type: NodeType = null;\r\n\r\n  constructor(type: NodeType) {\r\n    this.type = type;\r\n  }\r\n}\r\n\r\nclass TagVirtualNode extends VirtualNode {\r\n  public name: string;\r\n  public attrs: Record<string, any>;\r\n  public children: Array<TextVirtualNode | CommentVirtualNode | TagVirtualNode | VirtualNodeFactory | Component>;\r\n\r\n  constructor(name: string, attrs: TagVirtualNode['attrs'], children: TagVirtualNode['children']) {\r\n    super(NodeType.TAG);\r\n    this.name = name;\r\n    this.attrs = attrs;\r\n    this.children = children;\r\n  }\r\n}\r\n\r\nclass TextVirtualNode extends VirtualNode {\r\n  public value: string;\r\n\r\n  constructor(source: TextSource) {\r\n    super(NodeType.TEXT);\r\n    this.value = String(source);\r\n  }\r\n}\r\n\r\nclass CommentVirtualNode extends VirtualNode {\r\n  public value = '';\r\n\r\n  constructor(text: string) {\r\n    super(NodeType.COMMENT);\r\n    this.value = text;\r\n  }\r\n}\r\n\r\nfunction View(options: ViewOptions) {\r\n  const factory: TagVirtualNodeFactory = () => {\r\n    const { as: name, slot, _void = false, ...attrs } = options;\r\n    const children = (_void ? [] : detectIsArray(slot) ? slot : slot ? [slot] : []) as TagVirtualNode['children'];\r\n\r\n    return new TagVirtualNode(name, attrs, children);\r\n  };\r\n\r\n  factory[$$vNode] = true;\r\n  factory[ATTR_TYPE] = options.as;\r\n  factory[KEY_ATTR] = options.key;\r\n\r\n  return factory;\r\n}\r\n\r\nconst Text = (source: TextSource) => new TextVirtualNode(source);\r\n\r\nText.from = (source: DarkElement) => (detectIsTextVirtualNode(source) ? source.value : source + '');\r\n\r\nconst Comment = (text: string) => new CommentVirtualNode(text);\r\n\r\nconst detectIsVirtualNode = (vNode: unknown): vNode is VirtualNode => vNode instanceof VirtualNode;\r\n\r\nconst detectIsTagVirtualNode = (vNode: unknown): vNode is TagVirtualNode => vNode instanceof TagVirtualNode;\r\n\r\nconst detectIsCommentVirtualNode = (vNode: unknown): vNode is CommentVirtualNode => vNode instanceof CommentVirtualNode;\r\n\r\nconst detectIsTextVirtualNode = (vNode: unknown): vNode is TextVirtualNode => vNode instanceof TextVirtualNode;\r\n\r\nconst detectIsVirtualNodeFactory = (factory: unknown): factory is VirtualNodeFactory =>\r\n  detectIsFunction(factory) && factory[$$vNode] === true;\r\n\r\nconst getTagVirtualNodeKey = (vNode: TagVirtualNode): ElementKey | null =>\r\n  vNode.attrs ? vNode.attrs[KEY_ATTR] ?? null : null;\r\n\r\nconst hasTagVirtualNodeFlag = (vNode: TagVirtualNode, flag: string) => Boolean(vNode.attrs && vNode.attrs[flag]);\r\n\r\nconst getVirtualNodeFactoryKey = (factory: VirtualNodeFactory): ElementKey | null => factory[KEY_ATTR] ?? null;\r\n\r\nconst hasVirtualNodeFactoryFlag = (factory: VirtualNodeFactory, flag: string) => Boolean(factory[flag]);\r\n\r\nconst detectIsPlainVirtualNode = (vNode: unknown): vNode is PlainVirtualNode =>\r\n  detectIsTextVirtualNode(vNode) || detectIsCommentVirtualNode(vNode);\r\n\r\nconst createReplacer = () => new CommentVirtualNode(REPLACER);\r\n\r\nconst detectIsReplacer = (vNode: unknown) => detectIsCommentVirtualNode(vNode) && vNode.value === REPLACER;\r\n\r\nfunction getElementKey(inst: Instance): ElementKey | null {\r\n  return detectIsComponent(inst)\r\n    ? getComponentKey(inst)\r\n    : detectIsVirtualNodeFactory(inst)\r\n    ? getVirtualNodeFactoryKey(inst)\r\n    : detectIsTagVirtualNode(inst)\r\n    ? getTagVirtualNodeKey(inst)\r\n    : null;\r\n}\r\n\r\nfunction hasElementFlag(inst: Instance, flag: string) {\r\n  return detectIsComponent(inst)\r\n    ? hasComponentFlag(inst, flag)\r\n    : detectIsVirtualNodeFactory(inst)\r\n    ? hasVirtualNodeFactoryFlag(inst, flag)\r\n    : detectIsTagVirtualNode(inst)\r\n    ? hasTagVirtualNodeFlag(inst, flag)\r\n    : false;\r\n}\r\n\r\nfunction getElementType(inst: Instance): string | Function {\r\n  return detectIsComponent(inst)\r\n    ? inst.type\r\n    : detectIsVirtualNodeFactory(inst)\r\n    ? inst[ATTR_TYPE]\r\n    : detectIsTagVirtualNode(inst)\r\n    ? inst.name\r\n    : detectIsVirtualNode(inst)\r\n    ? inst.type\r\n    : null;\r\n}\r\n\r\nfunction hasChildrenProp(inst: Instance): inst is TagVirtualNode | Component {\r\n  return detectIsTagVirtualNode(inst) || detectIsComponent(inst);\r\n}\r\n\r\nfunction detectAreSameInstanceTypes(prevInst: Instance, nextInst: Instance, isComponentFactories = false) {\r\n  if (process.env.NODE_ENV !== 'production') {\r\n    if (process.env.NODE_ENV === 'development' && $$scope().getIsHot()) {\r\n      if (detectIsComponent(prevInst) && detectIsComponent(nextInst)) {\r\n        return prevInst.displayName === nextInst.displayName;\r\n      }\r\n    }\r\n  }\r\n\r\n  if (isComponentFactories) {\r\n    const pc = prevInst as Component;\r\n    const nc = nextInst as Component;\r\n\r\n    return pc.type === nc.type;\r\n  }\r\n\r\n  return getElementType(prevInst) === getElementType(nextInst);\r\n}\r\n\r\nfunction detectAreSameComponentTypesWithSameKeys(prevInst: Instance | null, nextInst: Instance | null) {\r\n  if (\r\n    prevInst &&\r\n    nextInst &&\r\n    detectIsComponent(prevInst) &&\r\n    detectIsComponent(nextInst) &&\r\n    detectAreSameInstanceTypes(prevInst, nextInst, true)\r\n  ) {\r\n    return getElementKey(prevInst) === getElementKey(nextInst);\r\n  }\r\n\r\n  return false;\r\n}\r\n\r\ntype TextSource = string | number;\r\n\r\nexport type VirtualNodeFactory = () => VirtualNode;\r\n\r\nexport type TagVirtualNodeFactory = () => TagVirtualNode;\r\n\r\nexport type PlainVirtualNode = TextVirtualNode | CommentVirtualNode;\r\n\r\nexport type ViewOptions = {\r\n  as: string;\r\n  _void?: boolean;\r\n  [prop: string]: any;\r\n} & Partial<SlotProps> &\r\n  RefProps &\r\n  KeyProps &\r\n  FlagProps;\r\n\r\nexport enum NodeType {\r\n  TAG = 'TAG',\r\n  TEXT = 'TEXT',\r\n  COMMENT = 'COMMENT',\r\n}\r\n\r\nexport {\r\n  View,\r\n  Text,\r\n  Comment,\r\n  VirtualNode,\r\n  TagVirtualNode,\r\n  TextVirtualNode,\r\n  CommentVirtualNode,\r\n  createReplacer,\r\n  detectIsReplacer,\r\n  getElementKey,\r\n  hasElementFlag,\r\n  getElementType,\r\n  hasChildrenProp,\r\n  detectIsVirtualNode,\r\n  detectIsTagVirtualNode,\r\n  detectIsCommentVirtualNode,\r\n  detectIsTextVirtualNode,\r\n  detectIsPlainVirtualNode,\r\n  detectIsVirtualNodeFactory,\r\n  detectAreSameInstanceTypes,\r\n  detectAreSameComponentTypesWithSameKeys,\r\n};\r\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = (chunkId) => {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce((promises, key) => {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks\n__webpack_require__.u = (chunkId) => {\n\t// return url for filenames based on template\n\treturn \"\" + chunkId + \".build.js\";\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript)\n\t\tscriptUrl = document.currentScript.src\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) scriptUrl = scripts[scripts.length - 1].src\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t179: 0\n};\n\n__webpack_require__.f.j = (chunkId, promises) => {\n\t\t// JSONP chunk loading for javascript\n\t\tvar installedChunkData = __webpack_require__.o(installedChunks, chunkId) ? installedChunks[chunkId] : undefined;\n\t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n\t\t\t// a Promise means \"currently loading\".\n\t\t\tif(installedChunkData) {\n\t\t\t\tpromises.push(installedChunkData[2]);\n\t\t\t} else {\n\t\t\t\tif(true) { // all chunks have JS\n\t\t\t\t\t// setup Promise in chunk cache\n\t\t\t\t\tvar promise = new Promise((resolve, reject) => (installedChunkData = installedChunks[chunkId] = [resolve, reject]));\n\t\t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n\t\t\t\t\t// start chunk loading\n\t\t\t\t\tvar url = __webpack_require__.p + __webpack_require__.u(chunkId);\n\t\t\t\t\t// create error before stack unwound to get useful stacktrace later\n\t\t\t\t\tvar error = new Error();\n\t\t\t\t\tvar loadingEnded = (event) => {\n\t\t\t\t\t\tif(__webpack_require__.o(installedChunks, chunkId)) {\n\t\t\t\t\t\t\tinstalledChunkData = installedChunks[chunkId];\n\t\t\t\t\t\t\tif(installedChunkData !== 0) installedChunks[chunkId] = undefined;\n\t\t\t\t\t\t\tif(installedChunkData) {\n\t\t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n\t\t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n\t\t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n\t\t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n\t\t\t\t\t\t\t\terror.type = errorType;\n\t\t\t\t\t\t\t\terror.request = realSrc;\n\t\t\t\t\t\t\t\tinstalledChunkData[1](error);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\t__webpack_require__.l(url, loadingEnded, \"chunk-\" + chunkId, chunkId);\n\t\t\t\t} else installedChunks[chunkId] = 0;\n\t\t\t}\n\t\t}\n};\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some((id) => (installedChunks[id] !== 0))) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunk\"] = self[\"webpackChunk\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","import { type Fiber } from '../fiber';\r\nimport { type VirtualNode } from '../view';\r\nimport { type Callback } from '../shared';\r\n\r\nexport type Platform = {\r\n  createElement: <N>(vNode: VirtualNode) => N;\r\n  insertElement: <N>(node: N, idx: number, parent: N) => void;\r\n  raf: typeof requestAnimationFrame;\r\n  caf: typeof cancelAnimationFrame;\r\n  spawn: (callback: Callback) => void;\r\n  commit: (fiber: Fiber) => void;\r\n  finishCommit: () => void;\r\n  detectIsDynamic: () => boolean;\r\n  detectIsPortal: (instance: unknown) => boolean;\r\n  unmountPortal: (fiber: Fiber) => void;\r\n  chunk: (fiber: Fiber) => void;\r\n};\r\n\r\nconst defaultRealisation = () => {\r\n  throw new Error('Function not installed by renderer!');\r\n};\r\n\r\nconst platform: Platform = {\r\n  createElement: defaultRealisation,\r\n  insertElement: defaultRealisation,\r\n  raf: defaultRealisation,\r\n  caf: defaultRealisation,\r\n  spawn: defaultRealisation,\r\n  commit: defaultRealisation,\r\n  finishCommit: defaultRealisation,\r\n  detectIsDynamic: defaultRealisation,\r\n  detectIsPortal: defaultRealisation,\r\n  unmountPortal: defaultRealisation,\r\n  chunk: defaultRealisation,\r\n};\r\n\r\nconst detectIsServer = () => !platform.detectIsDynamic();\r\n\r\nexport { platform, detectIsServer };\r\n","import { type SubscriberWithValue } from '../shared';\r\n\r\ntype EventName = 'finish' | 'chunk';\r\n\r\nclass EventEmitter<E extends string = EventName, T = unknown> {\r\n  private subscribers: Map<Partial<E>, Set<SubscriberWithValue<unknown>>> = new Map();\r\n\r\n  on<T>(e: E, fn: SubscriberWithValue<T>) {\r\n    !this.subscribers.has(e) && this.subscribers.set(e, new Set());\r\n    this.subscribers.get(e).add(fn);\r\n\r\n    return () => this.subscribers.has(e) && this.subscribers.get(e).delete(fn);\r\n  }\r\n\r\n  emit(e: E, data?: T) {\r\n    this.subscribers.has(e) && this.subscribers.get(e).forEach(x => x(data));\r\n  }\r\n\r\n  kill() {\r\n    this.subscribers = new Map();\r\n  }\r\n\r\n  __getSize() {\r\n    return this.subscribers.size;\r\n  }\r\n}\r\n\r\nexport { EventEmitter };\r\n","import type { Callback, ElementKey, AppResources, AppResource } from '../shared';\r\nimport { type SetPendingStatus } from '../start-transition';\r\nimport { platform, detectIsServer } from '../platform';\r\nimport { EventEmitter } from '../emitter';\r\nimport { type Fiber } from '../fiber';\r\n\r\nclass Scope {\r\n  private root: Fiber = null;\r\n  private wip: Fiber = null;\r\n  private cursor: Fiber = null;\r\n  private unit: Fiber = null;\r\n  private mountDeep = true;\r\n  private mountLevel = 0;\r\n  private mountNav: Record<number, number> = {};\r\n  private events: Map<string, WeakMap<object, Function>> = new Map();\r\n  private unsubs: Set<Callback> = new Set();\r\n  private actions: Actions = {};\r\n  private candidates: Set<Fiber> = new Set();\r\n  private deletions: Set<Fiber> = new Set();\r\n  private cancels: Array<Callback> = [];\r\n  private asyncEffects: Set<Callback> = new Set();\r\n  private layoutEffects: Set<Callback> = new Set();\r\n  private insertionEffects: Set<Callback> = new Set();\r\n  private resourceId = 0;\r\n  private resources: AppResources = new Map();\r\n  private defers: Array<() => Promise<unknown>> = [];\r\n  private setPendingStatus: SetPendingStatus = null;\r\n  private isLayoutEffectsZone = false;\r\n  private isInsertionEffectsZone = false;\r\n  private isUpdateZone = false;\r\n  private isBatchZone = false;\r\n  private isHydrateZone = false;\r\n  private isStreamZone = false;\r\n  private isTransitionZone = false;\r\n  private isEventZone = false;\r\n  private isHot = false;\r\n  private isDynamic = platform.detectIsDynamic();\r\n  private isServer = detectIsServer();\r\n  private emitter = new EventEmitter();\r\n\r\n  private resetActions() {\r\n    this.actions = {};\r\n  }\r\n\r\n  getActionsById(id: number) {\r\n    return this.actions[id];\r\n  }\r\n\r\n  addActionMap(id: number, map: Record<ElementKey, Fiber>) {\r\n    this.actions[id] = {\r\n      map,\r\n      replace: null,\r\n      insert: null,\r\n      remove: null,\r\n      move: null,\r\n      stable: null,\r\n    };\r\n  }\r\n\r\n  addReplaceAction(id: number, nextKey: ElementKey) {\r\n    !this.actions[id].replace && (this.actions[id].replace = {});\r\n    this.actions[id].replace[nextKey] = true;\r\n  }\r\n\r\n  addInsertAction(id: number, nextKey: ElementKey) {\r\n    !this.actions[id].insert && (this.actions[id].insert = {});\r\n    this.actions[id].insert[nextKey] = true;\r\n  }\r\n\r\n  addRemoveAction(id: number, prevKey: ElementKey) {\r\n    !this.actions[id].remove && (this.actions[id].remove = {});\r\n    this.actions[id].remove[prevKey] = true;\r\n  }\r\n\r\n  addMoveAction(id: number, nextKey: ElementKey) {\r\n    !this.actions[id].move && (this.actions[id].move = {});\r\n    this.actions[id].move[nextKey] = true;\r\n  }\r\n\r\n  addStableAction(id: number, nextKey: ElementKey) {\r\n    !this.actions[id].stable && (this.actions[id].stable = {});\r\n    this.actions[id].stable[nextKey] = true;\r\n  }\r\n\r\n  copy() {\r\n    const scope = new Scope();\r\n\r\n    scope.root = null;\r\n    scope.wip = null;\r\n    scope.cursor = null;\r\n    scope.unit = this.unit;\r\n    scope.mountDeep = this.mountDeep;\r\n    scope.mountLevel = this.mountLevel;\r\n    scope.mountNav = { ...this.mountNav };\r\n    scope.events = this.events;\r\n    scope.unsubs = this.unsubs;\r\n    scope.actions = { ...this.actions };\r\n    scope.candidates = new Set([...this.candidates]);\r\n    scope.deletions = new Set([...this.deletions]);\r\n    scope.asyncEffects = new Set([...this.asyncEffects]);\r\n    scope.layoutEffects = new Set([...this.layoutEffects]);\r\n    scope.insertionEffects = new Set([...this.insertionEffects]);\r\n    scope.isUpdateZone = this.isUpdateZone;\r\n    scope.emitter = this.emitter;\r\n\r\n    return scope;\r\n  }\r\n\r\n  getRoot() {\r\n    return this.root;\r\n  }\r\n\r\n  setRoot(fiber: Fiber) {\r\n    this.root = fiber;\r\n  }\r\n\r\n  getWorkInProgress() {\r\n    return this.wip;\r\n  }\r\n\r\n  setWorkInProgress(fiber: Fiber) {\r\n    this.wip = fiber;\r\n  }\r\n\r\n  getNextUnitOfWork() {\r\n    return this.unit;\r\n  }\r\n\r\n  setNextUnitOfWork(fiber: Fiber) {\r\n    this.unit = fiber;\r\n  }\r\n\r\n  getCursorFiber() {\r\n    return this.cursor;\r\n  }\r\n\r\n  setCursorFiber(fiber: Fiber) {\r\n    this.cursor = fiber;\r\n  }\r\n\r\n  navToChild() {\r\n    this.mountLevel = this.mountLevel + 1;\r\n    this.mountNav[this.mountLevel] = 0;\r\n  }\r\n\r\n  navToSibling() {\r\n    this.mountNav[this.mountLevel] = this.mountNav[this.mountLevel] + 1;\r\n  }\r\n\r\n  navToParent() {\r\n    this.mountLevel = this.mountLevel - 1;\r\n  }\r\n\r\n  navToPrev() {\r\n    const idx = this.getMountIndex();\r\n\r\n    if (idx === 0) {\r\n      this.navToParent();\r\n      this.setMountDeep(true);\r\n    } else {\r\n      this.mountNav[this.mountLevel] = this.mountNav[this.mountLevel] - 1;\r\n      this.setMountDeep(false);\r\n    }\r\n  }\r\n\r\n  getMountIndex() {\r\n    return this.mountNav[this.mountLevel];\r\n  }\r\n\r\n  getMountDeep() {\r\n    return this.mountDeep;\r\n  }\r\n\r\n  setMountDeep(value: boolean) {\r\n    this.mountDeep = value;\r\n  }\r\n\r\n  resetMount() {\r\n    this.mountLevel = 0;\r\n    this.mountNav = {};\r\n    this.mountDeep = true;\r\n  }\r\n\r\n  getEvents() {\r\n    return this.events;\r\n  }\r\n\r\n  addEventUnsubscriber(fn: Callback) {\r\n    this.unsubs.add(fn);\r\n  }\r\n\r\n  unsubscribeEvents() {\r\n    this.unsubs.forEach(x => x());\r\n    this.unsubs = new Set();\r\n  }\r\n\r\n  getCandidates() {\r\n    return this.candidates;\r\n  }\r\n\r\n  addCandidate(fiber: Fiber) {\r\n    this.candidates.add(fiber);\r\n  }\r\n\r\n  resetCandidates() {\r\n    this.candidates = new Set();\r\n  }\r\n\r\n  getDeletions() {\r\n    return this.deletions;\r\n  }\r\n\r\n  hasDeletion(fiber: Fiber) {\r\n    let nextFiber = fiber;\r\n\r\n    while (nextFiber) {\r\n      if (this.deletions.has(nextFiber)) return true;\r\n      nextFiber = nextFiber.parent;\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  addDeletion(fiber: Fiber) {\r\n    !this.hasDeletion(fiber) && this.deletions.add(fiber);\r\n  }\r\n\r\n  resetDeletions() {\r\n    this.deletions = new Set();\r\n  }\r\n\r\n  addAsyncEffect(fn: Callback) {\r\n    this.asyncEffects.add(fn);\r\n  }\r\n\r\n  resetAsyncEffects() {\r\n    this.asyncEffects = new Set();\r\n  }\r\n\r\n  runAsyncEffects() {\r\n    if (!this.isDynamic) return;\r\n    const effects = this.asyncEffects;\r\n    effects.size > 0 && setTimeout(() => effects.forEach(fn => fn()));\r\n  }\r\n\r\n  addLayoutEffect(fn: Callback) {\r\n    this.layoutEffects.add(fn);\r\n  }\r\n\r\n  resetLayoutEffects() {\r\n    this.layoutEffects = new Set();\r\n  }\r\n\r\n  runLayoutEffects() {\r\n    if (!this.isDynamic) return;\r\n    this.setIsLayoutEffectsZone(true);\r\n    this.layoutEffects.forEach(fn => fn());\r\n    this.setIsLayoutEffectsZone(false);\r\n  }\r\n\r\n  addInsertionEffect(fn: Callback) {\r\n    this.insertionEffects.add(fn);\r\n  }\r\n\r\n  resetInsertionEffects() {\r\n    this.insertionEffects = new Set();\r\n  }\r\n\r\n  runInsertionEffects() {\r\n    if (!this.isDynamic) return;\r\n    this.setIsInsertionEffectsZone(true);\r\n    this.insertionEffects.forEach(fn => fn());\r\n    this.setIsInsertionEffectsZone(false);\r\n  }\r\n\r\n  addCancel(fn: Callback) {\r\n    this.cancels.push(fn);\r\n  }\r\n\r\n  applyCancels() {\r\n    for (let i = this.cancels.length - 1; i >= 0; i--) {\r\n      this.cancels[i]();\r\n    }\r\n  }\r\n\r\n  resetCancels() {\r\n    this.cancels = [];\r\n  }\r\n\r\n  getIsLayoutEffectsZone() {\r\n    return this.isLayoutEffectsZone;\r\n  }\r\n\r\n  setIsLayoutEffectsZone(value: boolean) {\r\n    this.isLayoutEffectsZone = value;\r\n  }\r\n\r\n  getIsInsertionEffectsZone() {\r\n    return this.isInsertionEffectsZone;\r\n  }\r\n\r\n  setIsInsertionEffectsZone(value: boolean) {\r\n    this.isInsertionEffectsZone = value;\r\n  }\r\n\r\n  getIsUpdateZone() {\r\n    return this.isUpdateZone;\r\n  }\r\n\r\n  setIsUpdateZone(value: boolean) {\r\n    this.isUpdateZone = value;\r\n  }\r\n\r\n  getIsBatchZone() {\r\n    return this.isBatchZone;\r\n  }\r\n\r\n  setIsBatchZone(value: boolean) {\r\n    this.isBatchZone = value;\r\n  }\r\n\r\n  getIsHydrateZone() {\r\n    return this.isHydrateZone;\r\n  }\r\n\r\n  setIsHydrateZone(value: boolean) {\r\n    this.isHydrateZone = value;\r\n  }\r\n\r\n  getIsStreamZone() {\r\n    return this.isStreamZone;\r\n  }\r\n\r\n  setIsStreamZone(value: boolean) {\r\n    this.isStreamZone = value;\r\n  }\r\n\r\n  getIsTransitionZone() {\r\n    return this.isTransitionZone;\r\n  }\r\n\r\n  setIsTransitionZone(value: boolean) {\r\n    this.isTransitionZone = value;\r\n  }\r\n\r\n  getIsEventZone() {\r\n    return this.isEventZone;\r\n  }\r\n\r\n  setIsEventZone(value: boolean) {\r\n    this.isEventZone = value;\r\n  }\r\n\r\n  getIsHot() {\r\n    return this.isHot;\r\n  }\r\n\r\n  setIsHot(value: boolean) {\r\n    this.isHot = value;\r\n  }\r\n\r\n  getPendingStatusSetter() {\r\n    return this.setPendingStatus;\r\n  }\r\n\r\n  setPendingStatusSetter(fn: SetPendingStatus) {\r\n    this.setPendingStatus = fn;\r\n  }\r\n\r\n  flush() {\r\n    !this.isUpdateZone && this.setRoot(this.wip); // !\r\n    this.setWorkInProgress(null);\r\n    this.setNextUnitOfWork(null);\r\n    this.setCursorFiber(null);\r\n    this.resetMount();\r\n    this.resetCandidates();\r\n    this.resetDeletions();\r\n    this.resetCancels();\r\n    this.resetInsertionEffects();\r\n    this.resetLayoutEffects();\r\n    this.resetAsyncEffects();\r\n    this.setIsHydrateZone(false);\r\n    this.setIsUpdateZone(false);\r\n    this.resetActions();\r\n  }\r\n\r\n  getEmitter() {\r\n    return this.emitter;\r\n  }\r\n\r\n  defer(fn: () => Promise<unknown>) {\r\n    this.defers.push(fn);\r\n  }\r\n\r\n  getDefers() {\r\n    return this.defers;\r\n  }\r\n\r\n  resetDefers() {\r\n    this.defers = [];\r\n  }\r\n\r\n  getResource(id: number) {\r\n    return this.resources.get(id);\r\n  }\r\n\r\n  setResource(id: number, res: AppResource) {\r\n    this.resources.set(id, res);\r\n  }\r\n\r\n  getResources() {\r\n    return this.resources;\r\n  }\r\n\r\n  getResourceId() {\r\n    return this.resourceId;\r\n  }\r\n\r\n  setResourceId(id: number) {\r\n    this.resourceId = id;\r\n  }\r\n\r\n  getNextResourceId() {\r\n    return ++this.resourceId;\r\n  }\r\n\r\n  runAfterCommit() {\r\n    this.resources = new Map();\r\n    this.isServer && (this.resourceId = 0);\r\n  }\r\n}\r\n\r\ntype Actions = Record<\r\n  number,\r\n  {\r\n    map: Record<ElementKey, Fiber>;\r\n    replace: Record<ElementKey, true>;\r\n    insert: Record<ElementKey, true>;\r\n    remove: Record<ElementKey, true>;\r\n    move: Record<ElementKey, true>;\r\n    stable: Record<ElementKey, true>;\r\n  }\r\n>;\r\n\r\nlet rootId: number = null;\r\nconst scopes = new Map<number, Scope>();\r\n\r\nconst getRootId = () => rootId;\r\n\r\nconst setRootId = (id: number) => {\r\n  rootId = id;\r\n  !scopes.has(rootId) && scopes.set(rootId, new Scope());\r\n};\r\n\r\nconst removeScope = (id: number) => scopes.delete(id);\r\n\r\nconst replaceScope = (scope: Scope, id: number = rootId) => {\r\n  Object.assign(scopes.get(id), scope);\r\n};\r\n\r\nconst $$scope = (id: number = rootId) => scopes.get(id);\r\n\r\nexport { type Scope, getRootId, setRootId, removeScope, replaceScope, $$scope };\r\n","import { detectIsTagVirtualNode, detectIsPlainVirtualNode, detectAreSameComponentTypesWithSameKeys } from '../view';\r\nimport { type Instance, type Callback, type TimerId } from '../shared';\r\nimport { type Context, type ContextProviderValue } from '../context';\r\nimport { detectIsComponent } from '../component';\r\nimport { detectIsFunction } from '../utils';\r\nimport { type Atom } from '../atom';\r\nimport { $$scope } from '../scope';\r\n\r\nclass Fiber<N = NativeElement> {\r\n  id = 0;\r\n  cc = 0; // child fibers count\r\n  cec = 0; // child native elements count\r\n  idx = 0; // idx of fiber in the parent fiber\r\n  eidx = 0; // native element idx\r\n  mask = 0; // bit mask\r\n  element: N = null; // native element\r\n  tag: string = null; // effect tag (CREATE, UPDATE, DELETE, SKIP)\r\n  parent: Fiber<N> = null; // parent fiber\r\n  child: Fiber<N> = null; // child fiber\r\n  next: Fiber<N> = null; // next sibling fiber\r\n  alt: Fiber<N> = null; // alternate fiber (previous)\r\n  inst: Instance = null; // instance of component or virtual node\r\n  hook: Hook | null = null; // hook\r\n  provider: Map<Context, ContextProviderValue> = null; // provider of context\r\n  atoms: Map<Atom, Callback> = null;\r\n  marker: string; // for dev\r\n  batch: Batch;\r\n  catch: (error: Error) => void;\r\n\r\n  constructor(hook: Hook = null, provider: Fiber['provider'] = null, idx = 0) {\r\n    this.id = ++Fiber.nextId;\r\n    this.idx = idx;\r\n    hook && (this.hook = hook);\r\n    provider && (this.provider = provider);\r\n  }\r\n\r\n  mutate(fiber: Partial<Fiber<N>>) {\r\n    const keys = Object.keys(fiber);\r\n\r\n    for (const key of keys) {\r\n      this[key] = fiber[key];\r\n    }\r\n\r\n    return this;\r\n  }\r\n\r\n  markHost(mask: number) {\r\n    this.mask |= mask;\r\n    this.parent && !(this.parent.mask & mask) && this.parent.markHost(mask);\r\n  }\r\n\r\n  increment(count = 1, force = false) {\r\n    if (!this.parent) return;\r\n    const $scope = $$scope();\r\n    const isUpdateZone = $scope.getIsUpdateZone();\r\n    const wipFiber = $scope.getWorkInProgress();\r\n    const stop = isUpdateZone && wipFiber.parent === this.parent;\r\n\r\n    if (\r\n      detectIsPlainVirtualNode(this.inst) ||\r\n      (detectIsTagVirtualNode(this.inst) && this.inst.children?.length === 0)\r\n    ) {\r\n      this.cec = 1;\r\n    }\r\n\r\n    if (isUpdateZone && stop && !force) return;\r\n\r\n    this.parent.cec += count;\r\n\r\n    if (!this.parent.element) {\r\n      this.parent.increment(count);\r\n    }\r\n  }\r\n\r\n  setError(error: Error) {\r\n    if (detectIsFunction(this.catch)) {\r\n      this.catch(error);\r\n    } else if (this.parent) {\r\n      this.parent.setError(error);\r\n    }\r\n  }\r\n\r\n  static setNextId(id: number) {\r\n    Fiber.nextId = id;\r\n  }\r\n\r\n  private static nextId = 0;\r\n}\r\n\r\nclass Hook<T = any> {\r\n  id = 0;\r\n  idx = 0;\r\n  values: Array<T> = [];\r\n  owner: Fiber = null;\r\n  private static nextId = 0;\r\n\r\n  constructor() {\r\n    this.id = ++Hook.nextId;\r\n  }\r\n}\r\n\r\nfunction getHook(alt: Fiber, prevInst: Instance, nextInst: Instance): Hook | null {\r\n  if (alt && detectAreSameComponentTypesWithSameKeys(prevInst, nextInst)) return alt.hook;\r\n  if (detectIsComponent(nextInst)) return new Hook();\r\n\r\n  return null;\r\n}\r\n\r\ntype Batch = {\r\n  timer: TimerId;\r\n  changes: Array<Callback>;\r\n};\r\n\r\nexport type NativeElement = unknown;\r\nexport type HookValue<T = any> = { deps: Array<any>; value: T };\r\n\r\nexport { Fiber, Hook, getHook };\r\n","import { detectIsComponent } from '../component';\r\n\r\nconst $$memo = Symbol('memo');\r\n\r\nconst detectIsMemo = (instance: unknown) => detectIsComponent(instance) && instance.token === $$memo;\r\n\r\nexport { $$memo, detectIsMemo };\r\n","import {\r\n  DELETE_EFFECT_TAG,\r\n  UPDATE_EFFECT_TAG,\r\n  SKIP_EFFECT_TAG,\r\n  INSERTION_EFFECT_HOST_MASK,\r\n  LAYOUT_EFFECT_HOST_MASK,\r\n  ASYNC_EFFECT_HOST_MASK,\r\n  ATOM_HOST_MASK,\r\n  PORTAL_HOST_MASK,\r\n  MOVE_MASK,\r\n  HOOK_DELIMETER,\r\n} from '../constants';\r\nimport { Fiber } from '../fiber';\r\nimport { platform } from '../platform';\r\nimport { type TagVirtualNode, getElementKey, hasChildrenProp } from '../view';\r\nimport { type Scope } from '../scope';\r\nimport { type Component } from '../component';\r\nimport { detectIsMemo } from '../memo/utils';\r\nimport { type Instance, type ElementKey } from '../shared';\r\nimport { createIndexKey } from '../utils';\r\n\r\nfunction walk<T = unknown>(fiber: Fiber<T>, onWalk: (fiber: Fiber<T>, skip: () => void, stop: () => void) => void) {\r\n  let shouldDeep = true;\r\n  let shouldStop = false;\r\n  const skip = () => (shouldDeep = false);\r\n  const stop = () => (shouldStop = true);\r\n  const stack: Array<Fiber<T>> = [fiber];\r\n\r\n  while (stack.length !== 0) {\r\n    const unit = stack.pop();\r\n\r\n    onWalk(unit, skip, stop);\r\n    if (shouldStop) break;\r\n    unit !== fiber && unit.next && stack.push(unit.next);\r\n    shouldDeep && unit.child && stack.push(unit.child);\r\n    shouldDeep = true;\r\n  }\r\n}\r\n\r\nfunction collectElements<T, P = T>(fiber: Fiber<T>, transform: (fiber: Fiber<T>) => P): Array<P> {\r\n  const elements: Array<P> = [];\r\n\r\n  walk<T>(fiber, (fiber, skip) => {\r\n    if (fiber.element) {\r\n      !platform.detectIsPortal(fiber.inst) && elements.push(transform(fiber));\r\n      return skip();\r\n    }\r\n  });\r\n\r\n  return elements;\r\n}\r\n\r\nfunction getFiberWithElement<T1, T2 = T1>(fiber: Fiber<T1>): Fiber<T2> {\r\n  let $fiber = fiber as unknown as Fiber<T2>;\r\n\r\n  while ($fiber) {\r\n    if ($fiber.element) return $fiber;\r\n    $fiber = $fiber.parent;\r\n  }\r\n\r\n  return $fiber;\r\n}\r\n\r\nfunction detectIsFiberAlive(fiber: Fiber) {\r\n  let $fiber = fiber;\r\n\r\n  while ($fiber) {\r\n    if ($fiber.tag === DELETE_EFFECT_TAG) return false;\r\n    $fiber = $fiber.parent;\r\n  }\r\n\r\n  return Boolean(fiber);\r\n}\r\n\r\nfunction createHookLocation(rootId: number, idx: number, fiber: Fiber) {\r\n  let $fiber = fiber;\r\n  let loc = `${fiber.idx}${HOOK_DELIMETER}${idx}`;\r\n\r\n  while ($fiber) {\r\n    $fiber = $fiber.parent;\r\n    $fiber && (loc = `${$fiber.idx}.${loc}`);\r\n  }\r\n\r\n  loc = `[${rootId}]${loc}`;\r\n\r\n  return loc;\r\n}\r\n\r\nfunction detectIsStableMemoTree(fiber: Fiber, $scope: Scope) {\r\n  if (!hasChildrenProp(fiber.inst)) return;\r\n  const actions = $scope.getActionsById(fiber.id);\r\n  const children = fiber.inst.children;\r\n\r\n  for (let i = 0; i < children.length; i++) {\r\n    const inst = children[i];\r\n    const key = getElementKey(inst);\r\n    if (key === null) return false;\r\n    const alt = actions.map[key];\r\n    if (!alt) return false;\r\n    const pc = alt.inst as Component;\r\n    const nc = inst as Component;\r\n    const isStable =\r\n      detectIsMemo(nc) && detectIsMemo(pc) && nc.type === pc.type && !nc.shouldUpdate(pc.props, nc.props);\r\n\r\n    if (!isStable) return false;\r\n  }\r\n\r\n  return true;\r\n}\r\n\r\nfunction tryOptStaticSlot(fiber: Fiber, alt: Fiber, $scope: Scope) {\r\n  const actions = $scope.getActionsById(fiber.id);\r\n  const inst = fiber.inst as Component | TagVirtualNode;\r\n\r\n  alt.element && (fiber.element = alt.element); //!\r\n\r\n  for (let i = 0; i < inst.children.length; i++) {\r\n    buildChildNode(inst.children, fiber, actions.map, i, fiber.eidx);\r\n  }\r\n\r\n  fiber.cc = inst.children.length;\r\n  $scope.setMountDeep(false);\r\n}\r\n\r\nfunction tryOptMemoSlot(fiber: Fiber, alt: Fiber, $scope: Scope) {\r\n  const actions = $scope.getActionsById(fiber.id);\r\n  const hasMove = Boolean(actions.move);\r\n  const hasRemove = Boolean(actions.remove);\r\n  const hasInsert = Boolean(actions.insert);\r\n  const hasReplace = Boolean(actions.insert);\r\n  const canOptimize = ((hasMove && !hasRemove) || (hasRemove && !hasMove)) && !hasInsert && !hasReplace;\r\n\r\n  if (!canOptimize || !detectIsStableMemoTree(fiber, $scope)) return;\r\n\r\n  hasMove && tryOptMov(fiber, alt, $scope);\r\n  hasRemove && tryOptRem(fiber, alt, $scope);\r\n}\r\n\r\nfunction tryOptMov(fiber: Fiber, alt: Fiber, $scope: Scope) {\r\n  const actions = $scope.getActionsById(fiber.id);\r\n\r\n  buildChildNodes(fiber, alt, $scope, (fiber, key) => {\r\n    if (!actions.move[key]) return;\r\n    fiber.alt = new Fiber().mutate(fiber);\r\n    fiber.tag = UPDATE_EFFECT_TAG;\r\n    fiber.mask |= MOVE_MASK;\r\n    $scope.addCandidate(fiber);\r\n  });\r\n}\r\n\r\nfunction tryOptRem(fiber: Fiber, alt: Fiber, $scope: Scope) {\r\n  buildChildNodes(fiber, alt, $scope);\r\n}\r\n\r\nfunction buildChildNodes(fiber: Fiber, alt: Fiber, $scope: Scope, onNode?: (fiber: Fiber, key: ElementKey) => void) {\r\n  const actions = $scope.getActionsById(fiber.id);\r\n  const inst = fiber.inst as Component | TagVirtualNode;\r\n  const children = inst.children;\r\n\r\n  alt.element && (fiber.element = alt.element); //!\r\n\r\n  for (let i = 0; i < children.length; i++) {\r\n    const key = getKey(children[i], i);\r\n    const $fiber = actions.map[key];\r\n\r\n    buildChildNode(children, fiber, actions.map, i, fiber.eidx);\r\n    onNode && onNode($fiber, key);\r\n  }\r\n\r\n  fiber.cc = children.length;\r\n  $scope.setMountDeep(false);\r\n}\r\n\r\nfunction buildChildNode(\r\n  children: Array<Instance>,\r\n  parent: Fiber,\r\n  altMap: Record<string, Fiber>,\r\n  idx: number,\r\n  startEidx: number,\r\n) {\r\n  const prevIdx = idx - 1;\r\n  const nextIdx = idx + 1;\r\n  const key = getKey(children[idx], idx);\r\n  const prevKey = getKey(children[prevIdx], prevIdx);\r\n  const nextKey = getKey(children[nextIdx], nextIdx);\r\n  const fiber = altMap[key];\r\n  const left = altMap[prevKey];\r\n  const right = altMap[nextKey];\r\n  const isFirst = idx === 0;\r\n  const isLast = idx === children.length - 1;\r\n\r\n  isFirst && (parent.child = fiber);\r\n  fiber.alt = null;\r\n  fiber.parent = parent;\r\n  fiber.tag = SKIP_EFFECT_TAG;\r\n  fiber.idx = idx;\r\n  left ? (fiber.eidx = left.eidx + (left.element ? 1 : left.cec)) : (fiber.eidx = startEidx);\r\n  right && (fiber.next = right);\r\n  isLast && (fiber.next = null);\r\n  notifyParents(fiber);\r\n}\r\n\r\nfunction getKey(inst: Instance, idx: number) {\r\n  const key = getElementKey(inst);\r\n  return key !== null ? key : createIndexKey(idx);\r\n}\r\n\r\nfunction notifyParents(fiber: Fiber, alt: Fiber = fiber) {\r\n  fiber.increment(alt.element ? 1 : alt.cec);\r\n  alt.mask & INSERTION_EFFECT_HOST_MASK && fiber.markHost(INSERTION_EFFECT_HOST_MASK);\r\n  alt.mask & LAYOUT_EFFECT_HOST_MASK && fiber.markHost(LAYOUT_EFFECT_HOST_MASK);\r\n  alt.mask & ASYNC_EFFECT_HOST_MASK && fiber.markHost(ASYNC_EFFECT_HOST_MASK);\r\n  alt.mask & ATOM_HOST_MASK && fiber.markHost(ATOM_HOST_MASK);\r\n  alt.mask & PORTAL_HOST_MASK && fiber.markHost(PORTAL_HOST_MASK);\r\n}\r\n\r\nexport {\r\n  walk,\r\n  collectElements,\r\n  getFiberWithElement,\r\n  detectIsFiberAlive,\r\n  createHookLocation,\r\n  tryOptStaticSlot,\r\n  tryOptMemoSlot,\r\n  notifyParents,\r\n};\r\n","import { component, detectIsComponent } from '../component';\r\nimport type { KeyProps, SlotProps } from '../shared';\r\n\r\ntype FragmentProps = Required<SlotProps> & KeyProps;\r\n\r\nconst $$fragment = Symbol('fragment');\r\n\r\nconst Fragment = component<FragmentProps>(({ slot }) => slot || null, { token: $$fragment });\r\n\r\nconst detectIsFragment = (instance: unknown) => detectIsComponent(instance) && instance.token === $$fragment;\r\n\r\nexport { Fragment, detectIsFragment };\r\n","import {\r\n  type ComponentFactory,\r\n  type StandardComponentProps,\r\n  type ShouldUpdate,\r\n  type ComponentInject,\r\n  $$inject,\r\n} from '../component';\r\nimport type { SlotProps, RefProps } from '../shared';\r\nimport { $$memo } from './utils';\r\n\r\nconst defaultShouldUpdate = (props: {}, nextProps: {}): boolean => {\r\n  const keys = Object.keys(nextProps);\r\n\r\n  for (const key of keys) {\r\n    if (key !== 'slot' && nextProps[key] !== props[key]) return true;\r\n  }\r\n\r\n  return false;\r\n};\r\n\r\nfunction memo<P extends object, R = unknown>(\r\n  factory: ComponentFactory<P, R>,\r\n  shouldUpdate: ShouldUpdate<P & SlotProps> = defaultShouldUpdate,\r\n) {\r\n  type P1 = P & Omit<StandardComponentProps, 'ref'> & RefProps<R>;\r\n\r\n  factory[$$inject] = {\r\n    token: $$memo,\r\n    shouldUpdate,\r\n  } as ComponentInject<P1>;\r\n\r\n  return factory as ComponentFactory<P1, R>;\r\n}\r\n\r\nexport { memo };\r\n","import { type VirtualNodeFactory, detectIsVirtualNodeFactory } from '../view';\r\nimport { type Component, detectIsComponent, component } from '../component';\r\nimport { type Hook, type HookValue } from '../fiber';\r\nimport { detectAreDepsDifferent } from '../utils';\r\nimport { $$scope } from '../scope';\r\nimport { memo } from '../memo';\r\n\r\ntype GetMemoValue = () => Component | VirtualNodeFactory;\r\n\r\ntype MemoProps = {\r\n  deps: Array<any>;\r\n  getValue: GetMemoValue;\r\n};\r\n\r\nconst Memo = memo(\r\n  component<MemoProps>(({ getValue }) => getValue()),\r\n  (p, n) => detectAreDepsDifferent(p.deps, n.deps),\r\n);\r\n\r\nfunction detectIsElement<T>(value: T) {\r\n  return detectIsComponent(value) || detectIsVirtualNodeFactory(value);\r\n}\r\n\r\nfunction useMemo<T>(getValue: () => T, deps: Array<any>): T {\r\n  const fiber = $$scope().getCursorFiber();\r\n  const { hook } = fiber;\r\n  const { idx, values } = hook as Hook<HookValue<T>>;\r\n  const state =\r\n    values[idx] ||\r\n    (values[idx] = {\r\n      deps,\r\n      value: getValue(),\r\n    });\r\n  let value: T = null;\r\n  let $value: T = null;\r\n\r\n  if (detectIsElement(state.value)) {\r\n    value = state.value;\r\n    $value = Memo({ getValue: getValue as GetMemoValue, deps }) as unknown as T;\r\n  } else {\r\n    value = detectAreDepsDifferent(state.deps, deps) ? getValue() : state.value;\r\n    $value = value;\r\n  }\r\n\r\n  state.deps = deps;\r\n  state.value = value;\r\n  hook.idx++;\r\n\r\n  return $value;\r\n}\r\n\r\nexport { useMemo };\r\n","export type DropEffect = void | (() => void);\r\n\r\nexport type Effect = () => DropEffect;\r\n\r\nexport enum EffectType {\r\n  ASYNC = 'ASYNC',\r\n  LAYOUT = 'LAYOUT',\r\n  INSERTION = 'INSERTION',\r\n}\r\n","import { detectIsFunction } from '../utils';\r\nimport { INSERTION_EFFECT_HOST_MASK, LAYOUT_EFFECT_HOST_MASK, ASYNC_EFFECT_HOST_MASK } from '../constants';\r\nimport { $$scope } from '../scope';\r\nimport { useMemo } from '../use-memo';\r\nimport { type Hook, type HookValue } from '../fiber';\r\nimport { type Effect, type DropEffect, EffectType } from './types';\r\n\r\nconst $$useEffect = Symbol('use-effect');\r\nconst { useEffect, dropEffects } = createEffect($$useEffect, EffectType.ASYNC);\r\n\r\ntype UseEffectValue = {\r\n  token: Symbol;\r\n  cleanup: DropEffect;\r\n};\r\n\r\nfunction createEffect(token: Symbol, type: EffectType) {\r\n  function useEffect(effect: Effect, deps: Array<any> = [{}]) {\r\n    const $scope = $$scope();\r\n    const fiber = $scope.getCursorFiber();\r\n    const scope = useMemo<UseEffectValue>(() => ({ token, cleanup: undefined }), []);\r\n    const isInsertionEffect = type === EffectType.INSERTION;\r\n    const isLayoutEffect = type === EffectType.LAYOUT;\r\n    const isAsyncEffect = type === EffectType.ASYNC;\r\n\r\n    isInsertionEffect && fiber.markHost(INSERTION_EFFECT_HOST_MASK);\r\n    isLayoutEffect && fiber.markHost(LAYOUT_EFFECT_HOST_MASK);\r\n    isAsyncEffect && fiber.markHost(ASYNC_EFFECT_HOST_MASK);\r\n\r\n    useMemo(() => {\r\n      const runEffect = () => (scope.cleanup = effect());\r\n\r\n      isInsertionEffect && $scope.addInsertionEffect(runEffect);\r\n      isLayoutEffect && $scope.addLayoutEffect(runEffect);\r\n      isAsyncEffect && $scope.addAsyncEffect(runEffect);\r\n\r\n      detectIsFunction(scope.cleanup) && scope.cleanup();\r\n\r\n      return null;\r\n    }, deps);\r\n  }\r\n\r\n  function dropEffects(hook: Hook<HookValue<UseEffectValue>>) {\r\n    for (const { value: effect } of hook.values) {\r\n      effect && effect.token === token && detectIsFunction(effect.cleanup) && effect.cleanup();\r\n    }\r\n  }\r\n\r\n  return {\r\n    useEffect,\r\n    dropEffects,\r\n  };\r\n}\r\n\r\nexport { useEffect, dropEffects, createEffect };\r\n","import { createEffect, EffectType } from '../use-effect';\r\n\r\nconst $$useLayoutEffect = Symbol('use-layout-effect');\r\nconst { useEffect: useLayoutEffect, dropEffects: dropLayoutEffects } = createEffect(\r\n  $$useLayoutEffect,\r\n  EffectType.LAYOUT,\r\n);\r\n\r\nexport { useLayoutEffect, dropLayoutEffects };\r\n","import { createEffect, EffectType } from '../use-effect';\r\n\r\nconst $$useInsertionEffect = Symbol('use-insertion-effect');\r\nconst { useEffect: useInsertionEffect, dropEffects: dropInsertionEffects } = createEffect(\r\n  $$useInsertionEffect,\r\n  EffectType.INSERTION,\r\n);\r\n\r\nexport { useInsertionEffect, dropInsertionEffects };\r\n","import { type Fiber } from '../fiber';\r\nimport { platform } from '../platform';\r\nimport { dropEffects } from '../use-effect';\r\nimport { dropLayoutEffects } from '../use-layout-effect';\r\nimport { dropInsertionEffects } from '../use-insertion-effect';\r\nimport { walk } from '../walk';\r\nimport { detectIsUndefined } from '../utils';\r\nimport { removeScope, $$scope } from '../scope';\r\nimport {\r\n  INSERTION_EFFECT_HOST_MASK,\r\n  LAYOUT_EFFECT_HOST_MASK,\r\n  ASYNC_EFFECT_HOST_MASK,\r\n  ATOM_HOST_MASK,\r\n  PORTAL_HOST_MASK,\r\n} from '../constants';\r\n\r\nconst combinedMask =\r\n  INSERTION_EFFECT_HOST_MASK | LAYOUT_EFFECT_HOST_MASK | ASYNC_EFFECT_HOST_MASK | ATOM_HOST_MASK | PORTAL_HOST_MASK;\r\n\r\nconst shouldUnmountFiber = (fiber: Fiber) => fiber.mask & combinedMask;\r\n\r\nfunction unmountFiber(fiber: Fiber) {\r\n  if (!shouldUnmountFiber(fiber)) return;\r\n  walk(fiber, (fiber, skip) => {\r\n    if (!shouldUnmountFiber(fiber)) return skip();\r\n\r\n    if (fiber.hook && fiber.hook.values.length > 0) {\r\n      fiber.mask & INSERTION_EFFECT_HOST_MASK && dropInsertionEffects(fiber.hook);\r\n      fiber.mask & LAYOUT_EFFECT_HOST_MASK && dropLayoutEffects(fiber.hook);\r\n      fiber.mask & ASYNC_EFFECT_HOST_MASK && dropEffects(fiber.hook);\r\n    }\r\n\r\n    if (fiber.atoms) {\r\n      for (const [_, cleanup] of fiber.atoms) {\r\n        cleanup();\r\n      }\r\n      fiber.atoms = null;\r\n    }\r\n\r\n    fiber.mask & PORTAL_HOST_MASK && platform.unmountPortal(fiber);\r\n  });\r\n}\r\n\r\nfunction unmountRoot(rootId: number, onCompleted: () => void) {\r\n  if (detectIsUndefined(rootId)) return;\r\n  const $scope = $$scope(rootId);\r\n\r\n  unmountFiber($scope.getRoot());\r\n  $scope.unsubscribeEvents();\r\n  removeScope(rootId);\r\n  onCompleted();\r\n}\r\n\r\nexport { unmountFiber, unmountRoot };\r\n","import { platform } from '../platform';\r\nimport {\r\n  CREATE_EFFECT_TAG,\r\n  UPDATE_EFFECT_TAG,\r\n  DELETE_EFFECT_TAG,\r\n  SKIP_EFFECT_TAG,\r\n  INSERTION_EFFECT_HOST_MASK,\r\n  LAYOUT_EFFECT_HOST_MASK,\r\n  ASYNC_EFFECT_HOST_MASK,\r\n  ATOM_HOST_MASK,\r\n  PORTAL_HOST_MASK,\r\n  MOVE_MASK,\r\n  FLUSH_MASK,\r\n  SHADOW_MASK,\r\n  Flag,\r\n} from '../constants';\r\nimport {\r\n  flatten,\r\n  error,\r\n  detectIsEmpty,\r\n  detectIsFalsy,\r\n  detectIsArray,\r\n  detectIsFunction,\r\n  detectIsTextBased,\r\n  createIndexKey,\r\n  trueFn,\r\n} from '../utils';\r\nimport { type Scope, setRootId, $$scope, replaceScope } from '../scope';\r\nimport { type Component, detectIsComponent } from '../component';\r\nimport { type ElementKey, type Instance } from '../shared';\r\nimport { Fiber, getHook, Hook } from '../fiber';\r\nimport {\r\n  Text,\r\n  detectIsVirtualNode,\r\n  detectIsVirtualNodeFactory,\r\n  getElementKey,\r\n  hasElementFlag,\r\n  hasChildrenProp,\r\n  detectIsReplacer,\r\n  createReplacer,\r\n  detectAreSameInstanceTypes,\r\n} from '../view';\r\nimport { detectIsMemo } from '../memo/utils';\r\nimport {\r\n  walk,\r\n  getFiberWithElement,\r\n  detectIsFiberAlive,\r\n  notifyParents,\r\n  tryOptStaticSlot,\r\n  tryOptMemoSlot,\r\n} from '../walk';\r\nimport { type RestoreOptions, scheduler } from '../scheduler';\r\nimport { Fragment, detectIsFragment } from '../fragment';\r\nimport { unmountFiber } from '../unmount';\r\n\r\nlet hasPendingPromise = false;\r\nlet hasRenderError = false;\r\n\r\nexport type WorkLoop = (isAsync: boolean) => boolean;\r\n\r\nfunction workLoop(isAsync: boolean): boolean | null {\r\n  if (hasPendingPromise) return null;\r\n  if (hasRenderError) return false;\r\n  const $scope = $$scope();\r\n  const wipFiber = $scope.getWorkInProgress();\r\n  let unit = $scope.getNextUnitOfWork();\r\n  let shouldYield = false;\r\n  let hasMoreWork = Boolean(unit);\r\n\r\n  try {\r\n    while (unit && !shouldYield) {\r\n      unit = performUnitOfWork(unit, $scope);\r\n      $scope.setNextUnitOfWork(unit);\r\n      hasMoreWork = Boolean(unit);\r\n      shouldYield = isAsync && scheduler.shouldYield();\r\n      if (shouldYield && scheduler.hasPrimaryTask()) return fork($scope);\r\n    }\r\n\r\n    if (!unit && wipFiber) {\r\n      commit($scope);\r\n    }\r\n  } catch (err) {\r\n    if (err instanceof Promise) {\r\n      hasPendingPromise = true;\r\n      err.finally(() => {\r\n        hasPendingPromise = false;\r\n        !isAsync && workLoop(false);\r\n      });\r\n    } else {\r\n      hasRenderError = true;\r\n      throw err;\r\n    }\r\n  }\r\n\r\n  return hasMoreWork;\r\n}\r\n\r\nfunction performUnitOfWork(fiber: Fiber, $scope: Scope): Fiber | null {\r\n  const wipFiber = $scope.getWorkInProgress();\r\n  const isDeepWalking = $scope.getMountDeep();\r\n  const isStream = $scope.getIsStreamZone();\r\n  const hasChildren = isDeepWalking && hasChildrenProp(fiber.inst) && fiber.inst.children.length > 0;\r\n\r\n  fiber.hook && (fiber.hook.idx = 0);\r\n\r\n  if (hasChildren) {\r\n    const child = mountChild(fiber, $scope);\r\n\r\n    isStream && platform.chunk(child);\r\n\r\n    return child;\r\n  } else {\r\n    while (fiber.parent && fiber !== wipFiber) {\r\n      const next = mountSibling(fiber, $scope);\r\n\r\n      isStream && platform.chunk(fiber);\r\n\r\n      if (next) {\r\n        isStream && platform.chunk(next);\r\n        return next;\r\n      }\r\n\r\n      fiber = fiber.parent;\r\n    }\r\n  }\r\n\r\n  return null;\r\n}\r\n\r\nfunction mountChild(parent: Fiber, $scope: Scope) {\r\n  $scope.navToChild();\r\n  const $inst = parent.inst;\r\n  const idx = 0;\r\n  const inst = hasChildrenProp($inst) ? $inst.children[idx] : null;\r\n  const alt = getAlternate(parent, inst, true, $scope);\r\n  const fiber = createFiber(alt, inst, idx);\r\n\r\n  fiber.parent = parent;\r\n  parent.child = fiber;\r\n  fiber.eidx = parent.element ? 0 : parent.eidx;\r\n\r\n  share(fiber, parent, inst, $scope);\r\n\r\n  return fiber;\r\n}\r\n\r\nfunction mountSibling(left: Fiber, $scope: Scope) {\r\n  $scope.navToSibling();\r\n  const $inst = left.parent.inst;\r\n  const idx = $scope.getMountIndex();\r\n  const inst = hasChildrenProp($inst) && $inst.children ? $inst.children[idx] : null;\r\n  const hasSibling = Boolean(inst);\r\n\r\n  if (!hasSibling) {\r\n    $scope.navToParent();\r\n    $scope.setMountDeep(false);\r\n\r\n    return null;\r\n  }\r\n\r\n  $scope.setMountDeep(true);\r\n  const alt = getAlternate(left, inst, false, $scope);\r\n  const fiber = createFiber(alt, inst, idx);\r\n\r\n  fiber.parent = left.parent;\r\n  left.next = fiber;\r\n  fiber.eidx = left.eidx + (left.element ? 1 : left.cec);\r\n\r\n  share(fiber, left, inst, $scope);\r\n\r\n  return fiber;\r\n}\r\n\r\nfunction share(fiber: Fiber, prev: Fiber, inst: Instance, $scope: Scope) {\r\n  const { alt } = fiber;\r\n  const shouldMount = alt && detectIsMemo(inst) ? shouldUpdate(fiber, inst, $scope) : true;\r\n\r\n  $scope.setCursorFiber(fiber);\r\n  fiber.inst = inst;\r\n\r\n  if (alt && alt.mask & MOVE_MASK) {\r\n    fiber.mask |= MOVE_MASK;\r\n    alt.mask &= ~MOVE_MASK;\r\n  }\r\n\r\n  fiber.hook && (fiber.hook.owner = fiber); // !\r\n\r\n  if (shouldMount) {\r\n    fiber.inst = mount(fiber, prev, $scope);\r\n    alt && reconcile(fiber, alt, $scope);\r\n    setup(fiber, alt);\r\n  } else if (fiber.mask & MOVE_MASK) {\r\n    fiber.tag = UPDATE_EFFECT_TAG;\r\n  }\r\n\r\n  $scope.addCandidate(fiber); // !\r\n}\r\n\r\nfunction createFiber(alt: Fiber, inst: Instance, idx: number) {\r\n  const fiber = new Fiber(getHook(alt, alt ? alt.inst : null, inst), alt ? alt.provider : null, idx);\r\n\r\n  fiber.alt = alt || null;\r\n\r\n  return fiber;\r\n}\r\n\r\nfunction getAlternate(fiber: Fiber, inst: Instance, fromChild: boolean, $scope: Scope) {\r\n  const key = getElementKey(inst);\r\n\r\n  if (key !== null) {\r\n    const parentId = fromChild ? fiber.id : fiber.parent.id;\r\n    const actions = $scope.getActionsById(parentId);\r\n\r\n    if (actions) {\r\n      const isMove = actions.move && Boolean(actions.move[key]);\r\n      const isStable = actions.stable && Boolean(actions.stable[key]);\r\n\r\n      if (isMove || isStable) {\r\n        const alt = actions.map[key];\r\n\r\n        isMove && (alt.mask |= MOVE_MASK);\r\n\r\n        return alt;\r\n      }\r\n\r\n      return null;\r\n    }\r\n  }\r\n\r\n  const alt = fiber.alt ? (fromChild ? fiber.alt.child || null : fiber.alt.next || null) : null;\r\n\r\n  return alt;\r\n}\r\n\r\nfunction reconcile(fiber: Fiber, alt: Fiber, $scope: Scope) {\r\n  const { id, inst } = fiber;\r\n  const areSameTypes = detectAreSameInstanceTypes(alt.inst, inst);\r\n\r\n  if (!areSameTypes) {\r\n    $scope.addDeletion(alt);\r\n  } else if (hasChildrenProp(alt.inst) && hasChildrenProp(inst) && alt.cc !== 0) {\r\n    const hasSameCount = alt.cc === inst.children.length;\r\n    const check = hasElementFlag(inst, Flag.SKIP_SCAN_OPT) ? !hasSameCount : true;\r\n\r\n    if (check) {\r\n      const { prevKeys, nextKeys, prevKeysMap, nextKeysMap, keyedFibersMap } = extractKeys(alt.child, inst.children);\r\n      const flush = nextKeys.length === 0;\r\n      let size = Math.max(prevKeys.length, nextKeys.length);\r\n      let p = 0;\r\n      let n = 0;\r\n\r\n      $scope.addActionMap(id, keyedFibersMap);\r\n\r\n      for (let i = 0; i < size; i++) {\r\n        const nextKey = nextKeys[i - n] ?? null;\r\n        const prevKey = prevKeys[i - p] ?? null;\r\n        const prevKeyFiber = keyedFibersMap[prevKey] || null;\r\n\r\n        if (nextKey !== prevKey) {\r\n          if (nextKey !== null && !prevKeysMap[nextKey]) {\r\n            if (prevKey !== null && !nextKeysMap[prevKey]) {\r\n              $scope.addReplaceAction(id, nextKey);\r\n              $scope.addDeletion(prevKeyFiber);\r\n            } else {\r\n              $scope.addInsertAction(id, nextKey);\r\n              p++;\r\n              size++;\r\n            }\r\n          } else if (!nextKeysMap[prevKey]) {\r\n            $scope.addRemoveAction(id, prevKey);\r\n            $scope.addDeletion(prevKeyFiber);\r\n            flush && (prevKeyFiber.mask |= FLUSH_MASK);\r\n            n++;\r\n            size++;\r\n          } else if (nextKeysMap[prevKey] && nextKeysMap[nextKey]) {\r\n            $scope.addMoveAction(id, nextKey);\r\n          }\r\n        } else if (nextKey !== null) {\r\n          $scope.addStableAction(id, nextKey);\r\n        }\r\n      }\r\n\r\n      hasElementFlag(inst, Flag.STATIC_SLOT_OPT) && tryOptStaticSlot(fiber, alt, $scope);\r\n      hasElementFlag(inst, Flag.MEMO_SLOT_OPT) && tryOptMemoSlot(fiber, alt, $scope);\r\n    }\r\n  }\r\n}\r\n\r\nfunction setup(fiber: Fiber, alt: Fiber) {\r\n  const inst = fiber.inst;\r\n  let isUpdate = false;\r\n\r\n  fiber.parent.tag === CREATE_EFFECT_TAG && (fiber.tag = fiber.parent.tag);\r\n  fiber.parent.mask & SHADOW_MASK && !fiber.parent.element && !detectIsReplacer(inst) && (fiber.mask |= SHADOW_MASK);\r\n  isUpdate =\r\n    alt &&\r\n    fiber.tag !== CREATE_EFFECT_TAG &&\r\n    detectAreSameInstanceTypes(alt.inst, inst) &&\r\n    getElementKey(alt.inst) === getElementKey(inst);\r\n  isUpdate && !fiber.element && alt.element && (fiber.element = alt.element);\r\n  fiber.tag = isUpdate ? UPDATE_EFFECT_TAG : CREATE_EFFECT_TAG;\r\n  hasChildrenProp(fiber.inst) && (fiber.cc = fiber.inst.children.length);\r\n  !fiber.element && detectIsVirtualNode(fiber.inst) && (fiber.element = platform.createElement(fiber.inst));\r\n  fiber.element && fiber.increment();\r\n}\r\n\r\nfunction shouldUpdate(fiber: Fiber, inst: Instance, $scope: Scope) {\r\n  if (process.env.NODE_ENV !== 'production') {\r\n    if ($scope.getIsHot()) return true;\r\n  }\r\n\r\n  const alt = fiber.alt;\r\n  const pc = alt.inst as Component;\r\n  const nc = inst as Component;\r\n\r\n  if (nc.type !== pc.type || nc.shouldUpdate(pc.props, nc.props)) return true;\r\n\r\n  $scope.setMountDeep(false);\r\n  fiber.tag = SKIP_EFFECT_TAG;\r\n  fiber.child = alt.child;\r\n  fiber.child.parent = fiber;\r\n  fiber.hook = alt.hook;\r\n  fiber.cc = alt.cc;\r\n  fiber.cec = alt.cec;\r\n  alt.element && (fiber.element = alt.element);\r\n  alt.provider && (fiber.provider = alt.provider);\r\n  alt.catch && (fiber.catch = alt.catch);\r\n  alt.atoms && (fiber.atoms = alt.atoms);\r\n\r\n  const diff = fiber.eidx - alt.eidx;\r\n  const deep = diff !== 0;\r\n\r\n  if (deep) {\r\n    walk(fiber.child, ($fiber, skip) => {\r\n      $fiber.eidx += diff;\r\n      if ($fiber.element) return skip();\r\n    });\r\n  }\r\n\r\n  notifyParents(fiber, alt);\r\n\r\n  return false;\r\n}\r\n\r\nfunction mount(fiber: Fiber, prev: Fiber, $scope: Scope) {\r\n  let inst = fiber.inst;\r\n  const isComponent = detectIsComponent(inst);\r\n  const component = inst as Component;\r\n\r\n  if (isComponent) {\r\n    try {\r\n      const id = $scope.getResourceId();\r\n      let result = component.type(component.props, component.ref);\r\n      const defers = $scope.getDefers();\r\n\r\n      if (defers.length > 0) {\r\n        const promise = Promise.all(defers.map(x => x()));\r\n\r\n        $scope.setResourceId(id);\r\n        $scope.resetDefers();\r\n        $scope.navToPrev();\r\n        $scope.setNextUnitOfWork(prev);\r\n        Fiber.setNextId(prev.id);\r\n\r\n        throw promise;\r\n      }\r\n\r\n      if (detectIsArray(result)) {\r\n        !detectIsFragment(component) && (result = Fragment({ slot: result }));\r\n      } else if (detectIsTextBased(result)) {\r\n        result = Text(result);\r\n      }\r\n\r\n      component.children = result as Array<Instance>;\r\n      platform.detectIsPortal(inst) && fiber.markHost(PORTAL_HOST_MASK);\r\n    } catch (err) {\r\n      if (err instanceof Promise) throw err;\r\n      component.children = [];\r\n      fiber.setError(err);\r\n      error(err);\r\n    }\r\n  } else if (detectIsVirtualNodeFactory(inst)) {\r\n    inst = inst();\r\n  }\r\n\r\n  if (hasChildrenProp(inst)) {\r\n    inst.children = flatten(inst.children, x => (detectIsTextBased(x) ? Text(x) : x || supportConditional(x)));\r\n    isComponent && component.children.length === 0 && component.children.push(createReplacer());\r\n  }\r\n\r\n  return inst;\r\n}\r\n\r\nfunction extractKeys(alt: Fiber, children: Array<Instance>) {\r\n  let nextFiber = alt;\r\n  let idx = 0;\r\n  const prevKeys: Array<ElementKey> = [];\r\n  const nextKeys: Array<ElementKey> = [];\r\n  const prevKeysMap: Record<ElementKey, boolean> = {};\r\n  const nextKeysMap: Record<ElementKey, boolean> = {};\r\n  const keyedFibersMap: Record<ElementKey, Fiber> = {};\r\n  const usedKeysMap: Record<ElementKey, boolean> = {};\r\n\r\n  while (nextFiber || idx < children.length) {\r\n    if (nextFiber) {\r\n      const key = getElementKey(nextFiber.inst);\r\n      const prevKey = detectIsEmpty(key) ? createIndexKey(idx) : key;\r\n\r\n      if (!prevKeysMap[prevKey]) {\r\n        prevKeysMap[prevKey] = true; // !\r\n        prevKeys.push(prevKey);\r\n      }\r\n\r\n      keyedFibersMap[prevKey] = nextFiber;\r\n    }\r\n\r\n    if (children[idx]) {\r\n      const inst = children[idx];\r\n      const key = getElementKey(inst);\r\n      const nextKey = detectIsEmpty(key) ? createIndexKey(idx) : key;\r\n\r\n      if (process.env.NODE_ENV !== 'production') {\r\n        if (usedKeysMap[nextKey]) {\r\n          error(`[Dark]: The key of node [${nextKey}] already has been used!`, [inst]);\r\n        }\r\n      }\r\n\r\n      if (!nextKeysMap[nextKey]) {\r\n        nextKeysMap[nextKey] = true; // !\r\n        nextKeys.push(nextKey);\r\n      }\r\n\r\n      usedKeysMap[nextKey] = true;\r\n    }\r\n\r\n    nextFiber = nextFiber ? nextFiber.next : null;\r\n    idx++;\r\n  }\r\n\r\n  return {\r\n    prevKeys,\r\n    nextKeys,\r\n    prevKeysMap,\r\n    nextKeysMap,\r\n    keyedFibersMap,\r\n  };\r\n}\r\n\r\nfunction supportConditional(inst: Instance) {\r\n  return detectIsFalsy(inst) ? createReplacer() : inst;\r\n}\r\n\r\nfunction commit($scope: Scope) {\r\n  if (process.env.NODE_ENV !== 'production') {\r\n    process.env.NODE_ENV === 'development' && $scope.setIsHot(false);\r\n  }\r\n\r\n  const wipFiber = $scope.getWorkInProgress();\r\n  const deletions = $scope.getDeletions();\r\n  const candidates = $scope.getCandidates();\r\n  const isUpdateZone = $scope.getIsUpdateZone();\r\n  const unmounts: Array<Fiber> = [];\r\n  const combinedMask = INSERTION_EFFECT_HOST_MASK | LAYOUT_EFFECT_HOST_MASK | ASYNC_EFFECT_HOST_MASK | PORTAL_HOST_MASK;\r\n\r\n  // !\r\n  for (const fiber of deletions) {\r\n    const withNextTick = fiber.mask & ATOM_HOST_MASK && !(fiber.mask & combinedMask);\r\n\r\n    withNextTick ? unmounts.push(fiber) : unmountFiber(fiber);\r\n    fiber.tag = DELETE_EFFECT_TAG;\r\n    platform.commit(fiber);\r\n  }\r\n\r\n  isUpdateZone && sync(wipFiber);\r\n  $scope.runInsertionEffects();\r\n\r\n  for (const fiber of candidates) {\r\n    fiber.tag !== SKIP_EFFECT_TAG && platform.commit(fiber);\r\n    fiber.alt = null;\r\n    hasChildrenProp(fiber.inst) && (fiber.inst.children = null);\r\n  }\r\n\r\n  wipFiber.alt = null;\r\n  platform.finishCommit(); // !\r\n  $scope.runLayoutEffects();\r\n  $scope.runAsyncEffects();\r\n  unmounts.length > 0 && setTimeout(() => unmounts.forEach(x => unmountFiber(x)));\r\n  flush($scope);\r\n}\r\n\r\nfunction flush($scope: Scope, cancel = false) {\r\n  $scope.flush();\r\n  !cancel && $scope.getEmitter().emit('finish');\r\n  $scope.runAfterCommit(); // !\r\n}\r\n\r\nfunction sync(fiber: Fiber) {\r\n  const diff = fiber.cec - fiber.alt.cec;\r\n  if (diff === 0) return;\r\n  const parentFiber = getFiberWithElement(fiber.parent);\r\n  let isRight = false;\r\n\r\n  fiber.increment(diff, true);\r\n\r\n  walk(parentFiber.child, ($fiber, skip) => {\r\n    if ($fiber === fiber) {\r\n      isRight = true;\r\n      return skip();\r\n    }\r\n\r\n    $fiber.element && skip();\r\n    isRight && ($fiber.eidx += diff);\r\n  });\r\n}\r\n\r\nfunction fork($scope: Scope): false {\r\n  const $$scope$ = $scope.copy();\r\n  const wipFiber = $scope.getWorkInProgress();\r\n  const child = wipFiber.child;\r\n  child && (child.parent = null);\r\n  const restore = (options: RestoreOptions) => {\r\n    const { fiber: wipFiber, setValue, resetValue } = options;\r\n    const $scope = $$scope();\r\n\r\n    detectIsFunction(setValue) && setValue();\r\n    detectIsFunction(resetValue) && $$scope$.addCancel(resetValue);\r\n\r\n    wipFiber.alt = new Fiber().mutate(wipFiber);\r\n    wipFiber.tag = UPDATE_EFFECT_TAG;\r\n    wipFiber.child = child;\r\n    child && (child.parent = wipFiber);\r\n\r\n    if (process.env.NODE_ENV !== 'production') {\r\n      wipFiber.marker = '✌️';\r\n    }\r\n\r\n    $$scope$.setRoot($scope.getRoot());\r\n    $$scope$.setWorkInProgress(wipFiber);\r\n    replaceScope($$scope$);\r\n  };\r\n\r\n  wipFiber.child = wipFiber.alt.child;\r\n  wipFiber.alt = null;\r\n  $scope.applyCancels();\r\n  flush($scope, true);\r\n  scheduler.cancelTask(restore);\r\n\r\n  return false;\r\n}\r\n\r\nexport type CreateUpdateOptions = {\r\n  rootId: number;\r\n  isTransition?: boolean;\r\n  hook: Hook;\r\n  createChanger?: () => UpdateChanger;\r\n};\r\n\r\nexport type UpdateChanger = {\r\n  shouldUpdate: () => boolean;\r\n} & Pick<RestoreOptions, 'setValue' | 'resetValue'>;\r\n\r\nfunction createUpdate(options: CreateUpdateOptions) {\r\n  const { rootId, hook, isTransition, createChanger = $createChanger } = options;\r\n  const callback = (restore?: (options: RestoreOptions) => void) => {\r\n    setRootId(rootId); // !\r\n    const fromRestore = detectIsFunction(restore);\r\n    const { shouldUpdate, setValue, resetValue } = createChanger();\r\n    const $scope = $$scope();\r\n    const owner = hook.owner;\r\n    const fiber = owner.alt || owner;\r\n\r\n    if (!shouldUpdate() || !detectIsFiberAlive(fiber) || fromRestore) {\r\n      fromRestore && restore({ fiber, setValue, resetValue });\r\n      return;\r\n    }\r\n\r\n    detectIsFunction(setValue) && setValue();\r\n    detectIsFunction(resetValue) && isTransition && $scope.addCancel(resetValue);\r\n\r\n    fiber.alt = new Fiber().mutate(fiber);\r\n    fiber.tag = UPDATE_EFFECT_TAG;\r\n    fiber.cc = 0;\r\n    fiber.cec = 0;\r\n    fiber.child = null;\r\n\r\n    if (process.env.NODE_ENV !== 'production') {\r\n      fiber.marker = '🔥';\r\n    }\r\n\r\n    $scope.setIsUpdateZone(true);\r\n    $scope.resetMount();\r\n    $scope.setWorkInProgress(fiber);\r\n    $scope.setCursorFiber(fiber);\r\n    fiber.inst = mount(fiber, null, $scope);\r\n    $scope.setNextUnitOfWork(fiber);\r\n  };\r\n\r\n  return callback;\r\n}\r\n\r\nconst $createChanger = (): UpdateChanger => ({\r\n  shouldUpdate: trueFn,\r\n  setValue: null,\r\n  resetValue: null,\r\n});\r\n\r\nconst detectIsBusy = () => Boolean($$scope()?.getWorkInProgress());\r\n\r\nexport { Fiber, workLoop, createUpdate, detectIsBusy };\r\n","import { type WorkLoop, workLoop, detectIsBusy } from '../workloop';\r\nimport { type SetPendingStatus } from '../start-transition';\r\nimport { type Callback } from '../shared';\r\nimport { type Fiber } from '../fiber';\r\nimport { ROOT, HOOK_DELIMETER, YIELD_INTERVAL, TaskPriority } from '../constants';\r\nimport { getTime, detectIsFunction, nextTick } from '../utils';\r\nimport { EventEmitter } from '../emitter';\r\nimport { platform } from '../platform';\r\n\r\nclass MessageChannel extends EventEmitter<PortEvent> {\r\n  port1: MessagePort = null;\r\n  port2: MessagePort = null;\r\n\r\n  constructor() {\r\n    super();\r\n    this.port1 = new MessagePort(this);\r\n    this.port2 = new MessagePort(this);\r\n  }\r\n}\r\n\r\nclass MessagePort {\r\n  channel: MessageChannel;\r\n  offs: Array<Callback> = [];\r\n\r\n  constructor(channel: MessageChannel) {\r\n    this.channel = channel;\r\n  }\r\n\r\n  on(event: PortEvent, callback: PortListener) {\r\n    const off = this.channel.on(event, callback);\r\n\r\n    this.offs.push(off);\r\n  }\r\n\r\n  postMessage(value: unknown) {\r\n    platform.spawn(() => {\r\n      this.channel.emit('message', value);\r\n    });\r\n  }\r\n\r\n  unref() {\r\n    this.offs.forEach(x => x());\r\n  }\r\n}\r\n\r\nclass Scheduler {\r\n  private queue: Record<TaskPriority, Array<Task>> = {\r\n    [TaskPriority.HIGH]: [],\r\n    [TaskPriority.NORMAL]: [],\r\n    [TaskPriority.LOW]: [],\r\n  };\r\n  private deadline = 0;\r\n  private task: Task = null;\r\n  private scheduledCallback: WorkLoop = null;\r\n  private isMessageLoopRunning = false;\r\n  private channel: MessageChannel = null;\r\n  private port: MessagePort = null;\r\n\r\n  constructor() {\r\n    this.channel = new MessageChannel();\r\n    this.port = this.channel.port2;\r\n    this.channel.port1.on('message', this.performWorkUntilDeadline.bind(this));\r\n  }\r\n\r\n  reset() {\r\n    this.deadline = 0;\r\n    this.task = null;\r\n    this.scheduledCallback = null;\r\n    this.isMessageLoopRunning = false;\r\n  }\r\n\r\n  shouldYield() {\r\n    return getTime() >= this.deadline;\r\n  }\r\n\r\n  schedule(callback: Callback, options?: ScheduleCallbackOptions) {\r\n    const {\r\n      priority = TaskPriority.NORMAL,\r\n      forceAsync = false,\r\n      isTransition = false,\r\n      createLocation,\r\n      setPendingStatus,\r\n    } = options || {};\r\n    const task = new Task(callback, priority, forceAsync);\r\n\r\n    task.setIsTransition(isTransition);\r\n    task.setPendingSetter(setPendingStatus);\r\n    task.setLocationCreator(createLocation || createRootLocation);\r\n    this.put(task);\r\n    this.execute();\r\n  }\r\n\r\n  hasPrimaryTask() {\r\n    if (!this.task.getIsTransition()) return false;\r\n    const { high, normal, low } = this.getQueues();\r\n    const hasPrimary = high.length > 0 || normal.length > 0;\r\n    const hasLow = low.length > 0;\r\n\r\n    if (hasPrimary || hasLow) {\r\n      const loc = this.task.createLocation();\r\n\r\n      if (hasPrimary) {\r\n        const has = Task.detectHasRelatedUpdate(loc, high, true) || Task.detectHasRelatedUpdate(loc, normal, true);\r\n\r\n        if (has) {\r\n          this.task.markAsUnnecessary();\r\n        }\r\n\r\n        return true;\r\n      }\r\n\r\n      if (hasLow) {\r\n        const has = Task.detectHasRelatedUpdate(loc, low);\r\n\r\n        if (has) {\r\n          this.task.markAsUnnecessary();\r\n\r\n          return true;\r\n        }\r\n      }\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  cancelTask(fn: TaskRestorer) {\r\n    if (this.task.getIsUnnecessary()) return this.complete(this.task);\r\n    this.task.setTaskRestorer(fn);\r\n    this.defer(this.task);\r\n  }\r\n\r\n  private complete(task: Task) {\r\n    task.pending(false);\r\n  }\r\n\r\n  private put(task: Task) {\r\n    const queue = this.queue[task.getPriority()];\r\n\r\n    if (task.getIsTransition()) {\r\n      const loc = task.createLocation();\r\n      const tasks = queue.filter(x => x.createLocation() !== loc);\r\n\r\n      queue.splice(0, queue.length, ...tasks);\r\n    }\r\n\r\n    queue.push(task);\r\n  }\r\n\r\n  private pick(queue: Array<Task>) {\r\n    if (queue.length === 0) return false;\r\n    this.task = queue.shift();\r\n\r\n    if (this.task.getIsTransition() && this.task.canPending()) {\r\n      const task = this.task;\r\n\r\n      task.markAsPending();\r\n      this.defer(this.task);\r\n      this.task = null;\r\n\r\n      nextTick(() => task.pending(true));\r\n\r\n      return true;\r\n    }\r\n\r\n    this.task.run();\r\n    this.task.getForceAsync() ? this.requestCallbackAsync(workLoop) : this.requestCallback(workLoop);\r\n\r\n    return true;\r\n  }\r\n\r\n  private execute() {\r\n    const isBusy = detectIsBusy();\r\n    const { high, normal, low } = this.getQueues();\r\n\r\n    if (!isBusy && !this.isMessageLoopRunning) {\r\n      this.pick(high) || this.pick(normal) || this.pick(low);\r\n    }\r\n  }\r\n\r\n  private requestCallbackAsync(callback: WorkLoop) {\r\n    this.scheduledCallback = callback;\r\n\r\n    if (!this.isMessageLoopRunning) {\r\n      this.isMessageLoopRunning = true;\r\n      this.port.postMessage(null);\r\n    }\r\n  }\r\n\r\n  private requestCallback(callback: WorkLoop) {\r\n    callback(false);\r\n    this.task = null;\r\n    this.execute();\r\n  }\r\n\r\n  private performWorkUntilDeadline() {\r\n    if (this.scheduledCallback) {\r\n      this.deadline = getTime() + YIELD_INTERVAL;\r\n      const hasMoreWork = this.scheduledCallback(true);\r\n\r\n      if (hasMoreWork) {\r\n        this.port.postMessage(null);\r\n      } else {\r\n        if (hasMoreWork === null) {\r\n          setTimeout(() => this.port.postMessage(null)); // has promise\r\n        } else {\r\n          this.complete(this.task);\r\n          this.reset();\r\n          this.execute();\r\n        }\r\n      }\r\n    } else {\r\n      this.isMessageLoopRunning = false;\r\n    }\r\n  }\r\n\r\n  private defer(task: Task) {\r\n    const { low } = this.getQueues();\r\n\r\n    low.unshift(task);\r\n  }\r\n\r\n  private getQueues() {\r\n    const high = this.queue[TaskPriority.HIGH];\r\n    const normal = this.queue[TaskPriority.NORMAL];\r\n    const low = this.queue[TaskPriority.LOW];\r\n\r\n    return {\r\n      high,\r\n      normal,\r\n      low,\r\n    };\r\n  }\r\n}\r\n\r\ntype TaskCallback = (fn: TaskRestorer) => void;\r\ntype TaskRestorer = (options: RestoreOptions) => void;\r\ntype LocationCreator = () => string;\r\n\r\nclass Task {\r\n  private id: number;\r\n  private priority: TaskPriority;\r\n  private forceAsync: boolean;\r\n  private isTransition: boolean;\r\n  private isPending: boolean;\r\n  private isUnnecessary: boolean;\r\n  private callback: TaskCallback;\r\n  private taskRestorer?: TaskRestorer = null;\r\n  private locationCreator?: LocationCreator;\r\n  private pendingSetter?: SetPendingStatus = null;\r\n  private static nextTaskId = 0;\r\n\r\n  constructor(callback: TaskCallback, priority: TaskPriority, forceAsync: boolean) {\r\n    this.id = ++Task.nextTaskId;\r\n    this.callback = callback;\r\n    this.priority = priority;\r\n    this.forceAsync = forceAsync;\r\n  }\r\n\r\n  getPriority() {\r\n    return this.priority;\r\n  }\r\n\r\n  getForceAsync() {\r\n    return this.forceAsync;\r\n  }\r\n\r\n  setIsTransition(value: boolean) {\r\n    this.isTransition = value;\r\n  }\r\n\r\n  getIsTransition() {\r\n    return this.isTransition;\r\n  }\r\n\r\n  run() {\r\n    this.callback(this.taskRestorer);\r\n    this.taskRestorer = null;\r\n  }\r\n\r\n  pending(value: boolean) {\r\n    this.isTransition && this.pendingSetter && this.pendingSetter(value);\r\n  }\r\n\r\n  markAsPending() {\r\n    this.isPending = true;\r\n  }\r\n\r\n  canPending() {\r\n    return !this.isPending && detectIsFunction(this.pendingSetter);\r\n  }\r\n\r\n  markAsUnnecessary() {\r\n    this.isUnnecessary = true;\r\n  }\r\n\r\n  getIsUnnecessary() {\r\n    return this.isUnnecessary;\r\n  }\r\n\r\n  setTaskRestorer(fn: TaskRestorer) {\r\n    this.taskRestorer = fn;\r\n  }\r\n\r\n  setLocationCreator(fn: LocationCreator) {\r\n    this.locationCreator = fn;\r\n  }\r\n\r\n  createLocation() {\r\n    return this.locationCreator();\r\n  }\r\n\r\n  setPendingSetter(fn: SetPendingStatus) {\r\n    this.pendingSetter = fn;\r\n  }\r\n\r\n  static detectHasRelatedUpdate(loc: string, tasks: Array<Task>, deep = false) {\r\n    const [$loc] = loc.split(HOOK_DELIMETER);\r\n\r\n    return tasks.some(x => {\r\n      const $$loc = x.createLocation();\r\n      const has = $$loc === loc || (deep && $$loc.length > loc.length && $$loc.indexOf($loc) !== -1);\r\n\r\n      return has;\r\n    });\r\n  }\r\n}\r\n\r\nconst createRootLocation: LocationCreator = () => ROOT;\r\n\r\ntype PortEvent = 'message';\r\ntype PortListener = (value: unknown) => void;\r\n\r\nexport type RestoreOptions = {\r\n  fiber: Fiber;\r\n  setValue?: () => void;\r\n  resetValue?: () => void;\r\n};\r\n\r\nexport type ScheduleCallbackOptions = {\r\n  priority?: TaskPriority;\r\n  forceAsync?: boolean;\r\n  isTransition?: boolean;\r\n  createLocation?: () => string;\r\n  setPendingStatus?: SetPendingStatus;\r\n  onCompleted?: () => void;\r\n};\r\n\r\nconst scheduler = new Scheduler();\r\n\r\nexport { scheduler };\r\n","import { detectIsObject, detectIsNull, detectIsFunction } from '../utils';\r\nimport type { Component, ComponentFactory } from '../component';\r\nimport type { RefProps, KeyProps, FlagProps } from '../shared';\r\nimport { useMemo } from '../use-memo';\r\n\r\nfunction forwardRef<P extends object, R>(\r\n  component: ComponentFactory<P, R>,\r\n): ComponentFactory<P & RefProps<R> & KeyProps & FlagProps, R> {\r\n  type Props = P & RefProps<R>;\r\n\r\n  return (props: Props) => {\r\n    const { ref, ...rest } = (props || {}) as Props;\r\n\r\n    return component(rest as P, ref) as Component<P, R>;\r\n  };\r\n}\r\n\r\nfunction detectIsMutableRef(ref: unknown): ref is MutableRef {\r\n  if (!detectIsObject(ref) || detectIsNull(ref)) return false;\r\n  const mutableRef = ref as MutableRef;\r\n\r\n  for (const key in mutableRef) {\r\n    if (key === 'current' && mutableRef.hasOwnProperty(key)) {\r\n      return true;\r\n    }\r\n  }\r\n\r\n  return false;\r\n}\r\n\r\nfunction applyRef<T>(ref: Ref<T>, current: T) {\r\n  if (detectIsFunction(ref)) {\r\n    ref(current);\r\n  } else if (detectIsMutableRef(ref)) {\r\n    ref.current = current;\r\n  }\r\n}\r\n\r\nfunction useRef<T>(initialValue: T = null): MutableRef<T> {\r\n  const ref = useMemo(() => ({ current: initialValue }), []) as MutableRef<T>;\r\n\r\n  return ref;\r\n}\r\n\r\nexport type MutableRef<T = unknown> = {\r\n  current: T;\r\n};\r\n\r\nexport type FunctionRef<T = unknown> = (ref: T) => void;\r\n\r\nexport type Ref<T = unknown> = MutableRef<T> | FunctionRef<T>;\r\n\r\nexport { forwardRef, detectIsMutableRef, applyRef, useRef };\r\n","import { type Fiber, detectIsComponent } from '@dark-engine/core';\r\n\r\nimport type { TagNativeElement } from '../native-element';\r\n\r\nconst $$portal = Symbol('portal');\r\n\r\nconst detectIsPortal = (instance: unknown) => detectIsComponent(instance) && instance.token === $$portal;\r\n\r\nconst getPortalContainer = (fiber: Fiber<TagNativeElement>): TagNativeElement | null =>\r\n  detectIsPortal(fiber.inst) ? fiber.element : null;\r\n\r\nfunction unmountPortal(fiber: Fiber<TagNativeElement>) {\r\n  const element = getPortalContainer(fiber);\r\n\r\n  element && (element.textContent = '');\r\n}\r\n\r\nexport { $$portal, detectIsPortal, unmountPortal };\r\n","import { detectIsFunction, $$scope, detectIsArray } from '@dark-engine/core';\r\n\r\nimport type { TagNativeElement } from '../native-element';\r\n\r\ntype BrowserEventConstructor = (type: string, event: Event) => void;\r\n\r\nclass SyntheticEvent<E extends Event, T = TagNativeElement> {\r\n  public type = '';\r\n  public sourceEvent: E = null;\r\n  public target: T = null;\r\n  private propagation = true;\r\n\r\n  constructor(options: Pick<SyntheticEvent<E, T>, 'sourceEvent' | 'target'>) {\r\n    this.type = options.sourceEvent.type;\r\n    this.sourceEvent = options.sourceEvent;\r\n    this.target = options.target;\r\n  }\r\n\r\n  public stopPropagation() {\r\n    this.propagation = false;\r\n    this.sourceEvent.stopPropagation();\r\n  }\r\n\r\n  public preventDefault() {\r\n    this.sourceEvent.preventDefault();\r\n  }\r\n\r\n  public getPropagation() {\r\n    return this.propagation;\r\n  }\r\n}\r\n\r\nfunction delegateEvent(\r\n  target: Element,\r\n  eventName: string,\r\n  handler: (e: Event) => void | [fn: () => void, ...args: Array<any>],\r\n) {\r\n  const $scope = $$scope();\r\n  const eventsMap = $scope.getEvents();\r\n  const handlersMap = eventsMap.get(eventName);\r\n  const $handler = detectIsArray(handler) ? (e: Event) => handler[0](...handler.slice(1), e) : handler;\r\n\r\n  if (!handlersMap) {\r\n    const rootHandler = (event: Event) => {\r\n      const handler = eventsMap.get(eventName).get(event.target);\r\n      const target = event.target as TagNativeElement;\r\n      let $event: SyntheticEvent<Event> = null;\r\n\r\n      if (detectIsFunction(handler)) {\r\n        $event = new SyntheticEvent({ sourceEvent: event, target });\r\n\r\n        $scope.setIsEventZone(true);\r\n        handler($event);\r\n        $scope.setIsEventZone(false);\r\n      }\r\n\r\n      if (target.parentElement) {\r\n        const shouldPropagate = $event ? $event.getPropagation() : true;\r\n\r\n        if (shouldPropagate) {\r\n          const constructor = event.constructor as BrowserEventConstructor;\r\n\r\n          target.parentElement.dispatchEvent(new constructor(event.type, event));\r\n        }\r\n      }\r\n    };\r\n\r\n    eventsMap.set(eventName, new WeakMap([[target, $handler]]));\r\n    document.addEventListener(eventName, rootHandler, true);\r\n    $scope.addEventUnsubscriber(() => document.removeEventListener(eventName, rootHandler, true));\r\n  } else {\r\n    handlersMap.set(target, $handler);\r\n  }\r\n}\r\n\r\nconst detectIsEvent = (attrName: string) => attrName.startsWith('on');\r\n\r\nconst getEventName = (attrName: string) => attrName.slice(2, attrName.length).toLowerCase();\r\n\r\nexport { SyntheticEvent, delegateEvent, detectIsEvent, getEventName };\r\n","export const VERSION = '0.25.1';\r\nexport const STYLE_ATTR = 'style';\r\nexport const CLASS_ATTR = 'class';\r\nexport const CLASS_NAME_ATTR = 'className';\r\nexport const EXCLUDE_ATTR_MARK = '$';\r\n","import {\r\n  type Fiber,\r\n  type VirtualNode,\r\n  type TagVirtualNode,\r\n  type TextVirtualNode,\r\n  type CommentVirtualNode,\r\n  type PlainVirtualNode,\r\n  type Callback,\r\n  REF_ATTR,\r\n  ATTR_BLACK_LIST,\r\n  CREATE_EFFECT_TAG,\r\n  UPDATE_EFFECT_TAG,\r\n  DELETE_EFFECT_TAG,\r\n  SKIP_EFFECT_TAG,\r\n  MOVE_MASK,\r\n  FLUSH_MASK,\r\n  SHADOW_MASK,\r\n  detectIsUndefined,\r\n  detectIsBoolean,\r\n  detectIsObject,\r\n  NodeType,\r\n  detectIsTagVirtualNode,\r\n  detectIsTextVirtualNode,\r\n  detectIsPlainVirtualNode,\r\n  getFiberWithElement,\r\n  collectElements,\r\n  walk,\r\n  dummyFn,\r\n  $$scope,\r\n  applyRef,\r\n} from '@dark-engine/core';\r\n\r\nimport { detectIsPortal } from '../portal';\r\nimport { delegateEvent, detectIsEvent, getEventName } from '../events';\r\nimport { STYLE_ATTR, CLASS_ATTR, CLASS_NAME_ATTR, EXCLUDE_ATTR_MARK } from '../constants';\r\nimport type {\r\n  NativeElement,\r\n  TagNativeElement,\r\n  TextNativeElement,\r\n  CommentNativeElement,\r\n  NativeNode,\r\n  AttributeValue,\r\n} from '../native-element';\r\n\r\nlet moves: Array<Callback> = [];\r\nlet patches: Array<Callback> = [];\r\nlet trackUpdate: (nativeElement: NativeElement) => void = null;\r\nconst svgTagNames = new Set([\r\n  'svg',\r\n  'animate',\r\n  'animateMotion',\r\n  'animateTransform',\r\n  'circle',\r\n  'clipPath',\r\n  'defs',\r\n  'desc',\r\n  'ellipse',\r\n  'feBlend',\r\n  'feColorMatrix',\r\n  'feComponentTransfer',\r\n  'feComposite',\r\n  'feConvolveMatrix',\r\n  'feDiffuseLighting',\r\n  'feDisplacementMap',\r\n  'feDistantLight',\r\n  'feDropShadow',\r\n  'feFlood',\r\n  'feFuncA',\r\n  'feFuncB',\r\n  'feFuncG',\r\n  'feFuncR',\r\n  'feGaussianBlur',\r\n  'feImage',\r\n  'feMerge',\r\n  'feMergeNode',\r\n  'feMorphology',\r\n  'feOffset',\r\n  'fePointLight',\r\n  'feSpecularLighting',\r\n  'feSpotLight',\r\n  'feTile',\r\n  'feTurbulence',\r\n  'filter',\r\n  'foreignObject',\r\n  'g',\r\n  'image',\r\n  'line',\r\n  'linearGradient',\r\n  'marker',\r\n  'mask',\r\n  'metadata',\r\n  'mpath',\r\n  'path',\r\n  'pattern',\r\n  'polygon',\r\n  'polyline',\r\n  'radialGradient',\r\n  'rect',\r\n  'stop',\r\n  'switch',\r\n  'symbol',\r\n  'text',\r\n  'textPath',\r\n  'tspan',\r\n  'use',\r\n  'view',\r\n]);\r\nconst voidTagNames = new Set([\r\n  'area',\r\n  'base',\r\n  'br',\r\n  'col',\r\n  'embed',\r\n  'hr',\r\n  'img',\r\n  'input',\r\n  'link',\r\n  'meta',\r\n  'param',\r\n  'source',\r\n  'track',\r\n  'wbr',\r\n]);\r\n\r\nconst createNativeElementMap = {\r\n  [NodeType.TAG]: (vNode: VirtualNode): TagNativeElement => {\r\n    const tagNode = vNode as TagVirtualNode;\r\n    const name = tagNode.name;\r\n\r\n    return detectIsSvgElement(name)\r\n      ? document.createElementNS('http://www.w3.org/2000/svg', name)\r\n      : document.createElement(name);\r\n  },\r\n  [NodeType.TEXT]: (vNode: VirtualNode): TextNativeElement => {\r\n    return document.createTextNode((vNode as TextVirtualNode).value);\r\n  },\r\n  [NodeType.COMMENT]: (vNode: VirtualNode): CommentNativeElement => {\r\n    return document.createComment((vNode as CommentVirtualNode).value);\r\n  },\r\n};\r\n\r\nfunction createNativeElement(node: VirtualNode): NativeElement {\r\n  return createNativeElementMap[node.type](node);\r\n}\r\n\r\nfunction detectIsSvgElement(name: string) {\r\n  return svgTagNames.has(name);\r\n}\r\n\r\nfunction detectIsVoidElement(name: string) {\r\n  return voidTagNames.has(name);\r\n}\r\n\r\nfunction setObjectStyle(element: TagNativeElement, style: object) {\r\n  const keys = Object.keys(style);\r\n\r\n  for (const key of keys) {\r\n    element.style.setProperty(key, String(style[key]));\r\n  }\r\n}\r\n\r\nfunction addAttributes(element: NativeElement, node: TagVirtualNode, isHydrateZone: boolean) {\r\n  const attrNames = Object.keys(node.attrs);\r\n  const tagElement = element as TagNativeElement;\r\n\r\n  for (const attrName of attrNames) {\r\n    const attrValue = node.attrs[attrName];\r\n\r\n    if (attrName[0] === EXCLUDE_ATTR_MARK) continue;\r\n\r\n    if (attrName === REF_ATTR) {\r\n      applyRef(attrValue, element);\r\n      continue;\r\n    }\r\n\r\n    if (attrName === CLASS_ATTR || attrName === CLASS_NAME_ATTR) {\r\n      toggleAttribute(tagElement, CLASS_ATTR, attrValue);\r\n      continue;\r\n    }\r\n\r\n    if (attrName === STYLE_ATTR && attrValue && detectIsObject(attrValue)) {\r\n      setObjectStyle(tagElement, attrValue);\r\n      continue;\r\n    }\r\n\r\n    if (detectIsEvent(attrName)) {\r\n      delegateEvent(tagElement, getEventName(attrName), attrValue);\r\n    } else if (!isHydrateZone && !detectIsUndefined(attrValue) && !ATTR_BLACK_LIST[attrName]) {\r\n      const stop = patchProperties({\r\n        tagName: node.name,\r\n        element: tagElement,\r\n        attrValue,\r\n        attrName,\r\n      });\r\n\r\n      !stop && tagElement.setAttribute(attrName, attrValue);\r\n    }\r\n  }\r\n}\r\n\r\nfunction updateAttributes(element: NativeElement, prevNode: TagVirtualNode, nextNode: TagVirtualNode) {\r\n  const attrNames = getAttributeNames(prevNode, nextNode);\r\n  const tagElement = element as TagNativeElement;\r\n\r\n  for (const attrName of attrNames) {\r\n    const prevAttrValue = prevNode.attrs[attrName];\r\n    const nextAttrValue = nextNode.attrs[attrName];\r\n\r\n    if (attrName[0] === EXCLUDE_ATTR_MARK) continue;\r\n\r\n    if (attrName === REF_ATTR) {\r\n      applyRef(prevAttrValue, element);\r\n      continue;\r\n    }\r\n\r\n    if ((attrName === CLASS_ATTR || attrName === CLASS_NAME_ATTR) && prevAttrValue !== nextAttrValue) {\r\n      toggleAttribute(tagElement, CLASS_ATTR, nextAttrValue);\r\n      continue;\r\n    }\r\n\r\n    if (attrName === STYLE_ATTR && nextAttrValue && prevAttrValue !== nextAttrValue && detectIsObject(nextAttrValue)) {\r\n      setObjectStyle(tagElement, nextAttrValue);\r\n      continue;\r\n    }\r\n\r\n    if (!detectIsUndefined(nextAttrValue)) {\r\n      if (detectIsEvent(attrName)) {\r\n        prevAttrValue !== nextAttrValue && delegateEvent(tagElement, getEventName(attrName), nextAttrValue);\r\n      } else if (!ATTR_BLACK_LIST[attrName] && prevAttrValue !== nextAttrValue) {\r\n        const stop = patchProperties({\r\n          tagName: nextNode.name,\r\n          element: tagElement,\r\n          attrValue: nextAttrValue,\r\n          attrName,\r\n        });\r\n\r\n        !stop && tagElement.setAttribute(attrName, nextAttrValue);\r\n      }\r\n    } else {\r\n      tagElement.removeAttribute(attrName);\r\n    }\r\n  }\r\n}\r\n\r\nfunction toggleAttribute(element: TagNativeElement, name: string, value: string) {\r\n  value ? element.setAttribute(name, value) : element.removeAttribute(name);\r\n}\r\n\r\nfunction getAttributeNames(prevNode: TagVirtualNode, nextNode: TagVirtualNode) {\r\n  const attrNames = new Set<string>();\r\n  const prevAttrs = Object.keys(prevNode.attrs);\r\n  const nextAttrs = Object.keys(nextNode.attrs);\r\n  const size = Math.max(prevAttrs.length, nextAttrs.length);\r\n\r\n  for (let i = 0; i < size; i++) {\r\n    attrNames.add(prevAttrs[i] || nextAttrs[i]);\r\n  }\r\n\r\n  return attrNames;\r\n}\r\n\r\ntype PatchPropertiesOptions = {\r\n  tagName: string;\r\n  element: TagNativeElement;\r\n  attrName: string;\r\n  attrValue: AttributeValue;\r\n};\r\n\r\nfunction patchProperties(options: PatchPropertiesOptions): boolean {\r\n  const { tagName, element, attrName, attrValue } = options;\r\n  const fn = patchPropertiesSpecialCasesMap[tagName];\r\n  let stop = fn ? fn(element, attrName, attrValue) : false;\r\n\r\n  if (canSetProperty(element, attrName)) {\r\n    element[attrName] = attrValue;\r\n  }\r\n\r\n  if (!stop && detectIsBoolean(attrValue)) {\r\n    stop = !attrName.includes('-');\r\n  }\r\n\r\n  return stop;\r\n}\r\n\r\nfunction canSetProperty(element: TagNativeElement, key: string) {\r\n  const prototype = Object.getPrototypeOf(element);\r\n  const descriptor = Object.getOwnPropertyDescriptor(prototype, key);\r\n\r\n  return Boolean(descriptor?.set);\r\n}\r\n\r\nconst patchPropertiesSpecialCasesMap: Record<\r\n  string,\r\n  (element: NativeElement, attrName: string, attrValue: AttributeValue) => boolean\r\n> = {\r\n  input: (element: HTMLInputElement, attrName: string, attrValue: AttributeValue) => {\r\n    if (attrName === 'value') {\r\n      patches.push(() => {\r\n        detectIsBoolean(attrValue) ? (element.checked = attrValue) : (element.value = String(attrValue));\r\n      });\r\n    } else if (attrName === 'autoFocus') {\r\n      patches.push(() => {\r\n        element.autofocus = Boolean(attrValue);\r\n        element.autofocus && element.focus();\r\n      });\r\n    }\r\n\r\n    return false;\r\n  },\r\n  textarea: (element: HTMLTextAreaElement, attrName: string, attrValue: AttributeValue) => {\r\n    if (attrName === 'value') {\r\n      element.innerText = String(attrValue);\r\n\r\n      return true;\r\n    }\r\n\r\n    return false;\r\n  },\r\n};\r\n\r\nfunction commitCreation(fiber: Fiber<NativeElement>) {\r\n  const parentFiber = getFiberWithElement<NativeElement, TagNativeElement>(fiber.parent);\r\n  const parentElement = parentFiber.element;\r\n  const childNodes = parentElement.childNodes;\r\n  const isHydrateZone = $$scope().getIsHydrateZone();\r\n\r\n  if (isHydrateZone) {\r\n    const nativeElement = childNodes[fiber.eidx] as NativeElement;\r\n\r\n    if (\r\n      detectIsTextVirtualNode(fiber.inst) &&\r\n      nativeElement instanceof Text &&\r\n      fiber.inst.value.length !== nativeElement.length\r\n    ) {\r\n      nativeElement.splitText(fiber.inst.value.length);\r\n    }\r\n\r\n    fiber.element = nativeElement;\r\n  } else {\r\n    if (!(fiber.mask & SHADOW_MASK)) {\r\n      if (childNodes.length === 0 || fiber.eidx > childNodes.length - 1) {\r\n        !detectIsVoidElement((parentFiber.inst as TagVirtualNode).name) &&\r\n          appendNativeElement(fiber.element, parentElement);\r\n      } else {\r\n        insertNativeElement(fiber.element, parentElement.childNodes[fiber.eidx], parentElement);\r\n      }\r\n    }\r\n  }\r\n\r\n  detectIsTagVirtualNode(fiber.inst) && addAttributes(fiber.element, fiber.inst, isHydrateZone);\r\n}\r\n\r\nfunction commitUpdate(fiber: Fiber<NativeElement>) {\r\n  const element = fiber.element;\r\n  const prevInstance = fiber.alt.inst as VirtualNode;\r\n  const nextInstance = fiber.inst as VirtualNode;\r\n\r\n  detectIsPlainVirtualNode(nextInstance)\r\n    ? (prevInstance as PlainVirtualNode).value !== nextInstance.value && (element.textContent = nextInstance.value)\r\n    : updateAttributes(element, prevInstance as TagVirtualNode, nextInstance as TagVirtualNode);\r\n}\r\n\r\nfunction commitDeletion(fiber: Fiber<NativeElement>) {\r\n  const parentFiber = getFiberWithElement<NativeElement, TagNativeElement>(fiber.parent);\r\n\r\n  if (fiber.mask & FLUSH_MASK) {\r\n    parentFiber.element.innerHTML && (parentFiber.element.innerHTML = '');\r\n    return;\r\n  }\r\n\r\n  walk<NativeElement>(fiber, (fiber, skip) => {\r\n    if (fiber.element) {\r\n      !detectIsPortal(fiber.inst) &&\r\n        canRemoveNativeElement(fiber.element, parentFiber.element) &&\r\n        removeNativeElement(fiber.element, parentFiber.element);\r\n      return skip();\r\n    }\r\n  });\r\n}\r\n\r\nfunction move(fiber: Fiber<NativeElement>) {\r\n  const sourceNodes = collectElements(fiber, x => x.element);\r\n  const sourceNode = sourceNodes[0];\r\n  const parentElement = sourceNode.parentElement;\r\n  const sourceFragment = new DocumentFragment();\r\n  const elementIdx = fiber.eidx;\r\n  let idx = 0;\r\n  const move = () => {\r\n    for (let i = 1; i < sourceNodes.length; i++) {\r\n      removeNativeElement(parentElement.childNodes[elementIdx + 1], parentElement);\r\n    }\r\n\r\n    replaceNativeElement(sourceFragment, parentElement.childNodes[elementIdx], parentElement);\r\n  };\r\n\r\n  for (const node of sourceNodes) {\r\n    insertNativeElement(document.createComment(`${elementIdx}:${idx}`), node, parentElement);\r\n    appendNativeElement(node, sourceFragment);\r\n    idx++;\r\n  }\r\n\r\n  moves.push(move);\r\n}\r\n\r\nconst commitMap: Record<string, (fiber: Fiber<NativeElement>) => void> = {\r\n  [CREATE_EFFECT_TAG]: (fiber: Fiber<NativeElement>) => {\r\n    if (!fiber.element || detectIsPortal(fiber.inst)) return;\r\n    trackUpdate && trackUpdate(fiber.element);\r\n    commitCreation(fiber);\r\n  },\r\n  [UPDATE_EFFECT_TAG]: (fiber: Fiber<NativeElement>) => {\r\n    fiber.mask & MOVE_MASK && (move(fiber), (fiber.mask &= ~MOVE_MASK));\r\n    if (!fiber.element || detectIsPortal(fiber.inst)) return;\r\n    trackUpdate && trackUpdate(fiber.element);\r\n    commitUpdate(fiber);\r\n  },\r\n  [DELETE_EFFECT_TAG]: commitDeletion,\r\n  [SKIP_EFFECT_TAG]: dummyFn,\r\n};\r\n\r\nfunction finishCommit() {\r\n  moves.forEach(x => x());\r\n  patches.forEach(x => x());\r\n  moves = [];\r\n  patches = [];\r\n}\r\n\r\nconst commit = (fiber: Fiber<NativeElement>) => commitMap[fiber.tag](fiber);\r\n\r\nconst setTrackUpdate = (fn: typeof trackUpdate) => (trackUpdate = fn);\r\n\r\nconst appendNativeElement = (element: NativeNode, parent: NativeNode) => parent.appendChild(element);\r\n\r\nconst insertNativeElement = (element: NativeNode, sibling: NativeNode, parent: TagNativeElement) =>\r\n  parent.insertBefore(element, sibling);\r\n\r\nconst insertNativeElementByIndex = (element: NativeNode, idx: number, parent: TagNativeElement) =>\r\n  parent.insertBefore(element, parent.childNodes[idx]);\r\n\r\nconst replaceNativeElement = (element: NativeNode, candidate: NativeNode, parent: TagNativeElement) =>\r\n  parent.replaceChild(element, candidate);\r\n\r\nconst canRemoveNativeElement = (element: NativeNode, parent: NativeNode) => element.parentElement === parent;\r\n\r\nconst removeNativeElement = (element: NativeNode, parent: TagNativeElement) => parent.removeChild(element);\r\n\r\nexport { createNativeElement, commit, finishCommit, setTrackUpdate, insertNativeElementByIndex };\r\n","import {\r\n  type DarkElement,\r\n  type Callback,\r\n  ROOT,\r\n  Fiber,\r\n  CREATE_EFFECT_TAG,\r\n  UPDATE_EFFECT_TAG,\r\n  platform,\r\n  flatten,\r\n  detectIsUndefined,\r\n  detectIsFunction,\r\n  trueFn,\r\n  TagVirtualNode,\r\n  TaskPriority,\r\n  createReplacer,\r\n  setRootId,\r\n  $$scope,\r\n  dummyFn,\r\n  scheduler,\r\n} from '@dark-engine/core';\r\n\r\nimport { createNativeElement, insertNativeElementByIndex, commit, finishCommit } from '../dom';\r\nimport { detectIsPortal, unmountPortal } from '../portal/utils';\r\nimport type { TagNativeElement } from '../native-element';\r\n\r\nconst roots = new Map<Element, number>();\r\nconst raf = requestAnimationFrame.bind(window);\r\nconst caf = cancelAnimationFrame.bind(window);\r\nconst spawn = raf;\r\nlet isInjected = false;\r\n\r\nfunction inject() {\r\n  platform.createElement = createNativeElement as typeof platform.createElement;\r\n  platform.insertElement = insertNativeElementByIndex as typeof platform.insertElement;\r\n  platform.raf = raf;\r\n  platform.caf = caf;\r\n  platform.spawn = spawn;\r\n  platform.commit = commit;\r\n  platform.finishCommit = finishCommit;\r\n  platform.detectIsDynamic = trueFn;\r\n  platform.detectIsPortal = detectIsPortal;\r\n  platform.unmountPortal = unmountPortal;\r\n  platform.chunk = dummyFn;\r\n  isInjected = true;\r\n}\r\n\r\nfunction render(element: DarkElement, container: TagNativeElement, hydrate?: Callback) {\r\n  !isInjected && inject();\r\n  if (process.env.NODE_ENV !== 'production') {\r\n    if (!(container instanceof Element)) {\r\n      throw new Error(`[Dark]: render receives only Element as container!`);\r\n    }\r\n  }\r\n\r\n  const isMounted = !detectIsUndefined(roots.get(container));\r\n  const isHydrate = detectIsFunction(hydrate);\r\n  let rootId: number = null;\r\n\r\n  if (!isMounted) {\r\n    rootId = roots.size;\r\n    roots.set(container, rootId);\r\n    !isHydrate && (container.innerHTML = '');\r\n  } else {\r\n    rootId = roots.get(container);\r\n  }\r\n\r\n  const $scope = $$scope(rootId);\r\n\r\n  // insertion effect can't schedule renders\r\n  if ($scope?.getIsInsertionEffectsZone()) return;\r\n\r\n  const callback = () => {\r\n    setRootId(rootId); // !\r\n    const $scope = $$scope();\r\n    const rootFiber = $scope.getRoot();\r\n    const isUpdate = Boolean(rootFiber);\r\n    const fiber = new Fiber().mutate({\r\n      element: container,\r\n      inst: new TagVirtualNode(ROOT, {}, flatten([element || createReplacer()]) as TagVirtualNode['children']),\r\n      alt: rootFiber,\r\n      tag: isUpdate ? UPDATE_EFFECT_TAG : CREATE_EFFECT_TAG,\r\n    });\r\n\r\n    $scope.resetMount();\r\n    $scope.setWorkInProgress(fiber);\r\n    $scope.setIsHydrateZone(isHydrate);\r\n    $scope.setNextUnitOfWork(fiber);\r\n    isHydrate && hydrate();\r\n  };\r\n\r\n  scheduler.schedule(callback, { priority: TaskPriority.NORMAL });\r\n}\r\n\r\nexport { render, roots, inject };\r\n","import { type DarkElement, type AppResource, APP_STATE_ATTR, $$scope } from '@dark-engine/core';\r\n\r\nimport { render } from '../render';\r\nimport { unmount } from '../create-root';\r\nimport type { TagNativeElement } from '../native-element';\r\n\r\nfunction hydrateRoot(container: TagNativeElement, element: DarkElement) {\r\n  render(element, container, hydrate);\r\n\r\n  return {\r\n    unmount: () => unmount(container),\r\n  };\r\n}\r\n\r\nfunction hydrate() {\r\n  const element = document.querySelector(`[${APP_STATE_ATTR}]`);\r\n\r\n  if (!element) return;\r\n  try {\r\n    const resources = parse(element.textContent) as Record<string, AppResource>;\r\n    const $scope = $$scope();\r\n\r\n    for (const key of Object.keys(resources)) {\r\n      $scope.setResource(Number(key), resources[key]);\r\n    }\r\n\r\n    element.remove();\r\n  } catch (error) {\r\n    throw Error('[Dark]: can not hydrate app state from the server!');\r\n  }\r\n}\r\n\r\nconst parse = (x: string) => JSON.parse(window.atob(x.replaceAll('\"', '')));\r\n\r\nexport { hydrateRoot };\r\n","import { type ScheduleCallbackOptions, scheduler } from '../scheduler';\r\nimport { type UpdateChanger, createUpdate } from '../workloop';\r\nimport { getRootId, $$scope } from '../scope';\r\nimport { TaskPriority } from '../constants';\r\nimport { addBatch } from '../batch';\r\nimport { detectIsFunction } from '../utils';\r\nimport { createHookLocation } from '../walk';\r\n\r\nexport type UpdateOptions = UpdateChanger;\r\n\r\nfunction useUpdate() {\r\n  const rootId = getRootId();\r\n  const fiber = $$scope().getCursorFiber();\r\n  const hook = fiber.hook; // !\r\n  const { idx } = hook;\r\n  const update = (createChanger?: () => UpdateChanger) => {\r\n    const $scope = $$scope();\r\n    if ($scope.getIsInsertionEffectsZone()) return;\r\n    const { owner } = hook;\r\n    const hasChanger = detectIsFunction(createChanger);\r\n    const isTransition = $scope.getIsTransitionZone();\r\n    const isBatch = $scope.getIsBatchZone();\r\n    const isEvent = $scope.getIsEventZone();\r\n    const priority = isTransition ? TaskPriority.LOW : isEvent ? TaskPriority.HIGH : TaskPriority.NORMAL; // !\r\n    const forceAsync = isTransition;\r\n    const setPendingStatus = $scope.getPendingStatusSetter();\r\n    const callback = createUpdate({\r\n      rootId,\r\n      hook,\r\n      isTransition,\r\n      createChanger: hasChanger ? createChanger : undefined,\r\n    });\r\n    const createLocation = () => createHookLocation(rootId, idx, owner);\r\n    const callbackOptions: ScheduleCallbackOptions = {\r\n      priority,\r\n      forceAsync,\r\n      isTransition,\r\n      createLocation,\r\n      setPendingStatus,\r\n    };\r\n\r\n    if (isBatch) {\r\n      addBatch(\r\n        owner,\r\n        () => scheduler.schedule(callback, callbackOptions),\r\n        () => hasChanger && createChanger().setValue(),\r\n      );\r\n    } else {\r\n      scheduler.schedule(callback, callbackOptions);\r\n    }\r\n  };\r\n\r\n  return update;\r\n}\r\n\r\nexport { useUpdate };\r\n","import { $$scope } from '../scope';\r\nimport { type Fiber } from '../fiber';\r\nimport { type Callback } from '../shared';\r\n\r\nfunction batch(callback: () => void) {\r\n  const $scope = $$scope();\r\n\r\n  $scope.setIsBatchZone(true);\r\n  callback();\r\n  $scope.setIsBatchZone(false);\r\n}\r\n\r\nfunction addBatch(fiber: Fiber, callback: Callback, change: Callback) {\r\n  const $scope = $$scope();\r\n\r\n  if ($scope.getIsTransitionZone()) {\r\n    callback();\r\n  } else {\r\n    const batch = fiber.batch || { timer: null, changes: [] };\r\n\r\n    fiber.batch = batch;\r\n    batch.changes.push(change);\r\n    batch.timer && clearTimeout(batch.timer);\r\n    batch.timer = setTimeout(() => {\r\n      batch.changes.splice(-1);\r\n      batch.changes.forEach(x => x());\r\n      fiber.batch = null;\r\n      callback();\r\n    });\r\n  }\r\n}\r\n\r\nexport { batch, addBatch };\r\n","import type { DarkElement, Subscribe, SubscriberWithValue, SlotProps, KeyProps } from '../shared';\r\nimport { type ComponentFactory, component } from '../component';\r\nimport type { Fiber } from '../fiber';\r\nimport { detectIsFunction } from '../utils';\r\nimport { $$scope } from '../scope';\r\nimport { useEffect } from '../use-effect';\r\nimport { useMemo } from '../use-memo';\r\nimport { useUpdate } from '../use-update';\r\n\r\ntype CreateContextOptions = {\r\n  displayName?: string;\r\n};\r\n\r\nfunction createContext<T>(defaultValue: T, options?: CreateContextOptions): Context<T> {\r\n  const { displayName = 'Context' } = options || {};\r\n  const context: Context<T> = {\r\n    displayName,\r\n    defaultValue,\r\n    Provider: null,\r\n    Consumer: null,\r\n  };\r\n\r\n  context.Provider = createProvider(context, defaultValue, displayName);\r\n  context.Consumer = createConsumer(context, displayName);\r\n\r\n  return context;\r\n}\r\n\r\nfunction createProvider<T>(context: Context<T>, defaultValue: T, displayName: string) {\r\n  return component<ContexProviderProps<T>>(\r\n    ({ value = defaultValue, slot }) => {\r\n      const fiber = $$scope().getCursorFiber();\r\n\r\n      if (!fiber.provider) {\r\n        const providerValue: ContextProviderValue<T> = {\r\n          value,\r\n          subscribers: new Set(),\r\n          subscribe: (subscriber: (value: T) => void) => {\r\n            providerValue.subscribers.add(subscriber);\r\n\r\n            return () => providerValue.subscribers.delete(subscriber);\r\n          },\r\n        };\r\n\r\n        fiber.provider = new Map();\r\n        fiber.provider.set(context, providerValue);\r\n      }\r\n\r\n      const provider = fiber.provider.get(context);\r\n\r\n      useEffect(() => {\r\n        provider.subscribers.forEach(fn => fn(value));\r\n      }, [value]);\r\n\r\n      provider.value = value;\r\n\r\n      return slot;\r\n    },\r\n    { displayName: `${displayName}.Provider` },\r\n  );\r\n}\r\n\r\ntype ConsumerProps<T> = {\r\n  slot: (value: T) => DarkElement;\r\n};\r\n\r\nfunction createConsumer<T>(context: Context<T>, displayName: string) {\r\n  return component<ConsumerProps<T>>(\r\n    ({ slot }) => {\r\n      const value = useContext(context);\r\n\r\n      return detectIsFunction(slot) ? slot(value) : null;\r\n    },\r\n    { displayName: `${displayName}.Consumer` },\r\n  );\r\n}\r\n\r\nfunction useContext<T>(context: Context<T>): T {\r\n  const { defaultValue } = context;\r\n  const fiber = $$scope().getCursorFiber();\r\n  const provider = useMemo(() => getProvider<T>(context, fiber), []);\r\n  const value = provider ? provider.value : defaultValue;\r\n  const update = useUpdate();\r\n  const scope = useMemo(() => ({ value }), []);\r\n  const hasProvider = Boolean(provider);\r\n\r\n  useEffect(() => {\r\n    if (!hasProvider) return;\r\n    const unsubscribe = provider.subscribe((value: T) => {\r\n      if (!Object.is(scope.value, value)) {\r\n        update();\r\n      }\r\n    });\r\n\r\n    return unsubscribe;\r\n  }, [hasProvider]);\r\n\r\n  scope.value = value;\r\n\r\n  return value;\r\n}\r\n\r\nfunction getProvider<T>(context: Context<T>, fiber: Fiber): ContextProviderValue<T> {\r\n  let nextFiber = fiber;\r\n\r\n  while (nextFiber) {\r\n    if (nextFiber.provider && nextFiber.provider.get(context)) {\r\n      return nextFiber.provider.get(context) as ContextProviderValue<T>;\r\n    }\r\n\r\n    nextFiber = nextFiber.parent;\r\n  }\r\n\r\n  return null;\r\n}\r\n\r\ntype ContexProviderProps<T> = {\r\n  value: T;\r\n} & SlotProps &\r\n  KeyProps;\r\n\r\nexport type Context<T = unknown> = {\r\n  Provider: ComponentFactory<ContexProviderProps<T>>;\r\n  Consumer: ComponentFactory<SlotProps<(value: T) => DarkElement>>;\r\n  displayName?: string;\r\n  defaultValue: T;\r\n};\r\n\r\nexport type ContextProviderValue<T = unknown> = {\r\n  value: T;\r\n  subscribers: Set<(value: T) => void>;\r\n  subscribe: Subscribe<SubscriberWithValue<T>>;\r\n};\r\n\r\nexport { createContext, useContext };\r\n","import { useMemo } from '../use-memo';\r\n\r\nfunction useCallback<T = Function>(callback: T, deps: Array<any>): T {\r\n  const value = useMemo(() => callback, deps);\r\n\r\n  return value;\r\n}\r\n\r\nexport { useCallback };\r\n","import { detectIsFunction } from '../utils';\r\nimport { type UpdateOptions, useUpdate } from '../use-update';\r\nimport { useMemo } from '../use-memo';\r\nimport { $$scope } from '../scope';\r\nimport { useCallback } from '../use-callback';\r\n\r\ntype Value<T> = T | ((prevValue: T) => T);\r\n\r\nfunction useState<T = unknown>(initialValue: T | (() => T)): [T, (value: Value<T>) => void] {\r\n  const update = useUpdate();\r\n  const scope = useMemo(\r\n    () => ({\r\n      value: detectIsFunction(initialValue) ? initialValue() : initialValue,\r\n    }),\r\n    [],\r\n  );\r\n  const setState = useCallback((sourceValue: Value<T>) => {\r\n    const $scope = $$scope();\r\n    const isBatch = $scope.getIsBatchZone();\r\n    const create = (): UpdateOptions => {\r\n      const prevValue = scope.value;\r\n      const newValue = detectIsFunction(sourceValue) ? sourceValue(prevValue) : sourceValue;\r\n      const shouldUpdate = () => isBatch || !Object.is(prevValue, newValue);\r\n      const setValue = () => (scope.value = newValue);\r\n      const resetValue = () => (scope.value = prevValue);\r\n\r\n      return { shouldUpdate, setValue, resetValue };\r\n    };\r\n\r\n    update(create);\r\n  }, []);\r\n\r\n  return [scope.value, setState];\r\n}\r\n\r\nexport { useState };\r\n","import { detectIsComponent } from '../component';\r\n\r\nconst $$shadow = Symbol('shadow');\r\n\r\nconst detectIsShadow = (instance: unknown) => detectIsComponent(instance) && instance.token === $$shadow;\r\n\r\nexport { $$shadow, detectIsShadow };\r\n","import type { DarkElement } from '../shared';\r\nimport { component } from '../component';\r\nimport { SHADOW_MASK } from '../constants';\r\nimport { useLayoutEffect } from '../use-layout-effect';\r\nimport { $$scope } from '../scope';\r\nimport { collectElements, getFiberWithElement } from '../walk';\r\nimport { platform, detectIsServer } from '../platform';\r\nimport { $$shadow } from './utils';\r\n\r\ntype ShadowProps = {\r\n  isInserted: boolean;\r\n  slot: DarkElement;\r\n};\r\n\r\nconst Shadow = component<ShadowProps>(\r\n  ({ isInserted, slot }) => {\r\n    const isEnabled = !detectIsServer() && !$$scope().getIsHydrateZone();\r\n    const fiber = $$scope().getCursorFiber();\r\n\r\n    if (isEnabled) {\r\n      if (isInserted) {\r\n        fiber.mask &= ~SHADOW_MASK;\r\n      } else {\r\n        !(fiber.mask & SHADOW_MASK) && (fiber.mask |= SHADOW_MASK);\r\n      }\r\n    }\r\n\r\n    useLayoutEffect(() => {\r\n      if (!isEnabled || !isInserted) return;\r\n      const $fiber = getFiberWithElement(fiber);\r\n      const fibers = collectElements(fiber, x => x);\r\n\r\n      for (const fiber of fibers) {\r\n        platform.insertElement(fiber.element, fiber.eidx, $fiber.element);\r\n      }\r\n    }, [isInserted]);\r\n\r\n    return slot || null;\r\n  },\r\n  { token: $$shadow },\r\n);\r\n\r\nexport { Shadow };\r\n","import type { DarkElement, SlotProps } from '../shared';\r\nimport { useLayoutEffect } from '../use-layout-effect';\r\nimport { detectIsServer } from '../platform';\r\nimport { createContext, useContext } from '../context';\r\nimport { component } from '../component';\r\nimport { useState } from '../use-state';\r\nimport { Fragment } from '../fragment';\r\nimport { useMemo } from '../use-memo';\r\nimport { $$scope } from '../scope';\r\nimport { Shadow } from '../shadow';\r\nimport { dummyFn } from '../utils';\r\n\r\ntype SuspenseProps = {\r\n  fallback: DarkElement;\r\n} & Required<SlotProps>;\r\n\r\ntype ContextValue = {\r\n  isLoaded: boolean;\r\n  fallback: DarkElement;\r\n  register: (id: string) => void;\r\n  unregister: (id: string) => void;\r\n};\r\n\r\nconst SuspenseContext = createContext<ContextValue>({\r\n  isLoaded: false,\r\n  fallback: null,\r\n  register: dummyFn,\r\n  unregister: dummyFn,\r\n});\r\n\r\nconst Suspense = component<SuspenseProps>(({ fallback, slot }) => {\r\n  if (process.env.NODE_ENV !== 'production') {\r\n    if (!fallback) {\r\n      throw new Error(`[Dark]: Suspense fallback not found!`);\r\n    }\r\n  }\r\n  const $scope = $$scope();\r\n  const emitter = $scope.getEmitter();\r\n  const [isLoaded, setIsLoaded] = useState(() => detectIsServer() || $scope.getIsHydrateZone());\r\n  const scope = useMemo<Scope>(() => ({ store: new Set(), isLoaded }), []);\r\n  const value = useMemo<ContextValue>(() => ({ isLoaded, fallback, register: null, unregister: null }), []);\r\n  const content = [\r\n    Shadow({ key: CONTENT, isInserted: isLoaded, slot }),\r\n    isLoaded ? null : Fragment({ key: FALLBACK, slot: fallback }),\r\n  ].filter(Boolean);\r\n\r\n  useLayoutEffect(() => {\r\n    const off = emitter.on('finish', () => {\r\n      const { store, isLoaded } = scope;\r\n\r\n      if (store.size === 0 && !isLoaded) {\r\n        setIsLoaded(true);\r\n        off();\r\n      }\r\n    });\r\n\r\n    return off;\r\n  }, []);\r\n\r\n  scope.isLoaded = isLoaded;\r\n  value.isLoaded = isLoaded;\r\n  value.fallback = fallback;\r\n  value.register = (id: string) => scope.store.add(id);\r\n  value.unregister = (id: string) => scope.store.delete(id);\r\n\r\n  return SuspenseContext.Provider({ value, slot: content });\r\n});\r\n\r\ntype Scope = {\r\n  store: Set<string>;\r\n  isLoaded: boolean;\r\n};\r\n\r\nconst CONTENT = 1;\r\nconst FALLBACK = 2;\r\n\r\nconst useSuspense = () => useContext(SuspenseContext);\r\n\r\nexport { Suspense, useSuspense };\r\n","import { useMemo } from '../use-memo';\r\nimport { getRootId } from '../scope';\r\n\r\nfunction useId() {\r\n  const id = useMemo(() => getNextId(getRootId()), []);\r\n\r\n  return id;\r\n}\r\n\r\nlet nextId = 1000000;\r\n\r\nconst getNextId = (rootId: number) => `dark:${rootId}:${(++nextId).toString(36)}`;\r\n\r\nexport { useId };\r\n","import { type ComponentFactory, component } from '../component';\r\nimport { detectIsUndefined, dummyFn } from '../utils';\r\nimport { detectIsServer } from '../platform';\r\nimport { useSuspense } from '../suspense';\r\nimport { useUpdate } from '../use-update';\r\nimport { useEffect } from '../use-effect';\r\nimport { forwardRef } from '../ref';\r\nimport { $$scope } from '../scope';\r\nimport { useId } from '../use-id';\r\n\r\nconst $$lazy = Symbol('lazy');\r\nconst factories = new Map<Function, ComponentFactory>();\r\n\r\nfunction lazy<P extends object, R = unknown>(module: ModuleFn<P>, done: () => void = dummyFn) {\r\n  return forwardRef(\r\n    component<P, R>(\r\n      function type(props, ref) {\r\n        const { isLoaded, fallback, register, unregister } = useSuspense();\r\n        const $scope = $$scope();\r\n        const update = useUpdate();\r\n        const id = useId();\r\n        const factory = factories.get(module);\r\n\r\n        if (detectIsUndefined(factory)) {\r\n          const isServer = detectIsServer();\r\n          const isHydrateZone = $scope.getIsHydrateZone();\r\n          const make = async () => {\r\n            factories.set(module, await load(module));\r\n            unregister(id);\r\n            done();\r\n          };\r\n\r\n          register(id);\r\n          factories.set(module, null);\r\n\r\n          if (isServer || isHydrateZone) {\r\n            $scope.defer(make);\r\n          } else {\r\n            make().then(() => update());\r\n          }\r\n        }\r\n\r\n        useEffect(() => () => unregister(id), []);\r\n\r\n        return factory ? factory(props, ref) : isLoaded ? fallback : null;\r\n      },\r\n      { token: $$lazy },\r\n    ),\r\n  );\r\n}\r\n\r\nfunction load<P extends object>(module: ModuleFn<P>) {\r\n  return new Promise<ComponentFactory<P>>(resolve => {\r\n    module().then(module => {\r\n      if (process.env.NODE_ENV !== 'production') {\r\n        if (!module.default) {\r\n          throw new Error('[Dark]: Lazy loaded component should be exported as default!');\r\n        }\r\n      }\r\n\r\n      resolve(module.default);\r\n    });\r\n  });\r\n}\r\n\r\ntype ModuleFn<P extends object> = () => Promise<Module<P>>;\r\n\r\nexport type Module<P extends object = {}> = { default: ComponentFactory<P> };\r\n\r\nexport { lazy };\r\n","import { createContext, useContext } from '@dark-engine/core';\r\n\r\nimport { type RouterLocation } from '../location';\r\nimport { type RouterHistory } from '../history';\r\nimport { type Route } from '../create-routes';\r\n\r\nexport type ActiveRouteContextValue = {\r\n  location: RouterLocation;\r\n  params: Map<string, string>;\r\n  activeRoute: Route;\r\n};\r\n\r\nconst ActiveRouteContext = createContext<ActiveRouteContextValue>(null, { displayName: 'ActiveRoute' });\r\n\r\nfunction useActiveRouteContext() {\r\n  const value = useContext(ActiveRouteContext);\r\n\r\n  return value;\r\n}\r\n\r\nexport type RouterHistoryContextValue = {\r\n  history: RouterHistory;\r\n};\r\n\r\nconst RouterHistoryContext = createContext<RouterHistoryContextValue>(null, { displayName: 'RouterHistory' });\r\n\r\nfunction useRouterHistoryContext() {\r\n  const value = useContext(RouterHistoryContext);\r\n\r\n  return value;\r\n}\r\n\r\nconst CurrentPathContext = createContext<string>(null, { displayName: 'CurrentPath' });\r\n\r\nfunction useCurrentPathContext() {\r\n  const value = useContext(CurrentPathContext);\r\n\r\n  return value;\r\n}\r\n\r\nfunction checkContextValue(value: ActiveRouteContextValue | RouterHistoryContextValue) {\r\n  if (!value) {\r\n    throw new Error('[web-router]:  Illegal invoke hook outside router!');\r\n  }\r\n}\r\n\r\nexport {\r\n  ActiveRouteContext,\r\n  useActiveRouteContext,\r\n  RouterHistoryContext,\r\n  useRouterHistoryContext,\r\n  CurrentPathContext,\r\n  useCurrentPathContext,\r\n  checkContextValue,\r\n};\r\n","export const VERSION = '0.25.1';\r\nexport const SLASH_MARK = '/';\r\nexport const PARAMETER_MARK = ':';\r\nexport const WILDCARD_MARK = '**';\r\nexport const PROTOCOL_MARK = '://';\r\nexport const SEARCH_MARK = '?';\r\nexport const HASH_MARK = '#';\r\nexport const ROOT_MARK = '_ROOT_';\r\n","import { SLASH_MARK, PARAMETER_MARK, PROTOCOL_MARK, HASH_MARK, SEARCH_MARK } from '../constants';\r\n\r\nfunction pipe<T>(...fns: Array<Function>): (...args: Array<any>) => T {\r\n  const [fn, ...rest] = fns;\r\n\r\n  return (...args: Array<any>) => {\r\n    return rest.reduce(\r\n      (fn1, fn2) => () => fn2(fn1()),\r\n      () => fn(...args),\r\n    )();\r\n  };\r\n}\r\n\r\nfunction parseURL(url: string) {\r\n  let body = url;\r\n  let protocol = '';\r\n  let host = '';\r\n  let pathname = '';\r\n  let hash = '';\r\n  let search = '';\r\n\r\n  if (body.indexOf(PROTOCOL_MARK) !== -1) {\r\n    [protocol, body] = body.split(PROTOCOL_MARK).filter(Boolean);\r\n  }\r\n\r\n  const splitted = body.split('');\r\n  const idx = splitted.findIndex(x => x === SLASH_MARK);\r\n\r\n  if (idx !== -1) {\r\n    host = splitted.filter((_, idx1) => idx1 < idx).join('');\r\n    pathname = splitted.filter((_, idx1) => idx1 >= idx).join('');\r\n  } else {\r\n    host = body;\r\n    pathname = pathname || SLASH_MARK;\r\n  }\r\n\r\n  if (pathname.indexOf(SEARCH_MARK) !== -1) {\r\n    [pathname, search] = split(pathname, SEARCH_MARK);\r\n  }\r\n\r\n  if (body.indexOf(HASH_MARK) !== -1) {\r\n    if (search) {\r\n      [search, hash] = split(search, HASH_MARK);\r\n    } else {\r\n      [pathname, hash] = split(pathname, HASH_MARK);\r\n    }\r\n  }\r\n\r\n  return {\r\n    protocol,\r\n    host,\r\n    pathname: addSlashToEnd(pathname),\r\n    search: createSearch(search),\r\n    hash: createHash(hash),\r\n  };\r\n}\r\n\r\nconst createSearch = (value: string) => (value ? `${SEARCH_MARK}${value}` : '');\r\n\r\nconst createHash = (value: string) => (value ? `${HASH_MARK}${value}` : '');\r\n\r\nconst detectIsParam = (value: string) => value && value.startsWith(PARAMETER_MARK);\r\n\r\nconst getParamName = (value: string) => (detectIsParam(value) ? value.slice(1, value.length) : null);\r\n\r\nconst split = (value: string, token: string) => value.split(token).filter(Boolean);\r\n\r\nconst splitPath = (path: string) => split(path, SLASH_MARK);\r\n\r\nconst addSlashToStart = (path: string) => (path.startsWith(SLASH_MARK) ? path : SLASH_MARK + path);\r\n\r\nconst addSlashToEnd = (path: string) => (path.endsWith(SLASH_MARK) ? path : path + SLASH_MARK);\r\n\r\nfunction normalaizePathname(spath: string) {\r\n  const { pathname, search, hash } = parseURL(addSlashToStart(spath));\r\n  const newSpath = pathname + search + hash;\r\n\r\n  return newSpath;\r\n}\r\n\r\nfunction sort<T>(type: 'asc' | 'desc', list: Array<T>, selector: (x: T) => number) {\r\n  const asc = (a: T, b: T) => selector(a) - selector(b);\r\n  const desc = (a: T, b: T) => selector(b) - selector(a);\r\n  const compare = type === 'asc' ? asc : desc;\r\n\r\n  return list.sort(compare);\r\n}\r\n\r\nconst cm = (...args: Array<string>) => [...args].filter(Boolean).join(' ').trim() || undefined;\r\n\r\nexport { pipe, parseURL, detectIsParam, getParamName, splitPath, normalaizePathname, sort, cm };\r\n","import { h, component, useMemo, useEvent, detectIsFunction, type DarkElement } from '@dark-engine/core';\r\nimport { type SyntheticEvent } from '@dark-engine/platform-browser';\r\n\r\nimport { useHistory } from '../use-history';\r\nimport { useLocation } from '../use-location';\r\nimport { normalaizePathname, cm, parseURL } from '../utils';\r\nimport { SLASH_MARK } from '../constants';\r\n\r\nexport type RoutreLinkProps = {\r\n  to: string;\r\n  activeClassName?: string;\r\n  className?: string;\r\n  title?: string;\r\n  slot: DarkElement;\r\n  onClick?: (e: SyntheticEvent<MouseEvent, HTMLLinkElement>) => void;\r\n};\r\n\r\nconst RouterLink = component<RoutreLinkProps>(\r\n  ({ to, activeClassName = 'router-link-active', className: sourceClassName, slot, onClick, ...rest }) => {\r\n    const history = useHistory();\r\n    const { pathname, hash } = useLocation();\r\n    const isActive = useMemo(() => detectIsActiveLink(pathname, hash, to), [pathname, hash, to]);\r\n    const className = useMemo(\r\n      () => cm(sourceClassName, isActive ? activeClassName : ''),\r\n      [sourceClassName, activeClassName, isActive],\r\n    );\r\n\r\n    const handleClick = useEvent((e: SyntheticEvent<MouseEvent, HTMLLinkElement>) => {\r\n      e.preventDefault();\r\n      history.push(to);\r\n      detectIsFunction(onClick) && onClick(e);\r\n    });\r\n\r\n    return (\r\n      <a {...rest} href={to} class={className} onClick={handleClick}>\r\n        {slot}\r\n      </a>\r\n    );\r\n  },\r\n  {\r\n    displayName: 'RouterLink',\r\n  },\r\n);\r\n\r\nfunction detectIsActiveLink(pathname: string, hash: string, to: string): boolean {\r\n  const { pathname: $to, hash: $hash } = parseURL(to);\r\n  const $pathname = normalaizePathname(pathname);\r\n\r\n  if ($to === SLASH_MARK) return $pathname === SLASH_MARK;\r\n\r\n  return $pathname.indexOf($to) !== -1 && hash === $hash;\r\n}\r\n\r\nexport { RouterLink };\r\n","import { useRouterHistoryContext, checkContextValue } from '../context';\r\n\r\nfunction useHistory() {\r\n  const value = useRouterHistoryContext();\r\n\r\n  checkContextValue(value);\r\n\r\n  return value.history;\r\n}\r\n\r\nexport { useHistory };\r\n","import { useActiveRouteContext, checkContextValue } from '../context';\r\n\r\nfunction useLocation() {\r\n  const activeRoute = useActiveRouteContext();\r\n\r\n  checkContextValue(activeRoute);\r\n\r\n  return activeRoute.location;\r\n}\r\n\r\nexport { useLocation };\r\n","import { useMemo } from '../use-memo';\r\nimport { useCallback } from '../use-callback';\r\n\r\nfunction useEvent<T extends (...args: Array<any>) => any>(fn: T) {\r\n  const scope = useMemo(() => ({ fn }), []);\r\n\r\n  scope.fn = fn;\r\n\r\n  const callback = useCallback((...args: Array<any>) => {\r\n    return scope.fn(...args);\r\n  }, []);\r\n\r\n  return callback as unknown as T;\r\n}\r\n\r\nexport { useEvent };\r\n","import { detectIsFalsy, type SubscriberWithValue } from '@dark-engine/core';\r\n\r\nimport { normalaizePathname, parseURL } from '../utils';\r\n\r\nconst browserHistory = globalThis.history;\r\nclass RouterHistory {\r\n  private stack: Array<string> = [];\r\n  private cursor = -1;\r\n  private subscribers: Set<SubscriberWithValue<string>> = new Set();\r\n  private fromHistory = false;\r\n  public dispose: () => void = null;\r\n\r\n  constructor(url: string) {\r\n    if (detectIsFalsy(url)) {\r\n      throw new Error('[web-router]: RouterHistory must have initial url!');\r\n    }\r\n\r\n    const { pathname, search } = parseURL(url);\r\n    const spathname = pathname + search;\r\n\r\n    this.stack.push(spathname);\r\n    this.cursor = this.stack.length - 1;\r\n\r\n    if (browserHistory) {\r\n      const state = this.getState();\r\n\r\n      if (!state) {\r\n        browserHistory.replaceState(this.createStateBox(), '');\r\n      } else {\r\n        this.stack = state.stack;\r\n        this.cursor = state.cursor;\r\n      }\r\n\r\n      const handleEvent = () => {\r\n        const state = this.getState();\r\n\r\n        if (state) {\r\n          this.stack = state.stack;\r\n          this.cursor = state.cursor;\r\n        }\r\n\r\n        if (!this.fromHistory) {\r\n          this.mapSubscribers();\r\n        }\r\n\r\n        this.fromHistory = false;\r\n      };\r\n\r\n      window.addEventListener('popstate', handleEvent);\r\n\r\n      this.dispose = () => {\r\n        window.removeEventListener('popstate', handleEvent);\r\n        this.subscribers.clear();\r\n        this.stack = [];\r\n        this.cursor = -1;\r\n      };\r\n    }\r\n  }\r\n\r\n  private mapSubscribers() {\r\n    for (const subscriber of this.subscribers) {\r\n      subscriber(this.getValue());\r\n    }\r\n  }\r\n\r\n  private getValue = () => {\r\n    return normalaizePathname(this.stack[this.cursor]);\r\n  };\r\n\r\n  private getState(): State {\r\n    return (browserHistory.state && browserHistory.state[STATE_KEY]) || null;\r\n  }\r\n\r\n  private createStateBox(): StateBox {\r\n    const state = browserHistory.state || {};\r\n\r\n    return { ...state, [STATE_KEY]: { cursor: this.cursor, stack: this.stack } };\r\n  }\r\n\r\n  private syncHistory(action: HistoryAction, spathname: string) {\r\n    if (!browserHistory) return;\r\n    const stateBox = this.createStateBox();\r\n    const $spathname = normalaizePathname(spathname);\r\n\r\n    switch (action) {\r\n      case HistoryAction.PUSH:\r\n        return browserHistory.pushState(stateBox, '', $spathname);\r\n      case HistoryAction.REPLACE:\r\n        return browserHistory.replaceState(stateBox, '', $spathname);\r\n    }\r\n  }\r\n\r\n  public subscribe = (subscriber: SubscriberWithValue<string>) => {\r\n    this.subscribers.add(subscriber);\r\n\r\n    return () => this.subscribers.delete(subscriber);\r\n  };\r\n\r\n  public push(spathname: string) {\r\n    this.stack.splice(this.cursor + 1, this.stack.length, spathname);\r\n    this.cursor = this.stack.length - 1;\r\n    this.syncHistory(HistoryAction.PUSH, spathname);\r\n    this.mapSubscribers();\r\n  }\r\n\r\n  public replace(spathname: string) {\r\n    this.stack[this.stack.length - 1] = spathname;\r\n    this.syncHistory(HistoryAction.REPLACE, spathname);\r\n    this.mapSubscribers();\r\n  }\r\n\r\n  public forward() {\r\n    this.go(1);\r\n  }\r\n\r\n  public back() {\r\n    this.go(-1);\r\n  }\r\n\r\n  public go(delta: number) {\r\n    this.fromHistory = true;\r\n    this.cursor += delta;\r\n\r\n    if (this.cursor > this.stack.length - 1) {\r\n      this.cursor = this.stack.length - 1;\r\n    } else if (this.cursor < 0) {\r\n      this.cursor = 0;\r\n    }\r\n\r\n    browserHistory?.go(delta);\r\n    this.mapSubscribers();\r\n  }\r\n}\r\n\r\nenum HistoryAction {\r\n  PUSH = 'PUSH',\r\n  REPLACE = 'REPLACE',\r\n}\r\n\r\ntype StateBox = {\r\n  [STATE_KEY]: State;\r\n};\r\n\r\ntype State = {\r\n  cursor: number;\r\n  stack: Array<string>;\r\n};\r\n\r\nconst STATE_KEY = 'web-router';\r\n\r\nconst createRouterHistory = (url: string) => new RouterHistory(url);\r\n\r\nexport { RouterHistory, createRouterHistory };\r\n","import { detectIsFalsy } from '@dark-engine/core';\r\n\r\nimport { parseURL } from '../utils';\r\n\r\nclass RouterLocation {\r\n  public url: string;\r\n  public protocol: string;\r\n  public host: string;\r\n  public pathname: string;\r\n  public hash: string;\r\n  public search: string;\r\n  public key: string;\r\n\r\n  constructor(url: string) {\r\n    if (detectIsFalsy(url)) {\r\n      throw new Error('[web-router]: RouterLocation must have initial url!');\r\n    }\r\n\r\n    const { protocol, host, pathname, hash, search } = parseURL(url);\r\n\r\n    this.url = url;\r\n    this.protocol = protocol;\r\n    this.host = host;\r\n    this.pathname = pathname;\r\n    this.hash = hash;\r\n    this.search = search;\r\n    this.key = createKey(pathname);\r\n    Object.freeze(this);\r\n  }\r\n}\r\n\r\nfunction createKey(pathname: string): string {\r\n  return pathname\r\n    .split('')\r\n    .map(x => x.charCodeAt(0))\r\n    .reduce((acc, x) => ((acc += x), acc), 200000)\r\n    .toString(32);\r\n}\r\n\r\nconst createRouterLocation = (url: string) => new RouterLocation(url);\r\n\r\nexport { RouterLocation, createRouterLocation };\r\n","import { type DarkElement, type ComponentFactory, type SlotProps, keyBy, detectIsString } from '@dark-engine/core';\r\n\r\nimport { SLASH_MARK, WILDCARD_MARK, ROOT_MARK } from '../constants';\r\nimport { pipe, splitPath, normalaizePathname, detectIsParam, getParamName, sort } from '../utils';\r\nimport { CurrentPathContext } from '../context';\r\nimport type { Routes, RouteDescriptor, PathMatchStrategy, Params } from './types';\r\n\r\ntype RouteConstructorOptions = {\r\n  prefix: string;\r\n  parent: Route;\r\n} & RouteDescriptor;\r\n\r\nclass Route {\r\n  public path = '';\r\n  public pathMatch?: PathMatchStrategy;\r\n  public parent: Route = null;\r\n  public children: Array<Route> = [];\r\n  public level: number = null;\r\n  public marker = '';\r\n  public redirectTo: {\r\n    path: string;\r\n    route: Route;\r\n  };\r\n  public component: RouteConstructorOptions['component'] | null;\r\n\r\n  constructor(options: RouteConstructorOptions) {\r\n    const { prefix, path, redirectTo, pathMatch = 'prefix', children = [], parent, component } = options;\r\n    const rootPath = createRootPath(path);\r\n    const $path = createPath(pathMatch, prefix, rootPath);\r\n\r\n    this.path = $path;\r\n    this.pathMatch = pathMatch;\r\n    this.parent = parent;\r\n    this.children = createRoutes(children, $path, this);\r\n    this.level = parent ? parent.level + 1 : 0;\r\n    this.marker = rootPath;\r\n    this.redirectTo = detectIsString(redirectTo)\r\n      ? {\r\n          path: createPath(pathMatch, prefix, createRootPath(redirectTo)),\r\n          route: null,\r\n        }\r\n      : null;\r\n    this.component = component || null;\r\n  }\r\n\r\n  private getRoute(): Route {\r\n    return this;\r\n  }\r\n\r\n  public getPath() {\r\n    return this.path.replaceAll(ROOT_MARK + SLASH_MARK, '');\r\n  }\r\n\r\n  public render(): DarkElement {\r\n    let slot = null;\r\n    let nextRoute = this.getRoute();\r\n\r\n    while (nextRoute) {\r\n      const value = nextRoute.getPath();\r\n      const component = nextRoute.component as ComponentFactory<SlotProps>;\r\n\r\n      slot = CurrentPathContext.Provider({ value, slot: [component({ slot })] });\r\n      nextRoute = nextRoute.parent;\r\n    }\r\n\r\n    return slot;\r\n  }\r\n}\r\n\r\nfunction createRoutes(routes: Routes, prefix = SLASH_MARK, parent: Route = null): Array<Route> {\r\n  const $routes: Array<Route> = [];\r\n\r\n  for (const route of routes) {\r\n    const $route = new Route({ ...route, prefix, parent });\r\n\r\n    $routes.push($route, ...$route.children);\r\n  }\r\n\r\n  if (!parent) {\r\n    const map = keyBy($routes, x => x.path, true) as Record<string, Route>;\r\n\r\n    for (const $route of $routes) {\r\n      if ($route.redirectTo) {\r\n        $route.redirectTo.route = map[$route.redirectTo.path] || null;\r\n      }\r\n    }\r\n  }\r\n\r\n  return $routes;\r\n}\r\n\r\nfunction resolve(pathname: string, routes: Array<Route>): Route {\r\n  const route = pipe<Route>(\r\n    match(pathname, routes),\r\n    redirect(),\r\n    wildcard(pathname, routes),\r\n    redirect(),\r\n    root(),\r\n    redirect(),\r\n    canRender(),\r\n  )();\r\n\r\n  return route;\r\n}\r\n\r\nfunction match(pathname: string, routes: Array<Route>) {\r\n  return (): Route => {\r\n    const [route] = pipe<Array<Route>>(\r\n      (routes: Array<Route>) => routes.filter(x => detectIsMatchByFirstStrategy(pathname, x.path)),\r\n      (routes: Array<Route>) => routes.filter(x => detectIsMatchBySecondStrategy(pathname, x.path)),\r\n    )(routes);\r\n\r\n    return pick(route);\r\n  };\r\n}\r\n\r\nfunction redirect() {\r\n  return (route: Route): Route => {\r\n    if (route?.redirectTo) return redirect()(route.redirectTo.route);\r\n    if (route?.parent?.redirectTo) return redirect()(route.parent.redirectTo.route);\r\n\r\n    return pick(route);\r\n  };\r\n}\r\n\r\nfunction wildcard(pathname: string, routes: Array<Route>) {\r\n  return ($route: Route): Route => {\r\n    if ($route) return $route;\r\n    const [route] = pipe<Array<Route>>(\r\n      (routes: Array<Route>) => routes.filter(x => x.marker === WILDCARD_MARK),\r\n      (routes: Array<Route>) => routes.filter(x => detectIsMatchAsWildcard(pathname, x.path)) || null,\r\n      (routes: Array<Route>) => sort('desc', routes, x => x.level),\r\n    )(routes);\r\n\r\n    return pick(route);\r\n  };\r\n}\r\n\r\nfunction root() {\r\n  return (route: Route): Route => {\r\n    const root = route?.children.find(x => x.marker === ROOT_MARK) || route;\r\n\r\n    return pick(root);\r\n  };\r\n}\r\n\r\nfunction canRender() {\r\n  return (route: Route): Route => {\r\n    if (route?.component) return route;\r\n\r\n    if (process.env.NODE_ENV !== 'test') {\r\n      throw new Error('[web-router]: Route not found or it has no component!');\r\n    }\r\n\r\n    return null;\r\n  };\r\n}\r\n\r\nconst pick = (route: Route): Route | null => route || null;\r\n\r\nfunction detectIsMatchByFirstStrategy(urlPath: string, routePath: string): boolean {\r\n  const matcher = createMatcher({\r\n    space: (_, b) => b,\r\n    skip: ({ isRoot, isParam }) => isRoot || isParam,\r\n  });\r\n\r\n  return matcher(urlPath, routePath);\r\n}\r\n\r\nfunction detectIsMatchBySecondStrategy(urlPath: string, routePath: string): boolean {\r\n  const matcher = createMatcher({\r\n    space: a => a,\r\n    skip: ({ isParam }) => isParam,\r\n  });\r\n\r\n  return matcher(urlPath, routePath);\r\n}\r\n\r\nfunction detectIsMatchAsWildcard(urlPath: string, routePath: string): boolean {\r\n  const matcher = createMatcher({\r\n    space: (_, b) => b,\r\n    skip: ({ isRoot, isParam, isWildcard }) => isRoot || isParam || isWildcard,\r\n  });\r\n\r\n  return matcher(urlPath, routePath);\r\n}\r\n\r\ntype CreateMatcherOptions = {\r\n  space: (a: Array<string>, b: Array<string>) => Array<string>;\r\n  skip: (options: SkipOptions) => boolean;\r\n};\r\n\r\ntype SkipOptions = {\r\n  isRoot: boolean;\r\n  isWildcard: boolean;\r\n  isParam: boolean;\r\n};\r\n\r\nfunction createMatcher(options: CreateMatcherOptions) {\r\n  const { space, skip } = options;\r\n  return (urlPath: string, routePath: string) => {\r\n    const sUrlPath = splitPath(urlPath);\r\n    const sRoutePath = splitPath(routePath);\r\n\r\n    for (let i = 0; i < space(sUrlPath, sRoutePath).length; i++) {\r\n      const segment = sRoutePath[i];\r\n      const isRoot = segment === ROOT_MARK;\r\n      const isWildcard = segment === WILDCARD_MARK;\r\n      const isParam = detectIsParam(segment);\r\n\r\n      if (segment !== sUrlPath[i] && !skip({ isRoot, isWildcard, isParam })) return false;\r\n    }\r\n\r\n    return true;\r\n  };\r\n}\r\n\r\nfunction createPathname(urlPath: string, routePath: string): string {\r\n  const sUrlPath = splitPath(urlPath);\r\n  const sRoutePath = splitPath(routePath);\r\n  const parts: Array<string> = [];\r\n\r\n  for (let i = 0; i < sRoutePath.length; i++) {\r\n    const isParam = detectIsParam(sRoutePath[i]);\r\n\r\n    if (isParam) {\r\n      const param = sUrlPath[i] || 'null';\r\n\r\n      parts.push(param);\r\n    } else {\r\n      parts.push(sRoutePath[i]);\r\n    }\r\n  }\r\n\r\n  let newPathname = normalaizePathname(parts.join(SLASH_MARK));\r\n\r\n  if (newPathname[0] !== SLASH_MARK) {\r\n    newPathname = SLASH_MARK + newPathname;\r\n  }\r\n\r\n  return newPathname;\r\n}\r\n\r\nfunction createPath(pathMatch: PathMatchStrategy, prefix: string, path: string): string {\r\n  const $prefix = pathMatch === 'prefix' ? normalaizePathname(prefix) : '';\r\n\r\n  return normalaizePathname($prefix ? `${$prefix}${path}` : path);\r\n}\r\n\r\nfunction createRootPath(path: string): string {\r\n  return path === SLASH_MARK || path === '' ? ROOT_MARK : path;\r\n}\r\n\r\nconst getParamsMap = (pathname: string, route: Route): Params => {\r\n  const sPathname = splitPath(pathname);\r\n  const sPath = splitPath(route.path);\r\n  const map = new Map();\r\n\r\n  for (let i = 0; i < sPath.length; i++) {\r\n    if (detectIsParam(sPath[i])) {\r\n      map.set(getParamName(sPath[i]), sPathname[i]);\r\n    }\r\n  }\r\n\r\n  return map;\r\n};\r\n\r\nfunction resolveRoute(pathname: string, routes: Array<Route>) {\r\n  const activeRoute = resolve(pathname, routes);\r\n  const slot = activeRoute ? activeRoute.render() : null;\r\n  const params = activeRoute ? getParamsMap(pathname, activeRoute) : null;\r\n  const value = { activeRoute, slot, params };\r\n\r\n  return value;\r\n}\r\n\r\nexport { type Route, createRoutes, resolve, resolveRoute, createPathname };\r\n","import {\r\n  type DarkElement,\r\n  type MutableRef,\r\n  h,\r\n  component,\r\n  useMemo,\r\n  useEffect,\r\n  useLayoutEffect,\r\n  useState,\r\n  forwardRef,\r\n  useImperativeHandle,\r\n  nextTick,\r\n} from '@dark-engine/core';\r\n\r\nimport { SLASH_MARK, PROTOCOL_MARK } from '../constants';\r\nimport { normalaizePathname } from '../utils';\r\nimport { createRouterHistory } from '../history';\r\nimport { type RouterLocation, createRouterLocation } from '../location';\r\nimport { type Routes, createRoutes, resolveRoute, createPathname } from '../create-routes';\r\nimport {\r\n  type RouterHistoryContextValue,\r\n  type ActiveRouteContextValue,\r\n  RouterHistoryContext,\r\n  ActiveRouteContext,\r\n  useActiveRouteContext,\r\n} from '../context';\r\n\r\nexport type RouterProps = {\r\n  url?: string; // for server-side rendering\r\n  baseURL?: string;\r\n  routes: Routes;\r\n  slot: (slot: DarkElement) => DarkElement;\r\n};\r\n\r\nexport type RouterRef = {\r\n  navigateTo: (pathname: string) => void;\r\n  location: RouterLocation;\r\n};\r\n\r\nconst Router = forwardRef<RouterProps, RouterRef>(\r\n  component(\r\n    ({ url, baseURL = SLASH_MARK, routes: sourceRoutes, slot }, ref) => {\r\n      if (useActiveRouteContext()) {\r\n        throw new Error('[web-router]: Parent active route context detected!');\r\n      }\r\n      const sourceURL = url || window.location.href;\r\n      const [location, setLocation] = useState(() => createRouterLocation(sourceURL));\r\n      const history = useMemo(() => createRouterHistory(sourceURL), []);\r\n      const routes = useMemo(() => createRoutes(sourceRoutes, normalaizePathname(baseURL)), []);\r\n      const { protocol, host, pathname, search, hash } = location;\r\n      const { activeRoute, slot: $slot, params } = resolveRoute(pathname, routes);\r\n      const scope = useMemo(() => ({ location }), []);\r\n      const historyContext = useMemo<RouterHistoryContextValue>(() => ({ history }), []);\r\n      const routerContext = useMemo<ActiveRouteContextValue>(\r\n        () => ({ location, activeRoute, params }),\r\n        [pathname, search, hash],\r\n      );\r\n\r\n      scope.location = location;\r\n\r\n      useLayoutEffect(() => {\r\n        if (sourceURL !== scope.location.url) {\r\n          setLocation(createRouterLocation(sourceURL));\r\n        }\r\n      }, [sourceURL]);\r\n\r\n      useLayoutEffect(() => {\r\n        const unsubscribe = history.subscribe(spathname => {\r\n          const url = `${protocol}${PROTOCOL_MARK}${host}${spathname}`;\r\n\r\n          setLocation(createRouterLocation(url));\r\n        });\r\n\r\n        return () => {\r\n          unsubscribe();\r\n          history.dispose();\r\n        };\r\n      }, []);\r\n\r\n      useEffect(() => {\r\n        if (!activeRoute) return;\r\n        const spathname = pathname + search + hash;\r\n        const newSpathname = createPathname(pathname, activeRoute.getPath()) + search + hash;\r\n\r\n        if (spathname !== newSpathname) {\r\n          history.replace(newSpathname);\r\n        }\r\n      }, [pathname, search, hash]);\r\n\r\n      useImperativeHandle(ref as MutableRef<RouterRef>, () => ({\r\n        navigateTo: (pathname: string) => nextTick(() => history.push(pathname)),\r\n        location,\r\n      }));\r\n\r\n      return (\r\n        <RouterHistoryContext.Provider value={historyContext}>\r\n          <ActiveRouteContext.Provider value={routerContext}>{slot($slot)}</ActiveRouteContext.Provider>\r\n        </RouterHistoryContext.Provider>\r\n      );\r\n    },\r\n    { displayName: 'Router' },\r\n  ),\r\n);\r\n\r\nexport { Router };\r\n","import { useMemo } from '../use-memo';\r\nimport { type Ref, applyRef } from '../ref';\r\n\r\nfunction useImperativeHandle<T>(ref: Ref<T>, createHandle: () => T, deps?: Array<any>) {\r\n  const current = useMemo(() => createHandle(), deps || [{}]);\r\n\r\n  ref && applyRef(ref, current);\r\n}\r\n\r\nexport { useImperativeHandle };\r\n","export const VERSION = '0.25.1';\r\nexport const STYLE_TAG = 'style';\r\nexport const STYLED_ATTR = 'dark-styled';\r\nexport const GLOBAL_ATTR_VALUE = 'global';\r\nexport const COMPONENTS_ATTR_VALUE = 'components';\r\nexport const INTERLEAVE_GLOBAL_ATTR_VALUE = 'interleave-global';\r\nexport const INTERLEAVE_COMPONENTS_ATTR_VALUE = 'interleave-components';\r\nexport const CLASS_NAME_PREFIX = 'dk';\r\nexport const ANIMATION_NAME_PREFIX = 'dka';\r\nexport const OPENING_CURLY_BRACE_MARK = '{';\r\nexport const CLOSING_CURLY_BRACE_MARK = '}';\r\nexport const OPENING_PARENTHESIS_MARK = '(';\r\nexport const CLOSING_PARENTHESIS_MARK = ')';\r\nexport const COLON_MARK = ':';\r\nexport const SEMICOLON_MARK = ';';\r\nexport const DOT_MARK = '.';\r\nexport const BLANK_SPACE = ' ';\r\nexport const MEDIA_QUERY_MARK = '@media';\r\nexport const CONTAINER_QUERY_MARK = '@container';\r\nexport const KEYFRAMES_MARK = '@keyframes';\r\nexport const NESTING_MARK = '>';\r\nexport const SELF_MARK = '&';\r\nexport const FUNCTION_MARK = '[$]';\r\nexport const SINGLE_LINE_COMMENT_START_MARK = '//';\r\nexport const SINGLE_LINE_COMMENT_END_MARK = '\\n';\r\nexport const MULTI_LINE_COMMENT_START_MARK = '/*';\r\nexport const MULTI_LINE_COMMENT_END_MARK = '*/';\r\nexport const URL_FN_MARK = 'url';\r\n","import { STYLE_TAG, BLANK_SPACE } from '../constants';\r\n\r\nconst uniq = <T>(items: Array<T>, selector: (x: T) => unknown = x => x) => {\r\n  const arr: Array<T> = [];\r\n  const set = new Set();\r\n\r\n  for (const item of items) {\r\n    const key = selector(item);\r\n\r\n    !set.has(key) && arr.push(item);\r\n    set.add(key);\r\n  }\r\n\r\n  return arr;\r\n};\r\n\r\nconst mapProps = <T extends object>(props: T) => Object.keys(props).map(key => props[key]);\r\n\r\nconst mergeClassNames = (classNames: Array<string>) => uniq(classNames.filter(Boolean)).join(BLANK_SPACE);\r\n\r\nconst getElement = (selector: string) => document.querySelector(selector);\r\n\r\nconst getElements = (selector: string) => Array.from(document.querySelectorAll(selector));\r\n\r\nconst createStyleElement = () => document.createElement(STYLE_TAG);\r\n\r\nconst setAttr = (element: Element, attrName: string, attrValue: string) => element.setAttribute(attrName, attrValue);\r\n\r\nconst append = (parent: Element, element: Element) => parent.appendChild(element);\r\n\r\nconst insertBefore = (parent: Element, element: Element, sibling: Element) => parent.insertBefore(element, sibling);\r\n\r\nconst mergeTemplates = (t1: TemplateStringsArray, t2: TemplateStringsArray) => {\r\n  const [first] = t2;\r\n  const $t1 = [...t1];\r\n  const $t2: Array<string> = [];\r\n  let result: Omit<TemplateStringsArray, 'raw'> = null;\r\n\r\n  for (let i = 0; i < t2.length; i++) {\r\n    if (i > 0) {\r\n      $t2.push(t2[i]);\r\n    }\r\n  }\r\n\r\n  $t1[$t1.length - 1] = $t1[$t1.length - 1] + first;\r\n  result = [...$t1, ...$t2];\r\n\r\n  Object.assign(result, { raw: result });\r\n\r\n  return result as TemplateStringsArray;\r\n};\r\n\r\nconst detectIsBrowser = () => typeof window !== 'undefined';\r\n\r\nexport {\r\n  uniq,\r\n  mapProps,\r\n  mergeClassNames,\r\n  getElement,\r\n  getElements,\r\n  createStyleElement,\r\n  setAttr,\r\n  append,\r\n  insertBefore,\r\n  mergeTemplates,\r\n  detectIsBrowser,\r\n};\r\n","import { detectIsTextBased } from '@dark-engine/core';\r\n\r\nimport { type TextBased } from '../shared';\r\nimport { hash } from '../hash';\r\nimport { parse } from '../parse';\r\nimport {\r\n  KEYFRAMES_MARK,\r\n  FUNCTION_MARK,\r\n  OPENING_CURLY_BRACE_MARK,\r\n  CLOSING_CURLY_BRACE_MARK,\r\n  ANIMATION_NAME_PREFIX,\r\n} from '../constants';\r\nimport { type KeyframesRule } from '../tokens';\r\n\r\nclass Keyframes {\r\n  constructor(private name: string, private token: KeyframesRule) {}\r\n\r\n  getName() {\r\n    return this.name;\r\n  }\r\n\r\n  getToken() {\r\n    return this.token;\r\n  }\r\n}\r\n\r\nfunction keyframes(source: TemplateStringsArray, ...args: Array<TextBased>) {\r\n  const joined = join(pad(source), args);\r\n  const name = genAnimationName(joined);\r\n  const [token] = parse(joined.replace(FUNCTION_MARK, name)).children;\r\n  const keyframes = new Keyframes(name, token as KeyframesRule);\r\n\r\n  return keyframes;\r\n}\r\n\r\nfunction pad(source: TemplateStringsArray) {\r\n  const start = `${KEYFRAMES_MARK} ${FUNCTION_MARK} ${OPENING_CURLY_BRACE_MARK}`;\r\n  const end = CLOSING_CURLY_BRACE_MARK;\r\n  const strings: Array<string> = [];\r\n\r\n  for (let i = 0; i < source.length; i++) {\r\n    const isStart = i === 0;\r\n    const isEnd = i === source.length - 1;\r\n\r\n    if (isStart) {\r\n      strings.push(start + source[i]);\r\n    } else if (isEnd) {\r\n      strings.push(source[i] + end);\r\n    } else {\r\n      strings.push(source[i]);\r\n    }\r\n  }\r\n\r\n  return strings;\r\n}\r\n\r\nfunction join(source: Array<string>, args: Array<TextBased>) {\r\n  let joined = '';\r\n\r\n  for (let i = 0; i < source.length; i++) {\r\n    joined += source[i];\r\n\r\n    if (detectIsTextBased(args[i])) {\r\n      joined += args[i];\r\n    }\r\n  }\r\n\r\n  return joined;\r\n}\r\n\r\nconst genAnimationName = (key: string) => `${ANIMATION_NAME_PREFIX}-${hash(key)}`;\r\n\r\nconst detectIsKeyframes = (x: unknown): x is Keyframes => x instanceof Keyframes;\r\n\r\nexport { Keyframes, keyframes, detectIsKeyframes };\r\n","import {\r\n  OPENING_CURLY_BRACE_MARK,\r\n  CLOSING_CURLY_BRACE_MARK,\r\n  COLON_MARK,\r\n  SEMICOLON_MARK,\r\n  MEDIA_QUERY_MARK,\r\n  CONTAINER_QUERY_MARK,\r\n  KEYFRAMES_MARK,\r\n  NESTING_MARK,\r\n  SELF_MARK,\r\n  DOT_MARK,\r\n  FUNCTION_MARK,\r\n  BLANK_SPACE,\r\n} from '../constants';\r\n\r\nimport { detectIsKeyframes } from '../keyframes';\r\n\r\nabstract class Token {\r\n  name = '';\r\n  value = '';\r\n  parent: Parent;\r\n  isDynamic = false;\r\n\r\n  normalize() {\r\n    this.name = this.name.trim();\r\n    this.value = this.value.trim();\r\n  }\r\n\r\n  markAsDynamic() {\r\n    this.isDynamic = true;\r\n    detectIsToken(this.parent) && !this.parent.isDynamic && this.parent.markAsDynamic();\r\n  }\r\n\r\n  abstract generate(): string | Tuple;\r\n  abstract generate(props: object, args: Array<Function>): string | Tuple;\r\n  abstract generate(className: string | null, props: object, args: Array<Function>): string | Tuple;\r\n}\r\n\r\nclass StyleRule extends Token {\r\n  override generate(): string {\r\n    return `${this.name}${COLON_MARK}${this.value}${SEMICOLON_MARK}`;\r\n  }\r\n}\r\n\r\nclass NestingRule<P extends object = {}> extends Token {\r\n  name = NESTING_MARK;\r\n  children: Children = [];\r\n\r\n  override generate(...args: Array<unknown>): string {\r\n    const className = args[0] as string | null;\r\n    const props = args[1] as P;\r\n    const fns = args[2] as Array<Function>;\r\n    let styles = `${this.value.replaceAll(SELF_MARK, `${DOT_MARK}${className}`)}${OPENING_CURLY_BRACE_MARK}`;\r\n    let keyframes = '';\r\n\r\n    for (const token of this.children) {\r\n      const [$styles, _, __, ___, $keyframes] = generate({ token, className, props, fns });\r\n\r\n      styles += $styles;\r\n      keyframes += $keyframes;\r\n    }\r\n\r\n    styles += `${CLOSING_CURLY_BRACE_MARK}${keyframes}`;\r\n\r\n    return styles;\r\n  }\r\n}\r\n\r\nclass MediaQueryRule<P extends object = {}> extends Token {\r\n  name = MEDIA_QUERY_MARK;\r\n  children: Children = [];\r\n\r\n  override generate(...args: Array<unknown>): string {\r\n    const className = args[0] as string | null;\r\n    const props = args[1] as P;\r\n    const fns = args[2] as Array<Function>;\r\n    let styles = className\r\n      ? `${this.value}${OPENING_CURLY_BRACE_MARK}${DOT_MARK}${className}${OPENING_CURLY_BRACE_MARK}`\r\n      : `${this.value}${OPENING_CURLY_BRACE_MARK}`;\r\n    let nesting = '';\r\n\r\n    for (const token of this.children) {\r\n      const [$styles, $nesting] = generate({ token, className, props, fns });\r\n\r\n      styles += $styles;\r\n      nesting += $nesting;\r\n    }\r\n\r\n    if (className) {\r\n      styles += `${CLOSING_CURLY_BRACE_MARK}${nesting}${CLOSING_CURLY_BRACE_MARK}`;\r\n    } else {\r\n      styles += `${nesting}${CLOSING_CURLY_BRACE_MARK}`;\r\n    }\r\n\r\n    return styles;\r\n  }\r\n}\r\n\r\nclass ContainerQueryRule<P extends object = {}> extends Token {\r\n  name = CONTAINER_QUERY_MARK;\r\n  children: Children = [];\r\n\r\n  override generate(...args: Array<unknown>): string {\r\n    const className = args[0] as string | null;\r\n    const props = args[1] as P;\r\n    const fns = args[2] as Array<Function>;\r\n    let styles = className\r\n      ? `${this.value}${OPENING_CURLY_BRACE_MARK}${DOT_MARK}${className}${OPENING_CURLY_BRACE_MARK}`\r\n      : `${this.value}${OPENING_CURLY_BRACE_MARK}`;\r\n    let nesting = '';\r\n\r\n    for (const token of this.children) {\r\n      const [$styles, $nesting] = generate({ token, className, props, fns });\r\n\r\n      styles += $styles;\r\n      nesting += $nesting;\r\n    }\r\n\r\n    if (className) {\r\n      styles += `${CLOSING_CURLY_BRACE_MARK}${nesting}${CLOSING_CURLY_BRACE_MARK}`;\r\n    } else {\r\n      styles += `${nesting}${CLOSING_CURLY_BRACE_MARK}`;\r\n    }\r\n\r\n    return styles;\r\n  }\r\n}\r\n\r\nclass KeyframesRule<P extends object = {}> extends Token {\r\n  name = KEYFRAMES_MARK;\r\n  children: Children = [];\r\n\r\n  override generate(...args: Array<unknown>): string {\r\n    const props = args[0] as P;\r\n    const fns = args[1] as Array<Function>;\r\n    let keyframes = `${this.value}${OPENING_CURLY_BRACE_MARK}`;\r\n\r\n    for (const token of this.children) {\r\n      const [$styles, $nesting] = generate({ token, props, fns });\r\n\r\n      keyframes += $styles;\r\n      keyframes += $nesting;\r\n    }\r\n\r\n    keyframes += `${CLOSING_CURLY_BRACE_MARK}`;\r\n\r\n    return keyframes;\r\n  }\r\n}\r\n\r\nclass FunctionRule<P extends object = {}> extends Token {\r\n  name = FUNCTION_MARK;\r\n  args: Array<number> = [];\r\n  style: StyleRule = null;\r\n  private end = '';\r\n  private isSealed = false;\r\n\r\n  add(idx: number) {\r\n    this.args.push(idx);\r\n  }\r\n\r\n  seal(end: string) {\r\n    this.isSealed = true;\r\n    this.end = end;\r\n  }\r\n\r\n  getIsSealed() {\r\n    return this.isSealed;\r\n  }\r\n\r\n  getEnd() {\r\n    return this.end;\r\n  }\r\n\r\n  generate(...args: Array<unknown>): Tuple {\r\n    const className = args[0] as string | null;\r\n    const props = args[1] as P;\r\n    const fns = args[2] as Array<Function>;\r\n    const styleExp = this.style;\r\n    const [idx, ...rest] = this.args;\r\n    const value = fns[idx](props);\r\n    let styles = '';\r\n    let nesting = '';\r\n    let media = '';\r\n    let container = '';\r\n    let keyframes = '';\r\n\r\n    if (detectIsStyleSheet(value)) {\r\n      for (const token of value.children) {\r\n        const [$styles, $nesting, $media, $container, $keyframes] = generate({ token, className, props, fns });\r\n\r\n        styles += $styles;\r\n        nesting += $nesting;\r\n        media += $media;\r\n        container += $container;\r\n        keyframes += $keyframes;\r\n      }\r\n    } else if (styleExp) {\r\n      const end = rest.reduce((acc, x) => (acc += BLANK_SPACE + fns[x](props)), '') + this.end;\r\n\r\n      if (detectIsKeyframes(value)) {\r\n        styleExp.value = replace(this.name, value.getName()) + end;\r\n        styles += styleExp.generate();\r\n        keyframes += value.getToken().generate(props, fns);\r\n      } else {\r\n        styleExp.value = replace(this.name, value) + end;\r\n        styles += styleExp.generate();\r\n      }\r\n    }\r\n\r\n    return [styles, nesting, media, container, keyframes];\r\n  }\r\n}\r\n\r\ntype GenerateOptions<P extends object> = {\r\n  className?: string;\r\n  props?: P;\r\n  fns?: Array<Function>;\r\n};\r\n\r\nclass StyleSheet<P extends object = {}> {\r\n  children: Children = [];\r\n\r\n  generate(options: GenerateOptions<P> = {}) {\r\n    const { className = null, props, fns } = options;\r\n    let styles = className ? `${DOT_MARK}${className}${OPENING_CURLY_BRACE_MARK}` : '';\r\n    let nesting = '';\r\n    let media = '';\r\n    let container = '';\r\n    let keyframes = '';\r\n\r\n    for (const token of this.children) {\r\n      const [$styles, $nesting, $media, $container, $keyframes] = generate({ token, className, props, fns });\r\n\r\n      styles += $styles;\r\n      nesting += $nesting;\r\n      media += $media;\r\n      container += $container;\r\n      keyframes += $keyframes;\r\n    }\r\n\r\n    if (className) {\r\n      styles += `${CLOSING_CURLY_BRACE_MARK}${nesting}${media}${container}${keyframes}`;\r\n    } else {\r\n      styles += `${nesting}${media}${container}${keyframes}`;\r\n    }\r\n\r\n    return styles;\r\n  }\r\n}\r\n\r\ntype GenerateProps<P extends object> = {\r\n  token: Token;\r\n  className?: string | null;\r\n  props?: P;\r\n  fns?: Array<Function>;\r\n};\r\n\r\nfunction generate<P extends object = {}>(options: GenerateProps<P>): Tuple {\r\n  const { token, className = null, props, fns } = options;\r\n  let styles = '';\r\n  let nesting = '';\r\n  let media = '';\r\n  let container = '';\r\n  let keyframes = '';\r\n\r\n  if (detectIsStyleRule(token)) {\r\n    styles += token.generate();\r\n  } else if (detectIsNestingRule(token)) {\r\n    nesting += token.generate(className, props, fns);\r\n  } else if (detectIsMediaQueryRule(token)) {\r\n    media += token.generate(className, props, fns);\r\n  } else if (detectIsContainerQueryRule(token)) {\r\n    container += token.generate(className, props, fns);\r\n  } else if (detectIsKeyframesRule(token)) {\r\n    keyframes += token.generate(props, fns);\r\n  } else if (detectIsFunctionRule(token)) {\r\n    const [$styles, $nesting, $media, $container, $keyframes] = token.generate(className, props, fns);\r\n\r\n    styles += $styles;\r\n    nesting += $nesting;\r\n    media += $media;\r\n    container += $container;\r\n    keyframes += $keyframes;\r\n  }\r\n\r\n  return [styles, nesting, media, container, keyframes];\r\n}\r\n\r\ntype Tuple = [string, string, string, string, string];\r\n\r\nexport type Parent = StyleSheet | Token;\r\n\r\nexport type Children = Array<Token>;\r\n\r\nconst detectIsToken = (x: unknown): x is Token => x instanceof Token;\r\n\r\nconst detectIsStyleRule = (x: unknown): x is StyleRule => x instanceof StyleRule;\r\n\r\nconst detectIsMediaQueryRule = (x: unknown): x is MediaQueryRule => x instanceof MediaQueryRule;\r\n\r\nconst detectIsContainerQueryRule = (x: unknown): x is ContainerQueryRule => x instanceof ContainerQueryRule;\r\n\r\nconst detectIsKeyframesRule = (x: unknown): x is KeyframesRule => x instanceof KeyframesRule;\r\n\r\nconst detectIsNestingRule = (x: unknown): x is NestingRule => x instanceof NestingRule;\r\n\r\nconst detectIsFunctionRule = (x: unknown): x is FunctionRule => x instanceof FunctionRule;\r\n\r\nconst detectIsStyleSheet = (x: unknown): x is StyleSheet => x instanceof StyleSheet;\r\n\r\nconst replace = (target: string, x: string) => target.replace(FUNCTION_MARK, x);\r\n\r\nexport {\r\n  StyleSheet,\r\n  StyleRule,\r\n  MediaQueryRule,\r\n  ContainerQueryRule,\r\n  KeyframesRule,\r\n  NestingRule,\r\n  FunctionRule,\r\n  detectIsStyleSheet,\r\n  detectIsStyleRule,\r\n  detectIsMediaQueryRule,\r\n  detectIsContainerQueryRule,\r\n  detectIsKeyframesRule,\r\n  detectIsNestingRule,\r\n  detectIsFunctionRule,\r\n};\r\n","import { type DarkElement, createContext, useContext, component } from '@dark-engine/core';\r\n\r\nimport { type DefaultTheme } from '../';\r\n\r\n// styled.d.ts\r\n// type Theme = {\r\n//   color1: string;\r\n//   color2: string;\r\n//   color3: string;\r\n// };\r\n// declare module '@dark-engine/styled' {\r\n//   export interface DefaultTheme extends Theme {}\r\n// }\r\n\r\nexport type ThemeProps = { theme: DefaultTheme };\r\n\r\nexport type ThemeContextValue = DefaultTheme;\r\n\r\nconst ThemeContext = createContext<ThemeContextValue>(null, { displayName: 'Theme' });\r\n\r\nconst useTheme = () => useContext(ThemeContext);\r\n\r\ntype ThemeProviderProps = {\r\n  theme: DefaultTheme;\r\n  slot: DarkElement;\r\n};\r\n\r\nconst ThemeProvider = component<ThemeProviderProps>(({ theme, slot }) => {\r\n  return ThemeContext.Provider({ value: theme, slot });\r\n});\r\n\r\nexport { ThemeProvider, useTheme };\r\n","import { type DarkElement, type Callback, createContext, useContext, component } from '@dark-engine/core';\r\n\r\nexport enum STYLE_LEVEL {\r\n  GLOBAL,\r\n  COMPONENT,\r\n}\r\n\r\nclass Manager {\r\n  private styles = createStyles();\r\n  private resets = new Set<Callback>();\r\n\r\n  collectGlobalStyle(css: string) {\r\n    this.styles[STYLE_LEVEL.GLOBAL].add(css);\r\n  }\r\n\r\n  collectComponentStyle(css: string) {\r\n    this.styles[STYLE_LEVEL.COMPONENT].add(css);\r\n  }\r\n\r\n  getStyles() {\r\n    return this.styles;\r\n  }\r\n\r\n  reset(fn: Callback) {\r\n    this.resets.add(fn);\r\n  }\r\n\r\n  seal() {\r\n    this.styles = createStyles();\r\n    this.resets.forEach(x => x());\r\n    this.resets = new Set();\r\n  }\r\n}\r\n\r\nconst createStyles = () => ({\r\n  [STYLE_LEVEL.GLOBAL]: new Set<string>(),\r\n  [STYLE_LEVEL.COMPONENT]: new Set<string>(),\r\n});\r\n\r\nconst ManagerContext = createContext<Manager>(null, { displayName: 'Manager' });\r\n\r\nfunction useManager() {\r\n  return useContext(ManagerContext);\r\n}\r\n\r\ntype ThemeProviderProps = {\r\n  manager: Manager;\r\n  slot: DarkElement;\r\n};\r\n\r\nconst ManagerProvider = component<ThemeProviderProps>(({ manager, slot }) => {\r\n  return ManagerContext.Provider({ value: manager, slot });\r\n});\r\n\r\nexport { Manager, useManager, ManagerProvider };\r\n","import {\r\n  OPENING_CURLY_BRACE_MARK,\r\n  CLOSING_CURLY_BRACE_MARK,\r\n  COLON_MARK,\r\n  SEMICOLON_MARK,\r\n  MEDIA_QUERY_MARK,\r\n  CONTAINER_QUERY_MARK,\r\n  KEYFRAMES_MARK,\r\n  FUNCTION_MARK,\r\n  SINGLE_LINE_COMMENT_START_MARK,\r\n  SINGLE_LINE_COMMENT_END_MARK,\r\n  MULTI_LINE_COMMENT_START_MARK,\r\n  MULTI_LINE_COMMENT_END_MARK,\r\n  OPENING_PARENTHESIS_MARK,\r\n  CLOSING_PARENTHESIS_MARK,\r\n  URL_FN_MARK,\r\n} from '../constants';\r\nimport {\r\n  type Children,\r\n  StyleSheet,\r\n  StyleRule,\r\n  MediaQueryRule,\r\n  ContainerQueryRule,\r\n  KeyframesRule,\r\n  NestingRule,\r\n  FunctionRule,\r\n  detectIsStyleSheet,\r\n  detectIsStyleRule,\r\n  detectIsMediaQueryRule,\r\n  detectIsContainerQueryRule,\r\n  detectIsKeyframesRule,\r\n  detectIsNestingRule,\r\n  detectIsFunctionRule,\r\n} from '../tokens';\r\n\r\nfunction parse<P extends object>(css: string) {\r\n  const stylesheet = new StyleSheet<P>();\r\n  const stack: Array<NestingRule | MediaQueryRule> = [];\r\n  let buffer = '';\r\n  let end = '';\r\n  let fnIdx = -1;\r\n  let isSingleLineComment = false;\r\n  let isMultiLineComment = false;\r\n  let isPropValue = false;\r\n  let isUrl = false;\r\n\r\n  for (let i = 0; i < css.length; i++) {\r\n    const char = css[i];\r\n    const parent = stack[stack.length - 1] || stylesheet;\r\n    const last = parent.children[parent.children.length - 1];\r\n\r\n    buffer += char;\r\n\r\n    if (!isSingleLineComment && detectHasSingleLineCommentStartMark(buffer)) {\r\n      isSingleLineComment = !isUrl;\r\n    } else if (isSingleLineComment && detectHasSingleLineCommentEndMark(buffer)) {\r\n      isSingleLineComment = false;\r\n      buffer = '';\r\n    }\r\n\r\n    if (!isMultiLineComment && detectHasMultiLineCommentStartMark(buffer)) {\r\n      isMultiLineComment = true;\r\n      end = detectIsStyleRule(last) ? createEnd(buffer) : '';\r\n    } else if (isMultiLineComment && detectHasMultiLineCommentEndMark(buffer)) {\r\n      isMultiLineComment = false;\r\n      buffer = '';\r\n    }\r\n\r\n    if (isSingleLineComment || isMultiLineComment) continue;\r\n\r\n    if (detectHasFunctionMark(buffer)) {\r\n      const token = new FunctionRule();\r\n\r\n      if (detectIsFunctionRule(last) && !last.getIsSealed() && last.style) {\r\n        last.add(++fnIdx);\r\n        buffer = '';\r\n        continue;\r\n      }\r\n\r\n      token.add(++fnIdx);\r\n      token.parent = parent;\r\n      token.markAsDynamic();\r\n\r\n      if (detectIsStyleRule(last) && !last.value) {\r\n        token.style = last;\r\n        token.name = buffer.trim();\r\n        last.normalize();\r\n        last.isDynamic = true;\r\n        parent.children[parent.children.length - 1] = token;\r\n      } else {\r\n        parent.children.push(token);\r\n      }\r\n\r\n      buffer = '';\r\n      continue;\r\n    }\r\n\r\n    switch (char) {\r\n      case OPENING_CURLY_BRACE_MARK:\r\n        {\r\n          const token = detectHasMediaQueryMark(buffer)\r\n            ? new MediaQueryRule()\r\n            : detectHasContainerQueryMark(buffer)\r\n            ? new ContainerQueryRule()\r\n            : detectHasKeyframesMark(buffer)\r\n            ? new KeyframesRule()\r\n            : new NestingRule();\r\n          const canNest =\r\n            detectIsMediaQueryRule(token) || detectIsContainerQueryRule(token) || detectIsKeyframesRule(token)\r\n              ? detectIsStyleSheet(parent)\r\n              : detectIsNestingRule(token)\r\n              ? detectIsStyleSheet(parent) ||\r\n                detectIsMediaQueryRule(parent) ||\r\n                detectIsContainerQueryRule(parent) ||\r\n                detectIsKeyframesRule(parent)\r\n              : false;\r\n\r\n          if (!canNest) {\r\n            throw new Error('Illegal style nesting!');\r\n          }\r\n\r\n          token.value = sub(buffer);\r\n          token.normalize();\r\n          token.parent = parent;\r\n\r\n          if (!token.value) {\r\n            throw new Error('Empty style nesting!');\r\n          }\r\n\r\n          parent.children.push(token);\r\n          stack.push(token);\r\n          buffer = '';\r\n        }\r\n        break;\r\n      case CLOSING_CURLY_BRACE_MARK:\r\n        stack.pop();\r\n        buffer = '';\r\n        break;\r\n      case COLON_MARK:\r\n        {\r\n          if (!detectIsPropName(buffer, i, css, parent.children)) continue;\r\n          const token = new StyleRule();\r\n\r\n          token.name = sub(buffer);\r\n          token.parent = parent;\r\n          parent.children.push(token);\r\n        }\r\n        buffer = '';\r\n        isPropValue = true;\r\n        break;\r\n      case SEMICOLON_MARK:\r\n        if (!last) {\r\n          throw new Error('Incorrect style!');\r\n        }\r\n\r\n        if (detectIsFunctionRule(last)) {\r\n          last.seal(sub(buffer));\r\n          buffer = '';\r\n          continue;\r\n        }\r\n\r\n        last.value = end || sub(buffer);\r\n        last.normalize();\r\n\r\n        buffer = '';\r\n        end = '';\r\n        isPropValue = false;\r\n        break;\r\n      case OPENING_PARENTHESIS_MARK:\r\n        if (isPropValue && detectHasUrlFnMark(buffer)) {\r\n          isUrl = true;\r\n        }\r\n        break;\r\n      case CLOSING_PARENTHESIS_MARK:\r\n        isUrl = false;\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n  }\r\n\r\n  return stylesheet;\r\n}\r\n\r\nfunction detectIsPropName(name: string, idx: number, css: string, children: Children) {\r\n  const last = children[children.length - 1];\r\n  if (detectHasMediaQueryMark(name) || detectHasContainerQueryMark(name)) return false;\r\n  if (detectIsStyleRule(last) && !last.value) return false;\r\n\r\n  for (let i = idx; i < css.length; i++) {\r\n    const char = css[i];\r\n\r\n    if (char === OPENING_CURLY_BRACE_MARK) return false;\r\n    if (char === SEMICOLON_MARK) return true;\r\n  }\r\n\r\n  return true;\r\n}\r\n\r\nconst detectHasSingleLineCommentStartMark = (x: string) => x.endsWith(SINGLE_LINE_COMMENT_START_MARK);\r\n\r\nconst detectHasSingleLineCommentEndMark = (x: string) => x.endsWith(SINGLE_LINE_COMMENT_END_MARK);\r\n\r\nconst detectHasMultiLineCommentStartMark = (x: string) => x.endsWith(MULTI_LINE_COMMENT_START_MARK);\r\n\r\nconst detectHasMultiLineCommentEndMark = (x: string) => x.endsWith(MULTI_LINE_COMMENT_END_MARK);\r\n\r\nconst detectHasFunctionMark = (x: string) => x.endsWith(FUNCTION_MARK);\r\n\r\nconst detectHasUrlFnMark = (x: string) => x.endsWith(URL_FN_MARK + OPENING_PARENTHESIS_MARK);\r\n\r\nconst detectHasMediaQueryMark = (x: string) => x.trim().startsWith(MEDIA_QUERY_MARK);\r\n\r\nconst detectHasContainerQueryMark = (x: string) => x.trim().startsWith(CONTAINER_QUERY_MARK);\r\n\r\nconst detectHasKeyframesMark = (x: string) => x.trim().startsWith(KEYFRAMES_MARK);\r\n\r\nconst sub = (x: string) => x.substring(0, x.length - 1);\r\n\r\nconst createEnd = (x: string) => x.replace(MULTI_LINE_COMMENT_START_MARK, '').trim();\r\n\r\nexport { parse };\r\n","const SEED = 5381;\r\nconst SIZE = 6;\r\nconst map = { 0: 'a', 1: 'b', 2: 'c', 3: 'd', 4: 'e', 5: 'f', 6: 'g', 7: 'h', 8: 'i', 9: 'j' };\r\n\r\nfunction phash(h: number, x: string) {\r\n  let i = x.length;\r\n\r\n  while (i) {\r\n    h = (h * 33) ^ x.charCodeAt(--i);\r\n  }\r\n\r\n  return h;\r\n}\r\n\r\nfunction hash(x: string) {\r\n  const source = phash(SEED, x);\r\n  const hash = String(Math.abs(source))\r\n    .slice(0, SIZE)\r\n    .split('')\r\n    .map(x => map[x])\r\n    .join('');\r\n\r\n  return hash;\r\n}\r\n\r\nexport { hash };\r\n","import {\r\n  type ComponentFactory,\r\n  type TagVirtualNodeFactory,\r\n  type StandardComponentProps,\r\n  type Component,\r\n  type VirtualNode,\r\n  View,\r\n  component,\r\n  forwardRef,\r\n  useMemo,\r\n  detectIsString,\r\n  detectIsFunction,\r\n  detectIsTextBased,\r\n  detectIsServer,\r\n  useInsertionEffect,\r\n} from '@dark-engine/core';\r\n\r\nimport {\r\n  detectIsBrowser,\r\n  mapProps,\r\n  mergeClassNames,\r\n  getElement,\r\n  getElements,\r\n  createStyleElement,\r\n  setAttr,\r\n  append,\r\n  mergeTemplates,\r\n} from '../utils';\r\nimport {\r\n  CLASS_NAME_PREFIX,\r\n  FUNCTION_MARK,\r\n  DOT_MARK,\r\n  STYLED_ATTR,\r\n  COMPONENTS_ATTR_VALUE,\r\n  INTERLEAVE_COMPONENTS_ATTR_VALUE,\r\n  BLANK_SPACE,\r\n} from '../constants';\r\nimport { type KeyframesRule, StyleSheet, detectIsStyleSheet, detectIsKeyframesRule } from '../tokens';\r\nimport { type Keyframes, detectIsKeyframes } from '../keyframes';\r\nimport { type ThemeProps, useTheme } from '../theme';\r\nimport { type TextBased } from '../shared';\r\nimport { useManager } from '../server/manager';\r\nimport { parse } from '../parse';\r\nimport { hash } from '../hash';\r\n\r\nlet cache: Map<string, [string, string]> = null;\r\nlet injections: Set<string> = null;\r\nlet tag: HTMLStyleElement = null;\r\nlet isLoaded = false;\r\nconst $$styled = Symbol('styled');\r\n\r\nsetupGlobal();\r\nfunction styled<P extends object, T extends object = {}>(tagName: string | ComponentFactory<P>) {\r\n  const factory = detectIsString(tagName) ? (props: P) => View({ as: tagName, ...props }) : tagName;\r\n\r\n  if (!isLoaded && detectIsBrowser()) {\r\n    reuse(getInterleavedElements(), createTag);\r\n    isLoaded = true;\r\n  }\r\n\r\n  return createStyledComponent<P & T>(factory as Factory<P & T>);\r\n}\r\n\r\nfunction createStyledComponent<P extends StyledProps>(factory: Factory<P>) {\r\n  let transform: TransformFn<P> = x => x;\r\n  const isExtending = detectIsStyled(factory);\r\n  const config = isExtending ? getExtendingConfig(factory as StyledComponentFactory<P>) : null;\r\n  const fn = <T extends P>(source: TemplateStringsArray, ...args: Args<T & ThemeProps>) => {\r\n    const $source = isExtending ? mergeTemplates(config.source, source) : source;\r\n    const $args = isExtending ? [...config.args, ...args] : args;\r\n    const $transform = isExtending ? (p: T) => transform(config.transform(p)) : transform;\r\n    const fns = filterArgs<T>($args);\r\n    const [sheet, sheets] = slice<T>(css($source, ...$args));\r\n    const [baseName, baseStyle, baseKeyframes] = generate({ sheet, cache });\r\n    const styled = forwardRef<T, unknown>(\r\n      component((props, ref) => {\r\n        const { as: component, ...rest } = props;\r\n        const theme = useTheme();\r\n        const isSwap = detectIsFunction(component);\r\n        const $props = (isSwap ? rest : props) as unknown as T;\r\n        const $factory = isSwap ? component : isExtending ? config.factory : factory;\r\n        const [className, styles, keyframes] = useMemo(() => {\r\n          const [names, styles, keyframes] = sheets.reduce(\r\n            (acc, sheet) => {\r\n              const [className, style, keyframes] = generate({ sheet, cache, props: { ...props, theme }, fns });\r\n              const [names, styles, keyframesList] = acc;\r\n\r\n              names.push(className);\r\n              styles.push(style);\r\n              keyframesList.push(keyframes);\r\n\r\n              return acc;\r\n            },\r\n            [[], [baseStyle], [baseKeyframes]] as [Array<string>, Array<string>, Array<string>],\r\n          );\r\n          const className = mergeClassNames([...getClassNamesFrom(props), baseName, ...names]);\r\n\r\n          return [className, filter(styles, injections), filter(keyframes, injections)] as [\r\n            string,\r\n            Array<string>,\r\n            Array<string>,\r\n          ];\r\n        }, [...mapProps(props), theme]);\r\n\r\n        useInsertionEffect(() => {\r\n          if (!tag) {\r\n            const $tag = getTag();\r\n\r\n            if ($tag) {\r\n              tag = $tag; // after hydration\r\n              return;\r\n            } else {\r\n              tag = createTag();\r\n            }\r\n          }\r\n\r\n          styles.forEach(css => inject(css, tag));\r\n          keyframes.forEach(css => inject(css, tag));\r\n        }, [...styles, ...keyframes]);\r\n\r\n        if (detectIsServer()) {\r\n          const manager = useManager(); // special case of hook using, should be last in order\r\n\r\n          styles.forEach(css => manager.collectComponentStyle(css));\r\n          keyframes.forEach(css => manager.collectComponentStyle(css));\r\n          manager.reset(setupGlobal);\r\n        }\r\n\r\n        if (detectIsFunction($props.slot)) {\r\n          $props.slot = $props.slot((x: string) => `${className}_${x}`);\r\n        }\r\n\r\n        return $factory({ ...$transform($props), ref, className });\r\n      }),\r\n    ) as StyledComponentFactory<T>;\r\n\r\n    styled[$$styled] = {\r\n      className: baseName,\r\n      source: $source,\r\n      args: $args,\r\n      factory: (config?.factory || factory) as Factory<T>,\r\n      transform: config ? p => transform(config.transform(p)) : transform,\r\n    };\r\n\r\n    return styled;\r\n  };\r\n\r\n  fn.attrs = (t: TransformFn<P>) => {\r\n    transform = detectIsFunction(t) ? t : transform;\r\n\r\n    return fn;\r\n  };\r\n\r\n  return fn;\r\n}\r\n\r\nfunction filter(styles: Array<string>, injections: Set<string>) {\r\n  const $styles: Array<string> = [];\r\n\r\n  for (const css of styles) {\r\n    if (!injections.has(css)) {\r\n      $styles.push(css);\r\n      injections.add(css);\r\n    }\r\n  }\r\n\r\n  return $styles;\r\n}\r\n\r\nfunction setupGlobal() {\r\n  cache = new Map();\r\n  injections = new Set();\r\n  tag = null;\r\n  isLoaded = false;\r\n}\r\n\r\nfunction getExtendingConfig<P extends object>(factory: StyledComponentFactory<P>) {\r\n  const { className, ...rest } = factory[$$styled];\r\n  const config: ExtendingConfig<P> = rest;\r\n\r\n  return config;\r\n}\r\n\r\ntype GenerateOptions<P extends object> = {\r\n  sheet: StyleSheet<P>;\r\n  cache: Map<string, [string, string]>;\r\n  props?: P;\r\n  fns?: Array<Function>;\r\n};\r\n\r\nfunction generate<P extends object>(options: GenerateOptions<P>): [string, string, string] {\r\n  const { sheet: $sheet, cache, props, fns } = options;\r\n  const [sheet, rules] = split($sheet);\r\n  const key = sheet.generate({ className: FUNCTION_MARK, props, fns });\r\n  const item = cache.get(key);\r\n  const className = item ? item[0] : genClassName(key);\r\n  const css = item ? item[1] : key.replaceAll(FUNCTION_MARK, className);\r\n  let style = '';\r\n  let keyframes = '';\r\n\r\n  style += css;\r\n  cache.set(key, [className, css]);\r\n\r\n  for (const rule of rules) {\r\n    keyframes += rule.generate();\r\n  }\r\n\r\n  return [className, style, keyframes];\r\n}\r\n\r\nfunction split<P extends object>(source: StyleSheet<P>): [StyleSheet<P>, Array<KeyframesRule<P>>] {\r\n  const sheet = new StyleSheet<P>();\r\n  const rules: Array<KeyframesRule<P>> = [];\r\n\r\n  for (const token of source.children) {\r\n    if (detectIsKeyframesRule(token)) {\r\n      rules.push(token);\r\n    } else {\r\n      sheet.children.push(token);\r\n    }\r\n  }\r\n\r\n  return [sheet, rules];\r\n}\r\n\r\nfunction slice<P extends object>(source: StyleSheet<P>): [StyleSheet<P>, Array<StyleSheet<P>>] {\r\n  const sheet = new StyleSheet<P>();\r\n  const sheets: Array<StyleSheet> = [];\r\n\r\n  for (const token of source.children) {\r\n    if (token.isDynamic) {\r\n      const style = new StyleSheet<P>();\r\n\r\n      style.children.push(token);\r\n      sheets.push(style);\r\n    } else {\r\n      sheet.children.push(token);\r\n    }\r\n  }\r\n\r\n  return [sheet, sheets];\r\n}\r\n\r\nfunction join<P>(strings: TemplateStringsArray, args: Args<P>) {\r\n  let joined = '';\r\n  let keyframes = '';\r\n\r\n  for (let i = 0; i < strings.length; i++) {\r\n    const arg = args[i];\r\n\r\n    joined += strings[i];\r\n\r\n    if (detectIsStyled(arg)) {\r\n      joined += `${DOT_MARK}${arg[$$styled].className}`;\r\n    } else if (detectIsStyleSheet(arg)) {\r\n      joined += arg.generate();\r\n    } else if (detectIsKeyframes(arg)) {\r\n      joined += arg.getName();\r\n      keyframes += arg.getToken().generate();\r\n    } else if (detectIsFunction(arg)) {\r\n      joined += FUNCTION_MARK;\r\n    } else if (detectIsTextBased(arg)) {\r\n      joined += arg;\r\n    }\r\n  }\r\n\r\n  joined += keyframes;\r\n\r\n  return joined;\r\n}\r\n\r\nfunction createTag() {\r\n  const tag = createStyleElement();\r\n\r\n  setAttr(tag, STYLED_ATTR, COMPONENTS_ATTR_VALUE);\r\n  append(document.head, tag);\r\n\r\n  return tag;\r\n}\r\n\r\nfunction inject(css: string, tag: HTMLStyleElement) {\r\n  tag.textContent = `${tag.textContent}${css}`;\r\n}\r\n\r\nfunction reuse(elements: Array<HTMLStyleElement>, createTag: () => HTMLStyleElement) {\r\n  if (elements.length === 0) return;\r\n  const tag = createTag();\r\n  let content = '';\r\n\r\n  for (const element of elements) {\r\n    content += element.textContent;\r\n    element.remove();\r\n  }\r\n\r\n  tag.textContent = content;\r\n}\r\n\r\nfunction getInterleavedElements() {\r\n  return getElements(`[${STYLED_ATTR}=\"${INTERLEAVE_COMPONENTS_ATTR_VALUE}\"]`) as Array<HTMLStyleElement>;\r\n}\r\n\r\nconst getTag = () => getElement(`[${STYLED_ATTR}=\"${COMPONENTS_ATTR_VALUE}\"]`) as HTMLStyleElement;\r\n\r\nconst css = <P extends object>(strings: TemplateStringsArray, ...args: Args<P>) => parse<P>(join(strings, args));\r\n\r\nconst getClassNamesFrom = (props: StyledProps) => (props.class || props.className || '').split(BLANK_SPACE);\r\n\r\nconst genClassName = (key: string) => `${CLASS_NAME_PREFIX}-${hash(key)}`;\r\n\r\nconst detectIsStyled = (x: unknown): x is StyledComponentFactory => detectIsFunction(x) && Boolean(x[$$styled]);\r\n\r\nconst filterArgs = <P>(args: Args<unknown>) =>\r\n  args.filter(x => detectIsFunction(x) && !detectIsStyled(x)) as DynamicArgs<P>;\r\n\r\ntype Factory<P extends object> = ComponentFactory<P> | ((props: P) => TagVirtualNodeFactory);\r\n\r\ntype ClassNameFn = (className: string) => string;\r\n\r\ntype StyledElement = Component | VirtualNode | string | Array<Component | VirtualNode | string>;\r\n\r\ntype StyledProps = {\r\n  as?: string | ComponentFactory;\r\n  class?: string;\r\n  className?: string;\r\n  style?: string | Record<string, string>;\r\n  slot?: ((fn: ClassNameFn) => StyledElement) | StyledElement;\r\n};\r\n\r\ntype ExtendingConfig<P extends object = {}> = {\r\n  source: TemplateStringsArray;\r\n  args: Args<P>;\r\n  factory: Factory<P>;\r\n  transform: (x: P) => P;\r\n};\r\n\r\ntype TransformFn<P> = (p: P) => any;\r\n\r\ntype DynamicArgs<P> = Array<ArgFn<P>>;\r\n\r\ntype ArgFn<P> = Function | ((p: P) => TextBased | false);\r\n\r\nexport type Args<P> = Array<TextBased | ArgFn<P> | StyleSheet | Keyframes>;\r\n\r\nexport type StyledComponentFactory<P extends object = {}> = {\r\n  [$$styled]: {\r\n    className: string;\r\n  } & ExtendingConfig<P>;\r\n} & ComponentFactory<P & StandardComponentProps & StyledProps>;\r\n\r\nstyled.a = styled('a');\r\nstyled.abbr = styled('abbr');\r\nstyled.address = styled('address');\r\nstyled.area = styled('area');\r\nstyled.article = styled('article');\r\nstyled.aside = styled('aside');\r\nstyled.audio = styled('audio');\r\nstyled.b = styled('b');\r\nstyled.base = styled('base');\r\nstyled.bdi = styled('bdi');\r\nstyled.bdo = styled('bdo');\r\nstyled.blockquote = styled('blockquote');\r\nstyled.body = styled('body');\r\nstyled.br = styled('br');\r\nstyled.button = styled('button');\r\nstyled.canvas = styled('canvas');\r\nstyled.caption = styled('caption');\r\nstyled.cite = styled('cite');\r\nstyled.code = styled('code');\r\nstyled.col = styled('col');\r\nstyled.colgroup = styled('colgroup');\r\nstyled.data = styled('data');\r\nstyled.datalist = styled('datalist');\r\nstyled.dd = styled('dd');\r\nstyled.del = styled('del');\r\nstyled.details = styled('details');\r\nstyled.dfn = styled('dfn');\r\nstyled.dialog = styled('dialog');\r\nstyled.div = styled('div');\r\nstyled.dl = styled('dl');\r\nstyled.dt = styled('dt');\r\nstyled.em = styled('em');\r\nstyled.embed = styled('embed');\r\nstyled.fieldset = styled('fieldset');\r\nstyled.figcaption = styled('figcaption');\r\nstyled.figure = styled('figure');\r\nstyled.footer = styled('footer');\r\nstyled.form = styled('form');\r\nstyled.h1 = styled('h1');\r\nstyled.h2 = styled('h2');\r\nstyled.h3 = styled('h3');\r\nstyled.h4 = styled('h4');\r\nstyled.h5 = styled('h5');\r\nstyled.h6 = styled('h6');\r\nstyled.head = styled('head');\r\nstyled.header = styled('header');\r\nstyled.hgroup = styled('hgroup');\r\nstyled.hr = styled('hr');\r\nstyled.html = styled('html');\r\nstyled.i = styled('i');\r\nstyled.iframe = styled('iframe');\r\nstyled.img = styled('img');\r\nstyled.input = styled('input');\r\nstyled.ins = styled('ins');\r\nstyled.kbd = styled('kbd');\r\nstyled.label = styled('label');\r\nstyled.legend = styled('legend');\r\nstyled.li = styled('li');\r\nstyled.link = styled('link');\r\nstyled.main = styled('main');\r\nstyled.map = styled('map');\r\nstyled.mark = styled('mark');\r\nstyled.menu = styled('menu');\r\nstyled.meta = styled('meta');\r\nstyled.meter = styled('meter');\r\nstyled.nav = styled('nav');\r\nstyled.noscript = styled('noscript');\r\nstyled.object = styled('object');\r\nstyled.ol = styled('ol');\r\nstyled.optgroup = styled('optgroup');\r\nstyled.option = styled('option');\r\nstyled.output = styled('output');\r\nstyled.p = styled('p');\r\nstyled.param = styled('param');\r\nstyled.picture = styled('picture');\r\nstyled.pre = styled('pre');\r\nstyled.progress = styled('progress');\r\nstyled.q = styled('q');\r\nstyled.rp = styled('rp');\r\nstyled.rt = styled('rt');\r\nstyled.ruby = styled('ruby');\r\nstyled.s = styled('s');\r\nstyled.samp = styled('samp');\r\nstyled.script = styled('script');\r\nstyled.section = styled('section');\r\nstyled.select = styled('select');\r\nstyled.small = styled('small');\r\nstyled.source = styled('source');\r\nstyled.span = styled('span');\r\nstyled.strong = styled('strong');\r\nstyled.style = styled('style');\r\nstyled.sub = styled('sub');\r\nstyled.summary = styled('summary');\r\nstyled.sup = styled('sup');\r\nstyled.table = styled('table');\r\nstyled.tbody = styled('tbody');\r\nstyled.td = styled('td');\r\nstyled.template = styled('template');\r\nstyled.textarea = styled('textarea');\r\nstyled.tfoot = styled('tfoot');\r\nstyled.th = styled('th');\r\nstyled.thead = styled('thead');\r\nstyled.time = styled('time');\r\nstyled.title = styled('title');\r\nstyled.tr = styled('tr');\r\nstyled.track = styled('track');\r\nstyled.u = styled('u');\r\nstyled.ul = styled('ul');\r\nstyled.var = styled('var');\r\nstyled.video = styled('video');\r\nstyled.wbr = styled('wbr');\r\nstyled.svg = styled('svg');\r\nstyled.circle = styled('circle');\r\nstyled.clipPath = styled('clipPath');\r\nstyled.defs = styled('defs');\r\nstyled.desc = styled('desc');\r\nstyled.ellipse = styled('ellipse');\r\nstyled.feBlend = styled('feBlend');\r\nstyled.feColorMatrix = styled('feColorMatrix');\r\nstyled.feComponentTransfer = styled('feComponentTransfer');\r\nstyled.feComposite = styled('feComposite');\r\nstyled.feConvolveMatrix = styled('feConvolveMatrix');\r\nstyled.feDiffuseLighting = styled('feDiffuseLighting');\r\nstyled.feDisplacementMap = styled('feDisplacementMap');\r\nstyled.feDistantLight = styled('feDistantLight');\r\nstyled.feFlood = styled('feFlood');\r\nstyled.feFuncA = styled('feFuncA');\r\nstyled.feFuncB = styled('feFuncB');\r\nstyled.feFuncG = styled('feFuncG');\r\nstyled.feFuncR = styled('feFuncR');\r\nstyled.feGaussianBlur = styled('feGaussianBlur');\r\nstyled.feImage = styled('feImage');\r\nstyled.feMerge = styled('feMerge');\r\nstyled.feMergeNode = styled('feMergeNode');\r\nstyled.feMorphology = styled('feMorphology');\r\nstyled.feOffset = styled('feOffset');\r\nstyled.fePointLight = styled('fePointLight');\r\nstyled.feSpecularLighting = styled('feSpecularLighting');\r\nstyled.feSpotLight = styled('feSpotLight');\r\nstyled.feTile = styled('feTile');\r\nstyled.feTurbulence = styled('feTurbulence');\r\nstyled.filter = styled('filter');\r\nstyled.g = styled('g');\r\nstyled.image = styled('image');\r\nstyled.line = styled('line');\r\nstyled.linearGradient = styled('linearGradient');\r\nstyled.marker = styled('marker');\r\nstyled.mask = styled('mask');\r\nstyled.path = styled('path');\r\nstyled.pattern = styled('pattern');\r\nstyled.polygon = styled('polygon');\r\nstyled.polyline = styled('polyline');\r\nstyled.radialGradient = styled('radialGradient');\r\nstyled.rect = styled('rect');\r\nstyled.stop = styled('stop');\r\nstyled.switch = styled('switch');\r\nstyled.symbol = styled('symbol');\r\nstyled.text = styled('text');\r\nstyled.textPath = styled('textPath');\r\nstyled.tspan = styled('tspan');\r\nstyled.use = styled('use');\r\nstyled.view = styled('view');\r\n\r\nexport { setupGlobal, styled, css, inject, reuse, getTag, filterArgs, detectIsStyled };\r\n","import { component, forwardRef, useInsertionEffect, useMemo, useId, detectIsServer } from '@dark-engine/core';\r\n\r\nimport {\r\n  detectIsBrowser,\r\n  mapProps,\r\n  getElement,\r\n  insertBefore,\r\n  getElements,\r\n  createStyleElement,\r\n  setAttr,\r\n  append,\r\n} from '../utils';\r\nimport { STYLED_ATTR, GLOBAL_ATTR_VALUE, INTERLEAVE_GLOBAL_ATTR_VALUE } from '../constants';\r\nimport { css, inject, reuse, getTag as getStyleTag, filterArgs } from '../styled';\r\nimport { type ThemeProps, useTheme } from '../theme';\r\nimport { useManager } from '../server/manager';\r\nimport { type Args } from '../styled';\r\n\r\nlet cache: Map<string, string> = null;\r\nlet tag: HTMLStyleElement = null;\r\nlet isLoaded = false;\r\n\r\nsetupGlobal();\r\n\r\nfunction createGlobalStyle<P extends object = {}>(source: TemplateStringsArray, ...args: Args<P & ThemeProps>) {\r\n  if (!isLoaded && detectIsBrowser()) {\r\n    reuse(getInterleavedElements(), createTag);\r\n    isLoaded = true;\r\n  }\r\n  const fns = filterArgs<P>(args);\r\n  const sheet = css<P>(source, ...args);\r\n  const factory = forwardRef<P, unknown>(\r\n    component(props => {\r\n      const theme = useTheme();\r\n      const id = useId();\r\n      const css = useMemo(() => sheet.generate({ props: { ...props, theme }, fns }), [...mapProps(props), theme]);\r\n\r\n      useInsertionEffect(() => {\r\n        if (!tag) {\r\n          tag = getTag() || createTag(); // after hydration\r\n        }\r\n\r\n        cache.set(id, css);\r\n        reinject(tag, cache);\r\n      }, [css]);\r\n\r\n      useInsertionEffect(() => {\r\n        return () => {\r\n          cache.delete(id);\r\n          reinject(tag, cache);\r\n        };\r\n      }, []);\r\n\r\n      if (detectIsServer()) {\r\n        const manager = useManager(); // special case of hook using, should be last in order\r\n\r\n        manager.collectGlobalStyle(css);\r\n        manager.reset(setupGlobal);\r\n      }\r\n\r\n      return null;\r\n    }),\r\n  );\r\n\r\n  return factory;\r\n}\r\n\r\nfunction setupGlobal() {\r\n  cache = new Map();\r\n  tag = null;\r\n  isLoaded = false;\r\n}\r\n\r\nfunction createTag() {\r\n  const tag1 = createStyleElement();\r\n  const tag2 = getStyleTag();\r\n\r\n  setAttr(tag1, STYLED_ATTR, GLOBAL_ATTR_VALUE);\r\n\r\n  if (tag2) {\r\n    insertBefore(document.head, tag1, tag2);\r\n  } else {\r\n    append(document.head, tag1);\r\n  }\r\n\r\n  return tag1;\r\n}\r\n\r\nfunction getInterleavedElements() {\r\n  return getElements(`[${STYLED_ATTR}=\"${INTERLEAVE_GLOBAL_ATTR_VALUE}\"]`) as Array<HTMLStyleElement>;\r\n}\r\n\r\nconst getTag = () => getElement(`[${STYLED_ATTR}=\"${GLOBAL_ATTR_VALUE}\"]`) as HTMLStyleElement;\r\n\r\nconst reinject = (tag: HTMLStyleElement, stylesMap: Map<string, string>) => {\r\n  tag.textContent = '';\r\n  stylesMap.forEach(css => inject(css, tag));\r\n};\r\n\r\nexport { setupGlobal, createGlobalStyle };\r\n","import { h, component } from '@dark-engine/core';\r\n\r\nconst Spinner = component(() => <div>LOADING...</div>);\r\n\r\nexport { Spinner };\r\n","import { type DarkElement, h, Fragment, component, Suspense, lazy } from '@dark-engine/core';\r\nimport { type Routes, Router, RouterLink } from '@dark-engine/web-router';\r\nimport { createGlobalStyle } from '@dark-engine/styled';\r\n\r\nimport { Spinner } from './spinner';\r\n\r\nconst Home = lazy(() => import('./home'));\r\nconst About = lazy(() => import('./about'));\r\nconst Contacts = lazy(() => import('./contacts'));\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: 'home',\r\n    component: Home,\r\n  },\r\n  {\r\n    path: 'about',\r\n    component: About,\r\n  },\r\n  {\r\n    path: 'contacts',\r\n    component: Contacts,\r\n  },\r\n  {\r\n    path: '**',\r\n    redirectTo: 'home',\r\n  },\r\n];\r\n\r\ntype ShellProps = {\r\n  slot: DarkElement;\r\n};\r\n\r\nconst Shell = component<ShellProps>(({ slot }) => {\r\n  return (\r\n    <Suspense fallback={<Spinner />}>\r\n      <header>\r\n        <RouterLink to='/home'>home</RouterLink>\r\n        <RouterLink to='/about'>about</RouterLink>\r\n        <RouterLink to='/contacts'>contacts</RouterLink>\r\n      </header>\r\n      <main>{slot}</main>\r\n    </Suspense>\r\n  );\r\n});\r\n\r\nexport type AppProps = {\r\n  url?: string;\r\n};\r\n\r\nconst App = component<AppProps>(({ url }) => {\r\n  return (\r\n    <>\r\n      <GlobalStyle />\r\n      <Router routes={routes} url={url}>\r\n        {slot => <Shell>{slot}</Shell>}\r\n      </Router>\r\n    </>\r\n  );\r\n});\r\n\r\nconst GlobalStyle = createGlobalStyle`\r\n  * {\r\n    box-sizing: border-box;\r\n  }\r\n\r\n  html {\r\n    font-size: 14px;\r\n  }\r\n\r\n  html, body {\r\n    margin: 0;\r\n    padding: 0;\r\n  }\r\n\r\n  body {\r\n    font-family: sans-serif;\r\n    background-color: #fafafa;\r\n  }\r\n\r\n  header {\r\n    width: 100%;\r\n    height: 64px;\r\n    background-color: #2196F3;\r\n    display: flex;\r\n    align-items: center;\r\n    padding: 8px 16px;\r\n  }\r\n\r\n  header a {\r\n    color: #fff;\r\n    text-transform: uppercase;\r\n    margin-right: 8px;\r\n    text-decoration: none;\r\n  }\r\n\r\n  header .router-link-active {\r\n    color: #FFEB3B;\r\n  }\r\n\r\n  main {\r\n    width: 800px;\r\n    max-width: 100%;\r\n    margin: 0 auto;\r\n  }\r\n\r\n  img {\r\n    max-width: 100%;\r\n    min-height: 500px;\r\n    background-color: #eee;\r\n  }\r\n\r\n  p {\r\n    line-height: 2.4;\r\n  }\r\n`;\r\n\r\nexport { App };\r\n","import { hydrateRoot } from '@dark-engine/platform-browser';\r\n\r\nimport { type AppProps, App } from './components/app';\r\n\r\nfunction bootstrap(props: AppProps = {}) {\r\n  hydrateRoot(document.getElementById('root'), App(props));\r\n}\r\n\r\nexport { bootstrap };\r\n","import { bootstrap } from './bootstrap';\r\n\r\nbootstrap();\r\n"],"names":["inProgress","$$inject","Symbol","Component","constructor","type","token","props","ref","shouldUpdate","displayName","children","this","component","options","$token","factory","defaultInject","detectIsComponent","x","getComponentKey","hasComponentFlag","inst","flag","Boolean","ROOT","REPLACER","INDEX_KEY","KEY_ATTR","REF_ATTR","CREATE_EFFECT_TAG","UPDATE_EFFECT_TAG","DELETE_EFFECT_TAG","SKIP_EFFECT_TAG","INSERTION_EFFECT_HOST_MASK","LAYOUT_EFFECT_HOST_MASK","ASYNC_EFFECT_HOST_MASK","ATOM_HOST_MASK","PORTAL_HOST_MASK","SHADOW_MASK","FLUSH_MASK","MOVE_MASK","HOOK_DELIMETER","YIELD_INTERVAL","APP_STATE_ATTR","TaskPriority","Flag","ATTR_BLACK_LIST","SKIP_SCAN_OPT","MEMO_SLOT_OPT","STATIC_SLOT_OPT","createElement","element","slot","as","length","detectIsFunction","o","detectIsUndefined","detectIsString","detectIsTextBased","detectIsObject","detectIsBoolean","detectIsArray","Array","isArray","detectIsNull","detectIsEmpty","detectIsFalsy","getTime","Date","now","dummyFn","trueFn","sameFn","error","args","console","flatten","source","transform","list","stack","idx","pop","i","push","keyBy","fn","value","reduce","acc","detectAreDepsDifferent","prevDeps","nextDeps","max","Math","Object","is","nextTick","callback","Promise","resolve","then","createIndexKey","$$vNode","ATTR_TYPE","VirtualNode","TagVirtualNode","name","attrs","super","NodeType","TAG","TextVirtualNode","TEXT","String","CommentVirtualNode","text","COMMENT","View","_void","key","Text","from","detectIsTextVirtualNode","detectIsVirtualNode","vNode","detectIsTagVirtualNode","detectIsCommentVirtualNode","detectIsVirtualNodeFactory","detectIsPlainVirtualNode","createReplacer","detectIsReplacer","getElementKey","hasElementFlag","hasVirtualNodeFactoryFlag","hasTagVirtualNodeFlag","getElementType","hasChildrenProp","detectAreSameInstanceTypes","prevInst","nextInst","isComponentFactories","nc","detectAreSameComponentTypesWithSameKeys","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","m","d","definition","defineProperty","enumerable","get","f","e","chunkId","all","keys","promises","u","g","globalThis","Function","window","obj","prop","prototype","hasOwnProperty","call","l","url","done","script","needAttach","scripts","document","getElementsByTagName","s","getAttribute","charset","timeout","setAttribute","src","onScriptComplete","prev","event","onerror","onload","clearTimeout","doneFns","parentNode","removeChild","forEach","setTimeout","bind","target","head","appendChild","r","toStringTag","scriptUrl","importScripts","location","currentScript","Error","replace","p","installedChunks","j","installedChunkData","promise","reject","errorType","realSrc","message","request","webpackJsonpCallback","parentChunkLoadingFunction","data","chunkIds","moreModules","runtime","some","id","chunkLoadingGlobal","self","defaultRealisation","platform","insertElement","raf","caf","spawn","commit","finishCommit","detectIsDynamic","detectIsPortal","unmountPortal","chunk","detectIsServer","EventEmitter","subscribers","Map","on","has","set","Set","add","delete","emit","kill","__getSize","size","Scope","root","wip","cursor","unit","mountDeep","mountLevel","mountNav","events","unsubs","actions","candidates","deletions","cancels","asyncEffects","layoutEffects","insertionEffects","resourceId","resources","defers","setPendingStatus","isLayoutEffectsZone","isInsertionEffectsZone","isUpdateZone","isBatchZone","isHydrateZone","isStreamZone","isTransitionZone","isEventZone","isHot","isDynamic","isServer","emitter","resetActions","getActionsById","addActionMap","map","insert","remove","move","stable","addReplaceAction","nextKey","addInsertAction","addRemoveAction","prevKey","addMoveAction","addStableAction","copy","scope","getRoot","setRoot","fiber","getWorkInProgress","setWorkInProgress","getNextUnitOfWork","setNextUnitOfWork","getCursorFiber","setCursorFiber","navToChild","navToSibling","navToParent","navToPrev","getMountIndex","setMountDeep","getMountDeep","resetMount","getEvents","addEventUnsubscriber","unsubscribeEvents","getCandidates","addCandidate","resetCandidates","getDeletions","hasDeletion","nextFiber","parent","addDeletion","resetDeletions","addAsyncEffect","resetAsyncEffects","runAsyncEffects","effects","addLayoutEffect","resetLayoutEffects","runLayoutEffects","setIsLayoutEffectsZone","addInsertionEffect","resetInsertionEffects","runInsertionEffects","setIsInsertionEffectsZone","addCancel","applyCancels","resetCancels","getIsLayoutEffectsZone","getIsInsertionEffectsZone","getIsUpdateZone","setIsUpdateZone","getIsBatchZone","setIsBatchZone","getIsHydrateZone","setIsHydrateZone","getIsStreamZone","setIsStreamZone","getIsTransitionZone","setIsTransitionZone","getIsEventZone","setIsEventZone","getIsHot","setIsHot","getPendingStatusSetter","setPendingStatusSetter","flush","getEmitter","defer","getDefers","resetDefers","getResource","setResource","res","getResources","getResourceId","setResourceId","getNextResourceId","runAfterCommit","rootId","scopes","getRootId","setRootId","Fiber","hook","provider","cc","cec","eidx","mask","tag","child","next","alt","atoms","nextId","mutate","markHost","increment","count","force","$scope","wipFiber","stop","setError","catch","static","Hook","values","owner","$$memo","detectIsMemo","instance","walk","onWalk","shouldDeep","shouldStop","skip","collectElements","elements","getFiberWithElement","$fiber","buildChildNodes","onNode","getKey","buildChildNode","altMap","startEidx","prevIdx","nextIdx","left","right","isFirst","isLast","notifyParents","$$fragment","Fragment","defaultShouldUpdate","nextProps","Memo","memo","getValue","n","deps","state","$value","detectIsElement","EffectType","$$useEffect","useEffect","dropEffects","createEffect","ASYNC","effect","cleanup","isInsertionEffect","INSERTION","isLayoutEffect","LAYOUT","isAsyncEffect","runEffect","$$useLayoutEffect","useLayoutEffect","dropLayoutEffects","$$useInsertionEffect","useInsertionEffect","dropInsertionEffects","combinedMask","shouldUnmountFiber","unmountFiber","_","hasPendingPromise","hasRenderError","workLoop","isAsync","shouldYield","hasMoreWork","performUnitOfWork","scheduler","hasPrimaryTask","fork","unmounts","diff","parentFiber","isRight","sync","err","finally","isDeepWalking","isStream","hasChildren","$inst","createFiber","getAlternate","share","mountChild","mountSibling","shouldMount","pc","mount","hasSameCount","prevKeys","nextKeys","prevKeysMap","nextKeysMap","keyedFibersMap","usedKeysMap","extractKeys","prevKeyFiber","tryOptStaticSlot","hasMove","hasRemove","hasInsert","hasReplace","detectIsStableMemoTree","tryOptMov","tryOptRem","tryOptMemoSlot","reconcile","isUpdate","setup","getHook","fromChild","parentId","isMove","isStable","isComponent","result","setNextId","supportConditional","cancel","$$scope$","cancelTask","setValue","resetValue","assign","replaceScope","$createChanger","MessageChannel","port1","port2","MessagePort","channel","offs","off","postMessage","unref","Task","priority","forceAsync","taskRestorer","pendingSetter","nextTaskId","getPriority","getForceAsync","setIsTransition","isTransition","getIsTransition","run","pending","markAsPending","isPending","canPending","markAsUnnecessary","isUnnecessary","getIsUnnecessary","setTaskRestorer","setLocationCreator","locationCreator","createLocation","setPendingSetter","loc","tasks","deep","$loc","split","$$loc","indexOf","createRootLocation","queue","deadline","task","scheduledCallback","isMessageLoopRunning","port","performWorkUntilDeadline","reset","schedule","put","execute","high","normal","low","getQueues","hasPrimary","hasLow","detectHasRelatedUpdate","complete","filter","splice","pick","shift","requestCallbackAsync","requestCallback","isBusy","unshift","forwardRef","rest","applyRef","current","mutableRef","detectIsMutableRef","$$portal","getPortalContainer","textContent","SyntheticEvent","sourceEvent","propagation","stopPropagation","preventDefault","getPropagation","delegateEvent","eventName","handler","eventsMap","handlersMap","$handler","slice","rootHandler","$event","parentElement","dispatchEvent","WeakMap","addEventListener","removeEventListener","detectIsEvent","attrName","startsWith","getEventName","toLowerCase","STYLE_ATTR","CLASS_ATTR","CLASS_NAME_ATTR","moves","patches","svgTagNames","voidTagNames","createNativeElementMap","detectIsSvgElement","createElementNS","createTextNode","createComment","createNativeElement","node","setObjectStyle","style","setProperty","toggleAttribute","removeAttribute","patchProperties","tagName","attrValue","patchPropertiesSpecialCasesMap","getPrototypeOf","descriptor","getOwnPropertyDescriptor","canSetProperty","includes","input","checked","autofocus","focus","textarea","innerText","commitMap","childNodes","nativeElement","splitText","appendNativeElement","insertNativeElement","attrNames","tagElement","addAttributes","commitCreation","sourceNodes","sourceFragment","DocumentFragment","elementIdx","removeNativeElement","replaceNativeElement","prevInstance","nextInstance","prevNode","nextNode","prevAttrs","nextAttrs","getAttributeNames","prevAttrValue","nextAttrValue","updateAttributes","commitUpdate","innerHTML","canRemoveNativeElement","sibling","insertBefore","insertNativeElementByIndex","candidate","replaceChild","roots","requestAnimationFrame","cancelAnimationFrame","isInjected","hydrate","querySelector","Number","JSON","parse","atob","replaceAll","useUpdate","createChanger","hasChanger","isBatch","isEvent","restore","fromRestore","detectIsFiberAlive","createUpdate","callbackOptions","createHookLocation","change","batch","timer","changes","addBatch","createContext","defaultValue","context","Provider","Consumer","providerValue","subscribe","subscriber","createProvider","createConsumer","getProvider","update","hasProvider","unsubscribe","useCallback","useState","initialValue","setState","sourceValue","prevValue","newValue","$$shadow","Shadow","isInserted","isEnabled","fibers","SuspenseContext","isLoaded","fallback","register","unregister","Suspense","setIsLoaded","store","content","CONTENT","FALLBACK","useId","getNextId","toString","$$lazy","factories","lazy","make","async","default","load","ActiveRouteContext","useActiveRouteContext","RouterHistoryContext","CurrentPathContext","checkContextValue","SLASH_MARK","PROTOCOL_MARK","HASH_MARK","ROOT_MARK","pipe","fns","fn1","fn2","parseURL","body","protocol","host","pathname","hash","search","splitted","findIndex","idx1","join","addSlashToEnd","createSearch","createHash","detectIsParam","splitPath","path","endsWith","normalaizePathname","spath","RouterLink","to","activeClassName","className","sourceClassName","onClick","history","useHistory","activeRoute","useLocation","isActive","$to","$hash","$pathname","detectIsActiveLink","trim","cm","handleClick","useEvent","href","class","browserHistory","RouterHistory","fromHistory","dispose","spathname","getState","replaceState","createStateBox","handleEvent","mapSubscribers","clear","STATE_KEY","syncHistory","action","stateBox","$spathname","HistoryAction","PUSH","pushState","REPLACE","forward","go","back","delta","RouterLocation","charCodeAt","createKey","freeze","createRouterLocation","Route","level","marker","prefix","redirectTo","pathMatch","rootPath","createRootPath","$path","createPath","createRoutes","route","getRoute","getPath","render","nextRoute","routes","$routes","$route","redirect","createMatcher","space","urlPath","routePath","sUrlPath","sRoutePath","segment","isRoot","isWildcard","isParam","$prefix","resolveRoute","detectIsMatchByFirstStrategy","b","matcher","detectIsMatchBySecondStrategy","a","match","detectIsMatchAsWildcard","selector","compare","sort","wildcard","find","params","sPathname","sPath","getParamsMap","Router","baseURL","sourceRoutes","sourceURL","setLocation","createRouterHistory","$slot","historyContext","routerContext","newSpathname","parts","param","newPathname","createPathname","createHandle","navigateTo","useImperativeHandle","STYLED_ATTR","GLOBAL_ATTR_VALUE","COMPONENTS_ATTR_VALUE","DOT_MARK","MEDIA_QUERY_MARK","CONTAINER_QUERY_MARK","mapProps","getElement","getElements","querySelectorAll","createStyleElement","setAttr","append","detectIsBrowser","Keyframes","getName","getToken","detectIsKeyframes","Token","normalize","markAsDynamic","detectIsToken","StyleRule","generate","NestingRule","styles","keyframes","$styles","__","___","$keyframes","MediaQueryRule","nesting","$nesting","ContainerQueryRule","KeyframesRule","FunctionRule","end","isSealed","seal","getIsSealed","getEnd","styleExp","media","container","detectIsStyleSheet","$media","$container","StyleSheet","detectIsStyleRule","detectIsNestingRule","detectIsMediaQueryRule","detectIsContainerQueryRule","detectIsKeyframesRule","detectIsFunctionRule","ThemeContext","useTheme","STYLE_LEVEL","theme","ManagerContext","useManager","detectIsPropName","css","last","detectHasMediaQueryMark","detectHasContainerQueryMark","char","manager","detectHasSingleLineCommentEndMark","detectHasMultiLineCommentStartMark","detectHasMultiLineCommentEndMark","detectHasFunctionMark","detectHasUrlFnMark","URL_FN_MARK","detectHasKeyframesMark","sub","substring","createEnd","cache","injections","$$styled","styled","reuse","createTag","isExtending","detectIsStyled","config","getExtendingConfig","$source","t1","t2","first","$t1","$t2","raw","mergeTemplates","$args","$transform","filterArgs","sheet","sheets","baseName","baseStyle","baseKeyframes","isSwap","$props","$factory","names","keyframesList","classNames","getClassNamesFrom","items","arr","item","uniq","$tag","getTag","collectComponentStyle","setupGlobal","t","createStyledComponent","$sheet","rules","genClassName","rule","strings","stylesheet","buffer","fnIdx","isSingleLineComment","isMultiLineComment","isPropValue","isUrl","joined","arg","h","phash","abs","abbr","address","area","article","aside","audio","base","bdi","bdo","blockquote","br","button","canvas","caption","cite","code","col","colgroup","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","iframe","img","ins","kbd","label","legend","li","link","main","mark","menu","meta","meter","nav","noscript","object","ol","optgroup","option","output","picture","pre","progress","q","rp","rt","ruby","samp","section","select","small","span","strong","summary","sup","table","tbody","td","template","tfoot","th","thead","time","title","tr","track","ul","var","video","wbr","svg","circle","clipPath","defs","desc","ellipse","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","image","line","linearGradient","pattern","polygon","polyline","radialGradient","rect","switch","symbol","textPath","tspan","use","view","tag1","tag2","reinject","stylesMap","Spinner","Shell","App","GlobalStyle","collectGlobalStyle","getElementById","isMounted","isHydrate","rootFiber","bootstrap"],"sourceRoot":""}